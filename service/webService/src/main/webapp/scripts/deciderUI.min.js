function int(a){return parseInt(a,10)}!function(a){function b(a){var b="    ";b=isNaN(parseInt(a))?a:new Array(a+1).join(" ");for(var c=["\n"],d=0;d<100;d++)c.push(c[d]+b);return c}function c(a,b){return b-(a.replace(/\(/g,"").length-a.replace(/\)/g,"").length)}function d(a,b){return a.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+b+b+"AND ").replace(/ BETWEEN /gi,"~::~"+b+"BETWEEN ").replace(/ CASE /gi,"~::~"+b+"CASE ").replace(/ ELSE /gi,"~::~"+b+"ELSE ").replace(/ END /gi,"~::~"+b+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+b+"ON ").replace(/ OR /gi,"~::~"+b+b+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+b+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+b).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+b+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}var e=function(b){this.init(b);var c=this.options.method;a.isFunction(this[c])||a.error("'"+c+"' is not a Formatter method."),this.format=function(a){return this[this.options.method].call(this,a)}};e.prototype={options:{},init:function(c){this.options=a.extend({},a.fn.format.defaults,c),this.step=this.options.step,this.preserveComments=this.options.preserveComments,this.shift=b(this.step)},xml:function(a){var b=a.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),c=b.length,d=!1,e=0,f="",g=0;for(g=0;g<c;g++)b[g].search(/<!/)>-1?(f+=this.shift[e]+b[g],d=!0,(b[g].search(/-->/)>-1||b[g].search(/\]>/)>-1||b[g].search(/!DOCTYPE/)>-1)&&(d=!1)):b[g].search(/-->/)>-1||b[g].search(/\]>/)>-1?(f+=b[g],d=!1):/^<\w/.exec(b[g-1])&&/^<\/\w/.exec(b[g])&&/^<[\w:\-\.\,]+/.exec(b[g-1])==/^<\/[\w:\-\.\,]+/.exec(b[g])[0].replace("/","")?(f+=b[g],d||e--):b[g].search(/<\w/)>-1&&b[g].search(/<\//)==-1&&b[g].search(/\/>/)==-1?f=f+=d?b[g]:this.shift[e++]+b[g]:b[g].search(/<\w/)>-1&&b[g].search(/<\//)>-1?f=f+=d?b[g]:this.shift[e]+b[g]:b[g].search(/<\//)>-1?f=f+=d?b[g]:this.shift[--e]+b[g]:b[g].search(/\/>/)>-1?f=f+=d?b[g]:this.shift[e]+b[g]:f+=b[g].search(/<\?/)>-1?this.shift[e]+b[g]:b[g].search(/xmlns\:/)>-1||b[g].search(/xmlns\=/)>-1?this.shift[e]+b[g]:b[g];return"\n"==f[0]?f.slice(1):f},xmlmin:function(a){var b=this.preserveComments?a:a.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns");return b.replace(/>\s{0,}</g,"><")},json:function(a){return"undefined"==typeof JSON?a:"string"==typeof a?JSON.stringify(JSON.parse(a),null,this.step):"object"==typeof a?JSON.stringify(a,null,this.step):a},jsonmin:function(a){return"undefined"==typeof JSON?a:JSON.stringify(JSON.parse(a),null,0)},css:function(a){var b=a.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),c=b.length,d=0,e="",f=0;for(f=0;f<c;f++)e+=/\{/.exec(b[f])?this.shift[d++]+b[f]:/\}/.exec(b[f])?this.shift[--d]+b[f]:/\*\\/.exec(b[f])?this.shift[d]+b[f]:this.shift[d]+b[f];return e.replace(/^\n{1,}/,"")},cssmin:function(a){var b=this.preserveComments?a:a.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"");return b.replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},sql:function(a){var b=a.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),e=b.length,f=[],g=0,h=this.step,i=0,j="",k=0;for(k=0;k<e;k++)f=k%2?f.concat(b[k]):f.concat(d(b[k],h));for(e=f.length,k=0;k<e;k++)i=c(f[k],i),/\s{0,}\s{0,}SELECT\s{0,}/.exec(f[k])&&(f[k]=f[k].replace(/\,/g,",\n"+h+h)),/\s{0,}\s{0,}SET\s{0,}/.exec(f[k])&&(f[k]=f[k].replace(/\,/g,",\n"+h+h)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(f[k])?(g++,j+=this.shift[g]+f[k]):/\'/.exec(f[k])?(i<1&&g&&g--,j+=f[k]):(j+=this.shift[g]+f[k],i<1&&g&&g--);return j=j.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},sqlmin:function(a){return a.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")}},a.fn.format=function(b){var c=new e(b);return this.each(function(){var b=a(this),d=b.val();d=c.format(d),b.val(d)})},a.format=function(a,b){var c=new e(b);return c.format(a)},a.fn.format.defaults={method:"xml",step:"    ",preserveComments:!1}}(jQuery),angular.module("qAllSettled",[]).config(["$provide",function(a){a.decorator("$q",["$delegate",function(a){var b=a;return b.allSettled=function(a){return b.all(a.map(function(a){return a.then(function(a){return{state:"fulfilled",value:a}},function(a){return{state:"rejected",reason:a}})}))},b}])}]),angular.module("ui.multiselect",["multiselect.tpl.html"]).factory("optionParser",["$parse",function(a){var b=/^\s*(.*?)(?:\s+as\s+(.*?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+(.*)$/;return{parse:function(c){var d=c.match(b);if(!d)throw new Error("Expected typeahead specification in form of '_modelValue_ (as _label_)? for _item_ in _collection_' but got '"+c+"'.");return{itemName:d[3],source:a(d[4]),viewMapper:a(d[2]||d[1]),modelMapper:a(d[1])}}}}]).directive("multiselect",["$parse","$document","$compile","$interpolate","optionParser",function(a,b,c,d,e){return{restrict:"E",require:"ngModel",link:function(b,f,g,h){function i(){t.items.length=0;var a=q.source(b);if(angular.isDefined(a))for(var c=0;c<a.length;c++){var d={};d[q.itemName]=a[c],t.items.push({label:q.viewMapper(d),model:a[c],checked:!1})}}function j(){if(k(h.$modelValue))return t.header=g.msHeader||"Select";if(r)g.msSelected?t.header=d(g.msSelected)(t):t.header=h.$modelValue.length+" selected";else{var a={};a[q.itemName]=h.$modelValue,t.header=q.viewMapper(a)}}function k(a){if(!a)return!0;if(a.length&&a.length>0)return!1;for(var b in a)if(a[b])return!1;return!0}function l(a){a.checked?t.uncheckAll():(t.uncheckAll(),a.checked=!a.checked),n(!1)}function m(a){a.checked=!a.checked,n(!0)}function n(a){var b;a?(b=[],angular.forEach(t.items,function(a){a.checked&&b.push(a.model)})):angular.forEach(t.items,function(a){if(a.checked)return b=a.model,!1}),h.$setViewValue(b)}function o(a){angular.isArray(a)?angular.forEach(t.items,function(b){b.checked=!1,angular.forEach(a,function(a){angular.equals(b.model,a)&&(b.checked=!0)})}):angular.forEach(t.items,function(b){if(angular.equals(b.model,a))return b.checked=!0,!1})}var p=g.options,q=e.parse(p),r=!!g.multiple,s=!1,t=b.$new(),u=g.change||angular.noop;t.items=[],t.header="Select",t.multiple=r,t.disabled=!1,t.searchText="",b.$on("$destroy",function(){t.$destroy()});var v=angular.element("<multiselect-popup></multiselect-popup>");(g.required||g.ngRequired)&&(s=!0),g.$observe("required",function(a){s=a}),t.filterByName=function(a){return a.model.indexOf(t.searchText)!==-1},t.$watch(function(){return a(g.disabled)(b)},function(a){t.disabled=a}),t.$watch(function(){return a(g.multiple)(b)},function(a){r=a||!1}),t.$watch(function(){return q.source(b)},function(a){angular.isDefined(a)&&i()},!0),t.$watch(function(){return h.$modelValue},function(a,b){angular.isDefined(a)&&(o(a),t.$eval(u)),j(),h.$setValidity("required",t.valid())},!0),i(),f.append(c(v)(t)),t.valid=function(){if(!s)return!0;var a=h.$modelValue;return angular.isArray(a)&&a.length>0||!angular.isArray(a)&&null!=a},t.checkAll=function(){r&&(angular.forEach(t.items,function(a){a.checked=!0}),n(!0))},t.uncheckAll=function(){angular.forEach(t.items,function(a){a.checked=!1}),n(!0)},t.select=function(a){r===!1?(l(a),t.toggleSelect()):m(a)}}}}]).directive("multiselectPopup",["$document",function(a){return{restrict:"E",scope:!1,replace:!0,templateUrl:"multiselect.tpl.html",link:function(b,c,d){function e(d){f(d.target,c.find(d.target.tagName))||(c.removeClass("open"),a.unbind("click",e),b.$apply())}b.isVisible=!1,b.toggleSelect=function(){c.hasClass("open")?(c.removeClass("open"),a.unbind("click",e)):(c.addClass("open"),a.bind("click",e),b.focus())},b.focus=function(){var a=c.find("input")[0];a.focus()};var f=function(a,b){for(var c=0;c<b.length;c++)if(a==b[c])return!0;return!1}}}}]),angular.module("multiselect.tpl.html",[]).run(["$templateCache",function(a){a.put("multiselect.tpl.html",'<div class="btn-group">\n  <button type="button" class="btn btn-default dropdown-toggle" ng-click="toggleSelect()" ng-disabled="disabled" ng-class="{\'error\': !valid()}">\n    {{header}} <span class="caret"></span>\n  </button>\n  <ul class="dropdown-menu">\n    <li>\n      <input class="form-control input-sm" type="text" ng-model="searchText" autofocus="autofocus" placeholder="Filter" />\n    </li>\n    <li ng-show="multiple" role="presentation" class="">\n      <button class="btn btn-link btn-xs" ng-click="checkAll()" type="button"><i class="fa fa-check"></i> Check all</button>\n      <button class="btn btn-link btn-xs" ng-click="uncheckAll()" type="button"><i class="fa fa-times"></i> Uncheck all</button>\n    </li>\n    <li ng-repeat="i in items | filter : filterByName">\n      <a ng-click="select(i); focus()">\n        <i class="fa" ng-class="{\'fa-check\': i.checked, \'empty\': !i.checked}"></i> {{i.label}}</a>\n    </li>\n  </ul>\n</div>')}]),function(){"use strict";angular.module("uxData",["uxData.core","uxData.constants","uxData.services","uxData.distribution","uxData.namespaced","uxData.testsuite","uxData.partners","uxData.active-whitelisted","uxData.changes","uxData.rules","uxData.urlRules","uxData.expression","uxData.server","uxData.changes","uxData.templates","uxData.deciderRules","uxData.summary","uxData.traffic","uxData.settings","uxData.diff","uxData.modelInitializer"])}(),function(){"use strict";angular.module("uxData.active-whitelisted",["uxData.services"])}(),function(){"use strict";angular.module("uxData.changes",["ui.router","uxData.services","uxData.config","uxData.constants","ngRoute","ui.bootstrap","dialogs.main","toastr","ui.utils"])}(),function(){"use strict";angular.module("uxData.changesOffline",["ui.router","uxData.services","uxData.constants","ngRoute","ui.bootstrap","dialogs.main","toastr","ui.utils"])}(),function(){"use strict";var a=angular.module("uxData.config",["uxData.constants","ui.router"]);a.run(["editableOptions","editableThemes",function(a,b){a.theme="default",b["default"].submitTpl='<button class="btn btn-primary fa saveComment" type="submit">Ok</button>',b["default"].cancelTpl='<button class="btn btn-default fa cancelComment" type="button" ng-click="$form.$cancel()">Cancel</button>'}])}(),function(){"use strict";angular.module("uxData.constants",["uxData.services"])}(),function(){"use strict";angular.module("uxData.core",["ngAnimate","ui.router","ngSanitize","ui.select","ui.multiselect","uxData.distribution","uxData.services","uxData.constants","uxData.namespaced","uxData.testsuite","uxData.rules","uxData.expression","uxData.server","uxData.stacks","uxData.changes","uxData.changesOffline","uxData.urlParams","uxData.urlRules","uxData.deciderRules","xeditable","uxData.modelInitializer"])}(),function(){"use strict";angular.module("uxData.defaultserver",["uxData.services","uxData.config","uxData.constants","ngRoute","ui.bootstrap","dialogs.main","toastr","ui.utils"])}(),function(){"use strict";angular.module("uxData.diff",["uxData.config","ui.router"])}(),function(){"use strict";angular.module("uxData.diff-distribution",["uxData.services","uxData.config","uxData.constants","ui.router","toastr","uxData.active-whitelisted","uxData.defaultserver"])}(),function(){"use strict";angular.module("uxData.distribution",["uxData.diff-distribution","uxData.services","uxData.config","uxData.constants","ui.router","toastr","uxData.active-whitelisted","uxData.defaultserver"])}(),function(){"use strict";angular.module("uxData.expression",["uxData.services","uxData.constants","ui.router"])}(),function(){"use strict";angular.module("uxData.modelInitializer",["ui.router","uxData.services","uxData.constants","ngRoute","toastr","ngTable"])}(),function(){"use strict";angular.module("uxData.namespaced",["ui.router","uxData.services","uxData.constants","ngRoute","ngStorage","ui.bootstrap","dialogs.main","toastr","ui.utils","ngTable"])}(),function(){"use strict";angular.module("uxData.partners",["uxData.services","uxData.constants","ui.router","ngRoute","ui.bootstrap","dialogs.main","toastr","ui.utils","ngTable"])}(),function(){"use strict";angular.module("uxData.rules",["uxData.services","uxData.constants","ui.router"])}(),function(){"use strict";angular.module("uxData.server",["uxData.services","uxData.constants","ui.router"])}(),function(){"use strict";angular.module("uxData.services",["uxData.constants","uxData.config","ui.bootstrap","ui.utils","dialogs.main"])}(),function(){"use strict";angular.module("uxData.settings",["uxData.services","uxData.constants","uxData.config","ui.router","toastr"])}(),function(){"use strict";angular.module("uxData.stacks",["ui.router","uxData.services","uxData.constants","ngRoute","ui.bootstrap","dialogs.main","toastr","ui.utils","ngTable","xeditable"])}(),function(){"use strict";angular.module("uxData.summary",["uxData.services","uxData.constants","uxData.config","ui.router"])}(),function(){"use strict";angular.module("uxData.templates",["ui.router","uxData.services","uxData.constants","ngRoute","ui.bootstrap","dialogs.main","toastr","ui.utils","ngTable","uxData.rules"])}(),function(){"use strict";angular.module("uxData.testsuite",["uxData.services","uxData.constants","uxData.config","uxData.stacks","ui.router","toastr","ngTable","qAllSettled"])}(),function(){"use strict";angular.module("uxData.traffic",["uxData.services","uxData.constants","uxData.config","ui.router","toastr","ngTable","ngNumeraljs"])}(),function(){"use strict";angular.module("uxData.urlParams",["uxData.services","uxData.constants","ui.router"])}(),function(){"use strict";angular.module("uxData.urlRules",["uxData.services","uxData.constants","ui.router"])}(),function(){"use strict";angular.module("uxData.deciderRules",["uxData.services","uxData.constants","ui.router"])}(),function(){"use strict";function a(a,b,c,d,e){function f(a,b,c){return!!(a.indexOf(c+"-*")>0&&b.startsWith(c))}function g(){var a=e.getGlobalCurrentUser();return null!==a&&null!==a.username&&"dev"===a.username&&null!==a.permissions&&a.permissions.indexOf(d().all)!==-1}function h(){return!!e.getGlobalCurrentUser()}function i(g){var i="redirector-accessApp-"+(angular.isDefined(a.currentApplication)?a.currentApplication:b);g=c.toArray(g);var j=!0,k=e.getGlobalCurrentUser();if(null==k||null==k.permissions)return!1;for(var l in g)k.permissions.indexOf(g[l])!==-1||f(k.permissions,g[l],"read")||f(k.permissions,g[l],"write")||(j=!1);return k.permissions.indexOf(i)===-1&&(j=!1),h()&&(k.permissions.indexOf(d().all)!==-1||j)}function j(a){var b=e.getGlobalCurrentUser();return null!=b&&null!=b.permissions&&(b.permissions.indexOf("redirector-accessApp-"+a)>-1||b.permissions.indexOf(d().all)>-1)}var k={isAuthenticated:h,isAuthorized:i,isAppAccessible:j,isDevProfile:g};return k}angular.module("uxData.services").factory("authService",a),a.$inject=["$rootScope","currentApplication","utilsService","USER_PERMISSIONS","tokenService"]}(),function(){"use strict";angular.module("uxData.services").factory("constantsProvider",function(){var a="left",b="right",c="OR",d="XOR",e="{host}",f={ADD:"ADD",UPDATE:"UPDATE",DELETE:"DELETE"};return{LEFT:a,RIGHT:b,OR:c,XOR:d,HOST:e,PENDING_CHANGE_TYPE:f}})}(),function(){"use strict";angular.module("uxData.services").factory("localStorageService",["$rootScope","$window","$document",function(a,b,c){a.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1};var d=function(b){angular.isUndefined(b)||(a.prefix=b,"."!==a.prefix.substr(-1)&&(a.prefix=a.prefix?a.prefix+".":""))},e=function(){return a.prefix};this.setStorageType=function(a){this.storageType=a},this.setStorageCookie=function(a,b){this.cookie={expiry:a,path:b}},this.setStorageCookieDomain=function(a){this.cookie.domain=a},this.setNotify=function(a,b){this.notify={setItem:a,removeItem:b}};var f,g=this.cookie,h=this.notify,i=this.storageType;c||(c=document),"."!==a.prefix.substr(-1)&&(a.prefix=a.prefix?a.prefix+".":"");var j=function(b){return a.prefix+b},k=function(){try{var c=i in b&&null!==b[i],d=j("__"+Math.round(1e7*Math.random()));return c&&(f=b[i],f.setItem(d,""),f.removeItem(d)),c}catch(e){return i="cookie",a.$broadcast("LocalStorageService.notification.error",e.message),!1}}(),l=function(b,c){if(!k)return a.$broadcast("LocalStorageService.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),h.setItem&&a.$broadcast("LocalStorageService.notification.setitem",{key:b,newvalue:c,storageType:"cookie"}),r(b,c);"undefined"==typeof c&&(c=null);try{(angular.isObject(c)||angular.isArray(c))&&(c=angular.toJson(c)),f&&f.setItem(j(b),c),h.setItem&&a.$broadcast("LocalStorageService.notification.setitem",{key:b,newvalue:c,storageType:this.storageType})}catch(d){return a.$broadcast("LocalStorageService.notification.error",d.message),r(b,c)}return!0},m=function(b){if(!k)return a.$broadcast("LocalStorageService.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),s(b);var c=f?f.getItem(j(b)):null;return c&&"null"!==c?"{"===c.charAt(0)||"["===c.charAt(0)?angular.fromJson(c):c:null},n=function(b){if(!k)return a.$broadcast("LocalStorageService.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),h.removeItem&&a.$broadcast("LocalStorageService.notification.removeitem",{key:b,storageType:"cookie"}),t(b);try{f.removeItem(j(b)),h.removeItem&&a.$broadcast("LocalStorageService.notification.removeitem",{key:b,storageType:this.storageType})}catch(c){return a.$broadcast("LocalStorageService.notification.error",c.message),t(b)}return!0},o=function(){if(!k)return a.$broadcast("LocalStorageService.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;var b=a.prefix.length,c=[];for(var d in f)if(d.substr(0,b)===a.prefix)try{c.push(d.substr(b))}catch(e){return a.$broadcast("LocalStorageService.notification.error",e.Description),[]}return c},p=function(b){b=b||"";var c=a.prefix.slice(0,-1),d=new RegExp(c+"."+b);if(!k)return a.$broadcast("LocalStorageService.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),u();var e=a.prefix.length;for(var g in f)if(d.test(g))try{n(g.substr(e))}catch(h){return a.$broadcast("LocalStorageService.notification.error",h.message),u()}return!0},q=function(){try{return navigator.cookieEnabled||"cookie"in c&&(c.cookie.length>0||(c.cookie="test").indexOf.call(c.cookie,"test")>-1)}catch(b){return a.$broadcast("LocalStorageService.notification.error",b.message),!1}},r=function(b,d){if("undefined"==typeof d)return!1;if(!q())return a.$broadcast("LocalStorageService.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var e="",f=new Date,h="";if(null===d?(f.setTime(f.getTime()+-864e5),e="; expires="+f.toGMTString(),d=""):0!==g.expiry&&(f.setTime(f.getTime()+24*g.expiry*60*60*1e3),e="; expires="+f.toGMTString()),b){var i="; path="+g.path;g.domain&&(h="; domain="+g.domain),c.cookie=j(b)+"="+encodeURIComponent(d)+e+i+h}}catch(k){return a.$broadcast("LocalStorageService.notification.error",k.message),!1}return!0},s=function(b){if(!q())return a.$broadcast("LocalStorageService.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var d=c.cookie&&c.cookie.split(";")||[],e=0;e<d.length;e++){for(var f=d[e];" "===f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(j(b)+"="))return decodeURIComponent(f.substring(a.prefix.length+b.length+1,f.length))}return null},t=function(a){r(a,null)},u=function(){for(var b=null,d=a.prefix.length,e=c.cookie.split(";"),f=0;f<e.length;f++){for(b=e[f];" "===b.charAt(0);)b=b.substring(1,b.length);var g=b.substring(d,b.indexOf("="));t(g)}},v=function(){return i},w=function(a,b,c){var d=m(b);null===d&&angular.isDefined(c)?d=c:angular.isObject(d)&&angular.isObject(c)&&(d=angular.extend(c,d)),a[b]=d,a.$watchCollection(b,function(a){l(b,a)})};return{isSupported:k,getStorageType:v,set:l,add:l,get:m,keys:o,remove:n,clearAll:p,bind:w,deriveKey:j,setPrefix:d,getPrefix:e,cookie:{set:r,add:r,get:s,remove:t,clearAll:u}}}])}(),angular.module("uxData.services").factory("logoutService",["tokenService","$window",function(a,b){var c=function(){a.removeGlobalUser(),a.setGlobalHash(b.location.hash);var c="?return_to="+b.location.pathname.replace(/\//g,"%2F");b.location.href="/"+b.location.pathname.split("/")[1]+"/loginForm"+c};return{cleanTokenAndGoToLoginPage:c}}]),function(){"use strict";angular.module("uxData.services").factory("mediator",function(){return function(a,b,c){var d=[];return function e(b){b&&(b.hasOwnProperty(a)&&d.push(b[a]()),e(b.$$childHead),e(b.$$nextSibling))}(b.$$childHead),c(d)}})}(),function(){"use strict";angular.module("uxData.services").factory("messageService",["$rootScope",function(a){var b="changeApp",c="editServer",d="editRule",e="getServerData",f="receiveSelectServer",g="receiveDefServer",h=function(c){a.$broadcast(b,{name:c})},i=function(a,c){a.$on(b,function(a,b){c(b)})},j=function(b){a.$broadcast(d,{ruleId:b})},k=function(a,b){a.$on(d,function(a,c){b(c)})},l=function(b){a.$broadcast(c,{id:b})},m=function(a,b){a.$on(c,function(a,c){b(c)})},n=function(b){a.$broadcast(f,{data:b})},o=function(a,b){a.$on(f,function(a,c){b(c)})},p=function(b){a.$broadcast(g,{data:b})},q=function(a,b){a.$on(g,function(a,c){b(c)})},r=function(b){a.$broadcast(e,{data:b})},s=function(a,b){a.$on(e,function(a,c){b(c)})};return{changeApp:h,onChangeApp:i,editSelectServer:l,onEditSelectServer:m,editPathRule:j,onEditPathRule:k,receiveServer:n,onReceiveServer:o,defServerReceived:p,onDefServerReceived:q,sendServerData:r,onGetServerData:s}}])}(),function(){"use strict";angular.module("uxData.services").factory("tokenService",["localStorageService","$window","$rootScope","redirectorOfflineMode",function(a,b,c,d){var e=function(a){c.isPageReloading=!1;var e=angular.copy(b.location.search);if(angular.isDefined(e)&&""!=e){var g=e.split("=");if("?token"==g[0]){c.isPageReloading=!0;var i="";null!=b.location.hash&&(i=b.location.hash);var k=h("currentHash");null!=k&&angular.isDefined(k)&&""!=k&&(i=k,f("currentHash"));var l=b.location.href.indexOf("?"),m=b.location.href.substring(0,l);return m+=i,setTimeout(function(){b.location.href=m},0),!0}}var n=d?{username:"dev",permissions:"permitAll"}:a.getAuthInfo();return null!=n&&(j(n),c.currentUser=n),!1},f=function(b){var c=a.getPrefix();a.setPrefix(""),a.remove(b),a.setPrefix(c)},g=function(b,c){var d=a.getPrefix();a.setPrefix(""),a.set(b,c),a.setPrefix(d)},h=function(b){var c=a.getPrefix();a.setPrefix("");var d=a.get(b);return a.setPrefix(c),d},i=function(){return h(d?"offlineUser":"currentUser")},j=function(a){g(d?"offlineUser":"currentUser",a)},k=function(){f("currentUser")},l=function(a){g("currentHash",a)},m=function(){l(b.location.hash)};return{removeGlobalValue:f,getGlobalCurrentUser:i,setGlobalCurrentUser:j,removeGlobalUser:k,saveTokenAndReloadPage:e,setGlobalValue:g,getGlobalValue:h,setGlobalHash:l,getHashFromPageAndSaveItGlobal:m}}])}(),function(){"use strict";function a(a,b){function c(a){return 0===Object.getOwnPropertyNames(a).length}function d(a){return!(null!=a&&!angular.isUndefined(a))}function e(a){var b=!1;if(b=d(a),b===!1)for(var c=0;c<a.length&&(b=d(a[c]),b!==!0);c++);return b}var f=new X2JS({escapeMode:!1}),g=function(a){return angular.isDefined(a)?angular.isArray(a)||(a=[a]):a=[],a},h=function(a){var b=[];return angular.forEach(a,function(a,c){b.push(a)}),b},i=function(a){return f.xml_str2json(a)},j=function(a){return f.json2xml_str(a)},k=function(a){return angular.isUndefined(a)?"":j(a)},l=function(a){return f.xml_str2json(a)},m=function(){return"{protocol}://{host}:{port}/{urn}"},n=function(a){var b=[];if("object"==typeof a.paths)return a.paths=g(a.paths),angular.forEach(a.paths,function(a,c){var d={stacks:[],flavors:[]};a.stack=g(a.stack),angular.forEach(a.stack,function(a,b){d.stacks.push({nodes:a.nodes,text:a.value})}),a.flavor=g(a.flavor),angular.forEach(a.flavor,function(a,b){d.flavors.push({nodes:a.nodes,text:a.value})}),d.serviceName=a.serviceName,b.push(d)}),b},o=function(c){for(var d=b[0].cookie&&b[0].cookie.split(";")||[],e=0;e<d.length;e++){for(var f=d[e];" "===f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(c+"="))return decodeURIComponent(f.substring(a.prefix.length+c.length+1,f.length))}return null},p=function(b,c,d){var e="",f="",g="";return b.indexOf(":")>=0&&(e=b.substring(0,b.indexOf(":")),""===$.trim(e)&&(e=d.host),f=b.substring(b.indexOf(":")+1,b.lastIndexOf(":")),""===$.trim(f)&&(f=d.ip),g=b.substring(b.lastIndexOf(":")+1)),c.replace("{HOSTNAME}",e).replace("{IP}",f).replace("{PORT}",g).replace("{APP}",a.currentApplication)},q=function(a){return!(!$.isEmptyObject(a)&&angular.isDefined(a)&&angular.isString(a))||0===a.replace(/\s/g,"").length},r=function(a){if(angular.isDefined(a)&&null!==a){var b=a.toString().replace(/\s/g,"");return!$.isEmptyObject(b)}return!1},s=function(a){return angular.isUndefined(a)||angular.isDefined(a)&&$.isEmptyObject(a)},t=function(a){return angular.isDefined(a)&&null!=a?a.toString():""},u=function(a){for(var b={},c=0;c<a.length;++c){var d=a[c];if(Object.prototype.hasOwnProperty.call(b,d))return!0;b[d]=!0}return!1},v=function(a,b){var c=b.shift();return a.hasOwnProperty(c)&&(!b.length||v(a[c],b))},w=function(a,b,c){if(v(a,[b,"entry"])&&angular.isArray(a[b].entry)){var d=a[b].entry;for(var e in d)if(angular.equals(d[e].key,c))return d[e].value}},x=function(a,b,c){if(v(a,[b,"entry"])&&angular.isArray(a[b].entry)){var d=a[b].entry;for(var e in d)if(angular.equals(d[e].key,c))return{change:d[e].value,index:e}}},y=function(a,b){return a.indexOf(b)>-1},z=function(a,b){for(var c=!0,d=1;d<arguments.length;d++)a.isAuthorized(arguments[d])||(c=!1);return c},A=function(a){var b=a.match(/^(\/(\w+)){2}/g);return angular.isDefined(b)?b[0]:b},B=function(a){var b=a.match(/^(\/(\w+)){2}/g);return angular.isDefined(b)?a.substring(b[0].length+1,a.length):b};return{toArray:g,stringContains:y,parseServicePaths:n,createUrl:m,jsonObjToXml:k,objectToXml:j,xmlToObject:l,xmlToJson:i,formatHostNameAndIP:p,isEmptyObject:s,isEmptyString:q,isDefinedAndNotEmpty:r,getString:t,getFromCookies:o,arrayHasDuplicates:u,isNullOrUndefined:d,isMapEmpty:c,checkObjHasDeepPath:v,getPendingChangesObjectById:w,getPendingChangesObjectAndIndexById:x,hasPermissions:z,getPathFromStack:A,getFlavorFromStack:B,valuesArray:h,isNullOrUndefinedOrEmptyStringArrayOfValues:e}}angular.module("uxData.services").factory("utilsService",a),a.$inject=["$rootScope","$document"]}(),function(){"use strict";function a(a,b){function c(a){return!m(a)&&!!a.match(b().alphabetical)}function d(a){if(m(a))return!1;var b=new v6.Address(a).isValid(),c=new v4.Address(a).isValid();return!(!c&&!b)}function e(a){return!m(a)&&("4"===a||"6"===a)}function f(a){return!m(a)&&!!a.match(b().numerical)}function g(a){return!m(a)&&!!a.match(b().alphaNumericalWithUnderscores)}function h(a){return!m(a)&&!!a.match(b().stackName)}function i(a){return!m(a)}function j(a){return!k(a)&&!!a.match(b().alphaNumericalWithUnderscoresAndSpaces)}function k(a){return!(null!=a&&!angular.isUndefined(a))}function l(b){return k(b)||a.isEmptyString(b)}function m(a){return l(a)||a.indexOf(" ")!==-1}return{isUnDefinedOrNullOrHasMiddleSpaces:m,isNullOrUndefined:k,isNullOrUndefinedOrEmptyString:l,isProtocolValid:c,isIpValid:d,isPortValid:f,isUrnValid:g,isStackValid:h,isFlavorValid:i,isRuleNameValid:j,isIpVersionValid:e}}angular.module("uxData.services").factory("validationService",a),a.$inject=["utilsService","REGEXP_CONSTANTS"]}(),function(){"use strict";function a(a,b,c,d){function e(){return c.getPendingChangesJson(a.currentApplication)}function f(){return c.saveData(c.getBaseApiUrl()+"modelReload/"+a.currentApplication,"")}function g(){return c.saveData(c.getBaseApiUrl()+"stacksReload/"+a.currentApplication,"")}function h(e,f){var g=b.defer();return c.getPendingChangesJson(a.currentApplication).then(function(a){var b={};b.result={},b.result[f]=d.getPendingChangesObjectById(a,e,f),g.resolve(b)},function(a){g.reject({message:a})}),g.promise}function i(b,d){return c.cancelFlavorRule(a.currentApplication,b,d)}function j(b,d){return c.cancelFlavorRuleTemplate(a.currentApplication,b,d)}function k(b,d){return c.approveFlavorRule(a.currentApplication,b,d)}function l(b,d){return c.approveTemplatePathRule(a.currentApplication,b,d)}function m(b,d){return c.cancelPendingServer(a.currentApplication,b,d)}function n(b,d){return c.approvePendingServer(a.currentApplication,b,d)}function o(b){return c.cancelWhitelisted(a.currentApplication,b)}function p(b){return c.approveWhitelisted(a.currentApplication,b)}function q(b){return c.validateAndApproveWhitelisted(a.currentApplication,b)}function r(b,d){return c.approveUrlRule(a.currentApplication,b,d)}function s(b,d){return c.approveTemplateUrlRule(a.currentApplication,b,d)}function t(b,d){return c.cancelUrlRule(a.currentApplication,b,d)}function u(b,d){return c.cancelUrlRuleTemplate(a.currentApplication,b,d)}function v(b){return c.approvePendingDefaultUrlParams(a.currentApplication,b)}function w(b){return c.cancelPendingDefaultUrlParams(a.currentApplication,b)}function x(b){return c.approveAllPendingChanges(a.currentApplication,b)}function y(b){return c.validateAndApproveAllPendingChanges(a.currentApplication,b)}function z(b){return c.cancelAllPendingChanges(a.currentApplication,b)}function A(b){return c.cancelAllPendingDistribution(a.currentApplication,b)}function B(b){return c.approveAllPendingDistribution(a.currentApplication,b)}function C(){return c.getDistributionPendingPreview(a.currentApplication)}function D(b){return c.getIdsOfNewUnapprovedRules(a.currentApplication,b)}function E(){c.getAllSnapshots().then(function(a){c.downloadCoreBackup(a)},function(a){})}function F(){window.open(c.getBaseApiUrl()+"changes/"+a.currentApplication+"/export",{Accept:"application/xml"})}function G(b,d){window.open(c.getBaseApiUrl()+"changes/"+a.currentApplication+"/export/"+b+"/"+d,{Accept:"application/xml"})}function H(){window.open(c.getBaseApiUrl()+"changes/"+a.currentApplication+"/export/distributions/",{Accept:"application/xml"})}function I(){window.open(c.getBaseApiUrl()+"changes/"+a.currentApplication+"/export/stackmanagement/",{Accept:"application/xml"})}var J={getPendingChanges:c.getPendingChanges,getPendingChangesJson:e,getPendingChangesJsonByEntityType:h,getUnapprovedRulesIds:D,cancelPendingRule:i,cancelTemplatePendingRule:j,cancelTemplatePendingUrlRule:u,cancelPendingServer:m,approvePendingRule:k,approveTemplatePendingRule:l,approveTemplatePendingUrlRule:s,approvePendingServer:n,approveAllPendingDistribution:B,approvePendingChanges:x,validateAndApprovePendingChanges:y,cancelAllPendingChanges:z,cancelAllPendingDistribution:A,getDistributionPendingPreview:C,cancelPendingStackManagement:o,approvePendingStackManagement:p,validateAndApprovePendingStackManagement:q,approvePendingUrlRule:r,cancelPendingUrlRule:t,approvePendingUrlParams:v,cancelPendingUrlParams:w,exportAllPending:F,downloadCoreBackup:E,exportPending:G,exportPendingDistributions:H,exportPendingStackManagement:I,triggerModelReload:f,triggerStacksReload:g};return J}angular.module("uxData.changes").factory("changesRequestsService",a),a.$inject=["$rootScope","$q","requestsService","utilsService"];
}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(a){var b="";return angular.isDefined(a)&&(b=g.getRuleReturnDiffText(a),""!==b&&(b="["+b+"\n]")),b}function j(){var a=b.defer();return d.getDistributionPendingPreview().then(function(b){b.totalPercentage=l(b),a.resolve({pendingDistribution:b})},function(b){a.reject(b)}),a.promise}function k(){var c=b.defer();return h.getDistributions(a.currentApplication).then(function(a){a.totalPercentage=l(a),c.resolve({currentDistribution:a})},function(a){c.reject(a)}),c.promise}function l(a){var b=0;return angular.isDefined(a)&&angular.forEach(a,function(a,c){b+=angular.isUndefined(a.percent)?0:a.percent}),parseFloat(b)||0}function m(){var d=b.defer();return c.getWhitelisted(a.currentApplication).then(function(a){d.resolve({whitelisted:a})},function(a){d.reject(a)}),d.promise}function n(){var c=b.defer();return d.getPendingChanges(a.currentApplication).then(function(a){c.resolve({pending:a})},function(a){c.reject(a)}),c.promise}function o(a){return a.entry.forEach(function(a){var b=a;if(angular.isDefined(b.value.changedExpression)){var c=r(b.value.changedExpression,f);b.value.changedExpression.ruleText=c.ruleText,b.value.changedExpression["return"]=c.returnStatement}if(angular.isDefined(b.value.currentExpression)){var d=r(b.value.currentExpression,f);b.value.currentExpression.ruleText=d.ruleText,b.value.currentExpression["return"]=d.returnStatement}}),a}function p(a){return a.entry.forEach(function(a){var b=a;if(angular.isDefined(b.value.changedExpression)){var c=s(b.value.changedExpression,g);b.value.changedExpression.ruleText=c.ruleText,b.value.changedExpression.returnUrlRule=c.returnStatement}if(angular.isDefined(b.value.currentExpression)){var d=s(b.value.currentExpression,g);b.value.currentExpression.ruleText=d.ruleText,b.value.currentExpression.returnUrlRule=d.returnStatement}}),a}function q(a,b){var c={};c.whitelistCurrentDiff="",c.whitelistChangedDiff="";var d=[];if(angular.isDefined(b)&&angular.isDefined(b.paths)&&angular.isArray(b.paths.entry))for(var e=0;e<b.paths.entry.length;e++)"DELETE"!==b.paths.entry[e].value.action&&(d.push(b.paths.entry[e].key),c.whitelistCurrentDiff+=b.paths.entry[e].key+(e+1!==b.paths.entry.length?"\n":""));if(a.entry.forEach(function(a){var b=a;if(angular.isDefined(b.value.changedExpression)&&("ADD"===b.value.changeType&&d.push(b.value.changedExpression.value),"DELETE"===b.value.changeType)){var c=d.indexOf(b.value.currentExpression.value);c!==-1&&d.splice(c,1)}}),angular.isDefined(d)&&angular.isArray(d))for(var f=0;f<d.length;f++)c.whitelistChangedDiff+=d[f]+(f+1!==d.length?"\n":"");return c}function r(a,b){var c=e.unmarshallJSONRule(a,b);return{ruleText:e.getRuleDiffText(c.expressions,c.returnStatement,b),returnStatement:c.returnStatement}}function s(a,b){var c=e.unmarshallJSONRule(a,b);return{ruleText:e.getRuleDiffText(c.expressions,c.returnStatement,b),returnStatement:c.returnStatement}}function t(){a.isSaving=!0;var c={},d=b.defer(),e=[];return e.push(b.when(j())),e.push(b.when(k())),e.push(b.when(m())),e.push(b.when(n())),b.all(e).then(function(){angular.forEach(e,function(b,e){b.then(function(a){angular.extend(c,a)},function(b){a.isSaving=!1,d.reject(b)})}),a.isSaving=!1,d.resolve(c)},function(b){a.isSaving=!1,d.reject(b)}),d.promise}var u={loadPendingChanges:t,generatePathRules:o,generateUrlRules:p,generateWhitelistedData:q,getUrlParamsViewText:i};return u}angular.module("uxData.changes").factory("changesService",a),a.$inject=["$rootScope","$q","requestsService","changesRequestsService","rulesBuilderService","pathRulesBuilderService","urlRulesBuilderService","distributionRequestService"]}(),function(){"use strict";function a(a,b,c,d){function e(b){return c.saveData(c.getBaseApiUrl()+"redirectorOffline/"+a.currentApplication+"/hasOfflineChanges",b,{"Content-Type":"application/json",Accept:"text/plain"})}function f(){return c.saveData(c.getBaseApiUrl()+"redirectorOffline/"+a.currentApplication+"/hasOfflinePendingChanges",{"Content-Type":"application/json",Accept:"text/plain"})}function g(){return c.getBaseApiUrl()+"redirectorOffline/"+a.currentApplication+"/getOfflinePendingChanges"}function h(){return c.getCoreBackupPendingChangesJson(a.currentApplication)}function i(e,f){var g=b.defer();return c.getCoreBackupPendingChangesJson(a.currentApplication).then(function(a){var b={};b.result={},b.result[f]=d.getPendingChangesObjectById(a,e,f),g.resolve(b)},function(a){g.reject({message:a})}),g.promise}function j(b,d){return c.cancelCoreBackupFlavorRule(a.currentApplication,b,d)}function k(b,d){return c.cancelCoreBackupFlavorRuleTemplate(a.currentApplication,b,d)}function l(b,d){return c.approveCoreBackupFlavorRule(a.currentApplication,b,d)}function m(b,d){return c.approveCoreBackupFlavorRuleTemplate(a.currentApplication,b,d)}function n(b,d){return c.cancelCoreBackupPendingServer(a.currentApplication,b,d)}function o(b,d){return c.approveCoreBackupPendingServer(a.currentApplication,b,d)}function p(b){return c.cancelCoreBackupWhitelisted(a.currentApplication,b)}function q(b){return c.approveCoreBackupWhitelisted(a.currentApplication,b)}function r(b){return c.validateAndApproveCoreBackupWhitelisted(a.currentApplication,b)}function s(b,d){return c.approveCoreBackupUrlRule(a.currentApplication,b,d)}function t(b,d){return c.approveCoreBackupTemplateUrlRule(a.currentApplication,b,d)}function u(b,d){return c.cancelCoreBackupUrlRule(a.currentApplication,b,d)}function v(b,d){return c.cancelCoreBackupUrlRuleTemplate(a.currentApplication,b,d)}function w(b){return c.approveCoreBackupPendingDefaultUrlParams(a.currentApplication,b)}function x(b){return c.cancelCoreBackupPendingDefaultUrlParams(a.currentApplication,b)}function y(b){return c.approveAllCoreBackupPendingChanges(a.currentApplication,b)}function z(b){return c.validateAndApproveAllCoreBackupPendingChanges(a.currentApplication,b)}function A(b){return c.cancelAllCoreBackupPendingChanges(a.currentApplication,b)}function B(b){return c.cancelAllCoreBackupPendingDistribution(a.currentApplication,b)}function C(b){return c.approveAllCoreBackupPendingDistribution(a.currentApplication,b)}function D(){return c.getCoreBackupDistributionPendingPreview(a.currentApplication)}function E(b){return c.getIdsOfNewUnapprovedRules(a.currentApplication,b)}function F(a){return c.approveAllNamespacesChanges(a)}function G(a){return c.approveNamespacesChanges(a)}function H(){return c.cancelAllNamespacesChanges()}function I(a){return c.cancelNamespacesChanges(a)}var J={getCoreBackupUploadUrl:g,getPendingChanges:c.getCoreBackupPendingChangesJson,getPendingChangesJson:h,getPendingChangesJsonByEntityType:i,getUnapprovedRulesIds:E,cancelPendingRule:j,cancelTemplatePendingRule:k,cancelTemplatePendingUrlRule:v,cancelPendingServer:n,approvePendingRule:l,approveTemplatePendingRule:m,approveTemplatePendingUrlRule:t,approvePendingServer:o,approveAllPendingDistribution:C,approvePendingChanges:y,validateAndApprovePendingChanges:z,cancelAllPendingChanges:A,cancelAllPendingDistribution:B,getDistributionPendingPreview:D,cancelPendingStackManagement:p,approvePendingStackManagement:q,validateAndApprovePendingStackManagement:r,approvePendingUrlRule:s,cancelPendingUrlRule:u,approvePendingUrlParams:w,cancelPendingUrlParams:x,approveNamespacesChanges:G,approveAllNamespacesChanges:F,cancelAllNamespacesChanges:H,cancelNamespacesChanges:I,hasPendingChanges:f,hasChanges:e};return J}angular.module("uxData.changesOffline").factory("changesOfflineRequestsService",a),a.$inject=["$rootScope","$q","requestsService","utilsService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(a){var b="";return angular.isDefined(a)&&(b=g.getRuleReturnDiffText(a),""!==b&&(b="["+b+"\n]")),b}function j(){var a=b.defer();return d.getDistributionPendingPreview().then(function(b){b.totalPercentage=l(b),a.resolve({pendingDistribution:b})},function(b){a.reject(b)}),a.promise}function k(){var c=b.defer();return h.getDistributions(a.currentApplication).then(function(a){a.totalPercentage=l(a),c.resolve({currentDistribution:a})},function(a){c.reject(a)}),c.promise}function l(a){var b=0;return angular.isDefined(a)&&angular.forEach(a,function(a,c){b+=angular.isUndefined(a.percent)?0:a.percent}),parseFloat(b)||0}function m(){var d=b.defer();return c.getWhitelisted(a.currentApplication).then(function(a){d.resolve({whitelisted:a})},function(a){d.reject(a)}),d.promise}function n(){var c=b.defer();return d.getPendingChanges(a.currentApplication).then(function(a){c.resolve({pending:a})},function(a){c.reject(a)}),c.promise}function o(a){return a.entry.forEach(function(a){var b=a;if(angular.isDefined(b.value.changedExpression)){var c=r(b.value.changedExpression,f);b.value.changedExpression.ruleText=c.ruleText,b.value.changedExpression["return"]=c.returnStatement}if(angular.isDefined(b.value.currentExpression)){var d=r(b.value.currentExpression,f);b.value.currentExpression.ruleText=d.ruleText,b.value.currentExpression["return"]=d.returnStatement}}),a}function p(a){return a.entry.forEach(function(a){var b=a;if(angular.isDefined(b.value.changedExpression)){var c=s(b.value.changedExpression,g);b.value.changedExpression.ruleText=c.ruleText,b.value.changedExpression.returnUrlRule=c.returnStatement}if(angular.isDefined(b.value.currentExpression)){var d=s(b.value.currentExpression,g);b.value.currentExpression.ruleText=d.ruleText,b.value.currentExpression.returnUrlRule=d.returnStatement}}),a}function q(a,b){var c={};c.whitelistCurrentDiff="",c.whitelistChangedDiff="";var d=[];if(angular.isDefined(b)&&angular.isDefined(b.paths)&&angular.isArray(b.paths.entry))for(var e=0;e<b.paths.entry.length;e++)"DELETE"!==b.paths.entry[e].value.action&&(d.push(b.paths.entry[e].key),c.whitelistCurrentDiff+=b.paths.entry[e].key+(e+1!==b.paths.entry.length?"\n":""));if(a.entry.forEach(function(a){var b=a;if(angular.isDefined(b.value.changedExpression)&&("ADD"===b.value.changeType&&d.push(b.value.changedExpression.value),"DELETE"===b.value.changeType)){var c=d.indexOf(b.value.currentExpression.value);c!==-1&&d.splice(c,1)}}),angular.isDefined(d)&&angular.isArray(d))for(var f=0;f<d.length;f++)c.whitelistChangedDiff+=d[f]+(f+1!==d.length?"\n":"");return c}function r(a,b){var c=e.unmarshallJSONRule(a,b);return{ruleText:e.getRuleDiffText(c.expressions,c.returnStatement,b),returnStatement:c.returnStatement}}function s(a,b){var c=e.unmarshallJSONRule(a,b);return{ruleText:e.getRuleDiffText(c.expressions,c.returnStatement,b),returnStatement:c.returnStatement}}function t(){a.isSaving=!0;var c={},d=b.defer(),e=[];return e.push(b.when(j())),e.push(b.when(k())),e.push(b.when(m())),e.push(b.when(n())),b.all(e).then(function(){angular.forEach(e,function(b,e){b.then(function(a){angular.extend(c,a)},function(b){a.isSaving=!1,d.reject(b)})}),a.isSaving=!1,d.resolve(c)},function(b){a.isSaving=!1,d.reject(b)}),d.promise}function u(){var d=b.defer();return c.getNamespacesChangesStatus(a.currentApplication).then(function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise}var v={loadPendingChanges:t,generatePathRules:o,generateUrlRules:p,generateWhitelistedData:q,getUrlParamsViewText:i,loadNamespacesChanges:u};return v}angular.module("uxData.changesOffline").factory("changesOfflineService",a),a.$inject=["$rootScope","$q","requestsService","changesOfflineRequestsService","rulesBuilderService","pathRulesBuilderService","urlRulesBuilderService","distributionRequestService"]}(),function(){"use strict";function a(){function a(){var a=[],b=[],c=[],d=function(a,b){c.unshift({leftPosition:a,leftEndPosition:a,rightPosition:b,rightEndPosition:b})},e=function(a){b.unshift({position:a,endPosition:a})},f=function(b){a.unshift({position:b,endPosition:b})},g=function(a){return a?a.endPosition-a.position+1:0},h=function(){n(a),n(b),i();do for(var d=!1,e=0;e<c.length;e++){var f=c[e].leftEndPosition-c[e].leftPosition+1,h=m(b,c[e].leftPosition-1),o=l(b,c[e].leftEndPosition+1),p=m(a,c[e].rightPosition-1),q=l(a,c[e].rightEndPosition+1);f<=8&&g(h)+g(p)>=f&&g(o)+g(q)>=f&&(d=!0,h&&o?(h.endPosition=o.endPosition,k(b,o)):h?h.endPosition=c[e].leftEndPosition:o?o.position=c[e].leftPosition:j(b,c[e].leftPosition,c[e].leftEndPosition),p&&q?(p.endPosition=q.endPosition,k(a,q)):p?p.endPosition=c[e].rightEndPosition:q?q.position=c[e].rightPosition:j(a,c[e].rightPosition,c[e].rightEndPosition),c.splice(e,1))}while(d)},i=function(){for(var a=0;a<c.length;a++)a+1<c.length&&c[a].leftEndPosition+1===c[a+1].leftPosition&&c[a].rightEndPosition+1===c[a+1].rightPosition&&(c[a].leftEndPosition=c[a+1].leftEndPosition,c[a].rightEndPosition=c[a+1].rightEndPosition,c.splice(a+1,1),a--)},j=function(a,b,c){var d={position:b,endPosition:c};if(0===a.length)a.push(d);else if(b<a[0].position)a.unshift(d);else for(var e=a.length-1;e>=0;e--)if(b>a[e].position){a.splice(e+1,0,d);break}},k=function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b){a.splice(c,1);break}},l=function(a,b){for(var c=0;c<a.length;c++)if(a[c].position===b)return a[c]},m=function(a,b){for(var c=0;c<a.length;c++)if(a[c].endPosition===b)return a[c]},n=function(a){for(var b=0;b<a.length;b++)b+1<a.length&&a[b].endPosition+1===a[b+1].position&&(a[b].endPosition=a[b+1].endPosition,a.splice(b+1,1),b--)};return{addDelete:e,addInsert:f,addCommon:d,cleanUp:h,added:a,deleted:b,common:c}}function b(){var a={},b=function(b){a[b]=!0},c=function(b,c){a[b]=c},d=function(b){a[b]=void 0},e=function(){return h().length},f=function(b){return a[b]},g=function(a,b){return a-b},h=function(){var b=[];for(var c in a)a[c]&&b.push(parseInt(c));return b.sort(g)},i=function(b){return void 0!==a[b]},j=function(b){var c={};for(var d in a){var e=a[d];if(e){var f=parseInt(d);f>=b?c[f+1]=e:c[f]=e}}a=c};return{add:b,addValue:c,get:f,remove:d,count:e,all:h,updateNumbers:j,contains:i}}function c(a,c){var e=b(),f=a.added.all(),g=a.deleted.all(),h=function(b){return!a.added.contains(b)&&!a.deleted.contains(b)};h(0)||e.add(0);for(var i=0;i<Math.max(Math.max.apply(null,f),Math.max.apply(null,g));i++)h(i)&&!h(i+1)&&e.add(i);var j=function(b,d){for(var f="",g=m(a,d),h=n(a,b,d),i=g;i<h;i++)if(e.contains(i)&&(f+='<a name="'+i+'"></a>'),c.contains(i)&&a.modifiedLeft.contains(i)){var j=c.get(i);f+=l(b[i],j.deleted)}else{var k=o(a,i);f+=q(k,b[i])}return f},k=function(b,d){for(var e="",f=m(a,d),g=n(a,b,d),h=f;h<g;h++)if(c.contains(h)&&a.modifiedRight.contains(h)){var i=c.get(h);e+=l(b[h],i.added)}else{var j=p(a,h);e+=q(j,b[h])}return e},l=function(a,b){for(var c='<span class="modified">',d=0,e=0;e<b.length;e++)c+=r(a.substring(d,b[e].position)),d=b[e].endPosition+1,c+='<span class="modified-light">'+r(a.substring(b[e].position,d))+"</span>";return d<a.length&&(c+=r(a.substring(d,a.length))),c+="</span><br>"},m=function(a,b){if(b.showAllContent)return 0;var c,d=a.deleted.all(),e=d.length>0?d[0]:-1,f=a.added.all(),g=f.length>0?f[0]:-1;return c=e===-1?g:g===-1?e:Math.min(e,g),Math.max(0,c-10)},n=function(a,b,c){if(c.showAllContent)return b.length;var d=a.deleted.all(),e=d.length>0?d[d.length-1]:0,f=a.added.all(),g=f.length>0?f[f.length-1]:0,h=Math.max(e,g);return Math.min(b.length,h+11)},o=function(a,b){var c="";return a.modifiedLeft.contains(b)?c="modified":a.paddingLeft.contains(b)?c="padding":a.deleted.contains(b)&&(c="deleted"),c},p=function(a,b){var c="";return a.modifiedRight.contains(b)?c="modified":a.paddingRight.contains(b)?c="padding":a.added.contains(b)&&(c="inserted"),c},q=function(a,b){var c="";return""!=a&&(c+='<span class="'+a+'">'),c+=r(b),""!=a&&(c+="</span>"),c+="<br>"},r=function(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},c=a.replace(/\t/g,"   ");return String(c).replace(/[&<>"'\/]/g,function(a){return b[a]})},s=function(){return d(e)};return{formatLeftText:j,formatRightText:k,getEditIterator:s}}function d(a){var b=a.all(),c=0,d=function(){return c+1<b.length&&(c++,b[c])},e=function(){return c-1>=0&&(c--,b[c])};return{getNextEdit:d,getPrevEdit:e}}var e={lineDiff:a,lineFormatter:c,editSet:b};return e}angular.module("uxData.diff").factory("diffLineService",a)}(),function(){"use strict";function a(){function a(a,g){var h=f(a),i=f(g);e(h),e(i);for(var j=1;j<h.length-1;j++)for(var k=1;k<i.length-1;k++)if(h[j]===i[k]){b(h,j,1);break}for(var j=1;j<h.length-1;j++)for(var k=1;k<i.length-1;k++)c(h[j],i[k])&&b(i,k,j);var l=d(h),m=d(i);return[l,m]}function b(a,b,c){var d=a[b];a.splice(b,1),a.splice(c,0,d)}function c(a,b){var c=a.slice(0,a.indexOf(":")),d=b.slice(0,b.indexOf(":"));return c===d}function d(a){var b="";return angular.forEach(a,function(a){b+=a+"\n"}),b}function e(a){for(var b=1;b<a.length-1;b++)a[b].lastIndexOf(",")===a[b].length-1&&(a[b]=a[b].slice(0,a[b].lastIndexOf(",")))}function f(a){return a.split(/\r?\n/)}var g={sortedLines:a};return g}angular.module("uxData.diff").factory("diffTestCaseService",a)}(),function(){"use strict";function a(a,b){function c(c,h,i,j){if("testSuite"===j.type){var k=b.sortedLines(c,h);c=k[0],h=k[1]}var l=g(c,h,j),k=d(c,h,l),m=k[0],n=k[1];e(m,n,l);var o=f(m,n,l,j),p=a.lineFormatter(l,o),q=p.formatLeftText(m,j),r=p.formatRightText(n,j);return"left"==angular.lowercase(i)?q:r}function d(b,c,d){var e=w(b),f=w(c);v(e),v(f),d.paddingLeft=a.editSet(),d.paddingRight=a.editSet();for(var g=0;g<Math.max(e.length,f.length);g++)!d.deleted.contains(g)&&d.added.contains(g)?(e.splice(g,0," "),d.deleted.updateNumbers(g),d.paddingLeft.add(g)):d.deleted.contains(g)&&!d.added.contains(g)&&(f.splice(g,0," "),d.added.updateNumbers(g),d.paddingRight.add(g));return[e,f]}function e(b,c,d){d.modifiedRight=a.editSet(),d.modifiedLeft=a.editSet();for(var e=0;e<b.length&&e<c.length;e++)d.added.contains(e)&&d.deleted.contains(e)?(d.modifiedLeft.add(e),d.modifiedRight.add(e)):d.added.contains(e)&&d.modifiedRight.contains(e-1)?d.modifiedRight.add(e):d.deleted.contains(e)&&d.modifiedLeft.contains(e-1)&&d.modifiedLeft.add(e)}function f(b,c,d,e){for(var f=a.editSet(),g=0;g<b.length&&g<c.length;g++)if(d.modifiedLeft.contains(g)||d.modifiedRight.contains(g)){var h=i(b[g],c[g],e);h.cleanUp(),f.addValue(g,h)}return f}function g(a,b,c){var d=w(a),e=w(b);v(d),v(e);var f=h(d,e,c),g=t(f,d,e);u(f,d,e,g,c);var i=n(d,e,f,g,c);return q(w(a),i.deleted,c),q(w(b),i.added,c),i}function h(a,b,c){for(var d=function(c){return a.length>c&&b.length>c},e=0;d(e)&&p(a[e],b[e],c);)e++;for(;d(e)&&p(a[a.length-1],b[b.length-1],c);)a.pop(),b.pop();return e}function i(a,b,c){var d=k(a,c),e=k(b,c),f=a.length-d.length,g=b.length-e.length;d=j(d),e=j(e);var h=t(0,d,e);return u(0,d,e,h,c),m(d,e,f,g,h)}function j(a){return a?a.trimRight():a}function k(a,b){return a&&b.ignoreLeadingWS?a.trimLeft():a}function l(a,b){return a?b.ignoreLeadingWS?a.trim():a.trimRight():a}function m(b,c,d,e,f){for(var g=a.lineDiff(),h=b.length,i=c.length;h>=0&&i>=0;)b[h-1]===c[i-1]?(b[h-1]&&g.addCommon(d+h-1,e+i-1),h--,i--):i>=0&&(0===h||f[h][i-1]>=f[h-1][i])?(c[i-1].length>0&&g.addInsert(e+i-1),i--):h>=0&&(0===i||f[h][i-1]<f[h-1][i])&&(b[h-1].length>0&&g.addDelete(d+h-1),h--);return g}function n(b,c,d,e,f){var g=b.length,h=c.length,i=a.editSet(),j=a.editSet(),k=o(b,c,i)||o(c,b,j);if(!k)for(;g>=d&&h>=d;){var l=g-d,m=h-d;l>0&&m>0&&p(b[g-1],c[h-1],f)?(g--,h--):h>=d&&(g===d||e[l][m-1]>=e[l-1][m])?(h-1>=d&&c[h-1].length>0&&i.add(h-1),h--):g>=d&&(h===d||e[l][m-1]<e[l-1][m])&&(g-1>=d&&b[g-1].length>0&&j.add(g-1),g--)}return{added:i,deleted:j}}function o(a,b,c){if(1===a.length&&""===a[0]){for(var d=0;d<b.length;d++)c.add(d);return!0}return!1}function p(a,b,c){return l(a,c)===l(b,c)}function q(a,b,c){var d=b.all();if(d.length>0)for(var e=d[0],f=e,g=1;g<d.length;g++)g===d.length-1?(d[g]===f+1&&f++,r(a,b,e,f,c)):d[g]===f+1?f++:(r(a,b,e,f,c),e=f=d[g])}function r(a,b,c,d,e){p(a[c],a[d+1],e)&&s(a[c+1])&&(b.remove(c),b.add(d+1))}function s(a){return/^\s*$/.test(a)}function t(a,b,c){for(var d=[],e=0;e<=b.length-a;e++)d[e]=new Array(c.length-a+1),d[e][0]=0;for(var f=1;f<=c.length-a;f++)d[0][f]=0;return d}function u(a,b,c,d,e){for(var f=1;f<=b.length-a;f++)for(var g=l(b[f+a-1],e),h=1;h<=c.length-a;h++){var i=l(c[h+a-1],e);g===i?d[f][h]=d[f-1][h-1]+1:d[f][h]=Math.max(d[f][h-1],d[f-1][h])}}function v(a){if(1!==a.length||""!==a[0])for(var b=0;b<a.length;b++)""===a[b]&&(a[b]=" ")}function w(a){return a.split(/\r?\n/)}var x={formattedDiff:c};return x}angular.module("uxData.diff").factory("diffService",a),a.$inject=["diffLineService","diffTestCaseService"]}(),function(){"use strict";function a(a){function b(){a.error("Can't retrieve items","Error",{closeButton:!0,timeOut:3e3})}function c(){a.error("Can't get servicePath","Error",{closeButton:!0,timeOut:3e3})}function d(){a.error("Duplicated servers!","Error",{closeButton:!0,timeOut:3e3})}function e(){a.error("Total percentage is more than 99.99%.","Error",{closeButton:!0,timeOut:3e3})}function f(){a.error("Add the new item first","Error",{closeButton:!0,timeOut:3e3})}function g(){a.error("Can't save items","Error",{closeButton:!0,timeOut:3e3})}function h(){a.error("Path is not selected!","Error",{closeButton:!0,timeOut:3e3})}function i(){a.success("Saved. Have you Verified Whitelist for Distribution?","Success",{closeButton:!0,timeOut:3e3})}function j(){a.error("This distribution will be deleted on Save","Reminder",{closeButton:!0,timeOut:3e3})}var k={errorGetItems:b,errorGetPaths:c,errorHasDuplicatedServers:d,errorPercentageIncorrect:e,errorItemNotAdded:f,successSaved:i,errorPathNotSelected:h,errorItemNotSaved:g,infoWillBeDeleted:j};return k}angular.module("uxData.distribution").factory("distributionAlertsService",a),a.$inject=["toastr"]}(),function(){"use strict";function a(a,b,c,d,e){function f(a){return j.getDistribution(a)}function g(a,b){return j.saveDistribution(a,b)}function h(){window.open(c.getBaseApiUrl()+"distributions/export/"+a.currentApplication)}function i(a,b){return j.saveDistributionWithDefaultServer(a,b)}var j;return j=e?b.get("IndexedDBDataSource"):b.get("WebServiceDataSource"),{getDistributions:f,sendDistributions:g,exportDistributions:h,saveDistributionWithDefaultServer:i}}angular.module("uxData.distribution").factory("distributionRequestService",a),a.$inject=["$rootScope","$injector","requestsService","distributionAlertsService","redirectorOfflineMode"]}(),function(){"use strict";function a(a){function b(b){var c={isValid:!0,validationData:{queryError:[]}};return angular.isDefined(b)&&null!=b&&angular.isDefined(b.entry)&&null!=b.entry&&angular.forEach(b.entry,function(b,d){a.isDefinedAndNotEmpty(b.key)&&a.isDefinedAndNotEmpty(b.value)||(c.validationData.queryError[d]="Query key/value should not be empty",c.isValid=!1)}),c}function c(b,c){var d={queryError:[]};return angular.isDefined(c)&&c.length>0&&angular.forEach(c,function(c,e){a.isDefinedAndNotEmpty(b.entry[e].key)&&a.isDefinedAndNotEmpty(b.entry[e].value)||(d.queryError[e]=c)}),d}function d(a,b){return angular.isDefined(a)&&a.length>0&&a.splice(b,1),a}var e={validateQueryPair:b,checkValidationQueryPairAfterChanges:c,removeValidationErrorIfExists:d};return e}angular.module("uxData.distribution").factory("distributionValidationService",a),a.$inject=["utilsService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(f,g){var h=a.defer();b.info("trying to save distributions"),c.isSaving=!0;for(var i=[],j=0;j<f.length;j++){var k=f[j];null!==k&&(k.hasOwnProperty("changeType")&&delete k.changeType,k.hasOwnProperty("hasChanges")&&delete k.hasChanges,k.changeType!==d.PENDING_CHANGE_TYPE.DELETE&&i.push(k))}var l=c.currentApplication;return e.saveDistributionWithDefaultServer(l,angular.toJson({distribution:{rule:i},defaultServer:g})).then(function(a){b.info("Distributions are saved, got response with status:",a),h.resolve(a),c.isSaving=!1},function(a){b.error("Error saving distributions:",a),h.reject(a),c.isSaving=!1}),h.promise}function i(c){b.info("Trying to get distributions with changes");var d=a.defer(),g={changes:{},distribution:{}};return f.getPendingChangesJson(c).then(function(a){b.info("Got pending changes: ",a),g.changes=a,e.getDistributions(c).then(function(a){b.info("Got distributions: ",a),g.distribution=a,d.resolve(g)},function(a){b.error("Error getting distributions: ",a),g.distribution=a,d.reject(g)})},function(a){b.error("Error getting pending changes: ",a),g.changes=a,d.reject(g)}),d.promise}var j,k=100;return j={MAX_TOTAL_Percentage:k,validateAndSaveDistributions:h,getDistributionsWithChanges:i},c.isSaving=!1,j}angular.module("uxData.distribution").service("distributionService",a),a.$inject=["$q","$log","$rootScope","constantsProvider","distributionRequestService","requestsService","distributionAlertsService"]}(),function(){"use strict";function a(a){function b(b){var c={};return angular.equals(a().EXPRESSION_TYPE.PATH_RULE_EXP,b)||angular.isUndefined(b)?(c[a().OPERATOR_TYPE.EQUAL]={name:"Equals",value:a().OPERATOR_TYPE.EQUAL},c[a().OPERATOR_TYPE.MATCHES]={name:"Matches",value:a().OPERATOR_TYPE.MATCHES},c[a().OPERATOR_TYPE.NOTEQUAL]={name:"Not Equals",value:a().OPERATOR_TYPE.NOTEQUAL},c[a().OPERATOR_TYPE.CONTAINS_NMSP]={name:"Contains Namespaced List",value:a().OPERATOR_TYPE.CONTAINS_NMSP},c[a().OPERATOR_TYPE.IN_IP_RANGE]={name:"In IP Range",value:a().OPERATOR_TYPE.IN_IP_RANGE},c[a().OPERATOR_TYPE.IN_IP_RANGE_NMSP]={name:"In IP Range Namespaced",value:a().OPERATOR_TYPE.IN_IP_RANGE_NMSP},c[a().OPERATOR_TYPE.LESSTHAN]={name:"Less Than",value:a().OPERATOR_TYPE.LESSTHAN},c[a().OPERATOR_TYPE.LESSOREQUAL]={name:"Less Than or Equal To",value:a().OPERATOR_TYPE.LESSOREQUAL},c[a().OPERATOR_TYPE.GREATERTHAN]={name:"Greater Than",value:a().OPERATOR_TYPE.GREATERTHAN},c[a().OPERATOR_TYPE.GREATEROREQUAL]={name:"Greater Than or Equal To",value:a().OPERATOR_TYPE.GREATEROREQUAL},c[a().OPERATOR_TYPE.ISEMPTY]={name:"Is Empty",value:a().OPERATOR_TYPE.ISEMPTY},c[a().OPERATOR_TYPE.RANDOM]={name:"Random",value:a().OPERATOR_TYPE.RANDOM}):angular.equals(a().EXPRESSION_TYPE.URL_RULE_EXP,b)&&(c[a().OPERATOR_TYPE.EQUAL]={name:"Equals",value:a().OPERATOR_TYPE.EQUAL},c[a().OPERATOR_TYPE.MATCHES]={name:"Matches",value:a().OPERATOR_TYPE.MATCHES},c[a().OPERATOR_TYPE.CONTAINS_NMSP]={name:"Contains Namespaced List",value:a().OPERATOR_TYPE.CONTAINS_NMSP},c[a().OPERATOR_TYPE.IN_IP_RANGE]={name:"In IP Range",value:a().OPERATOR_TYPE.IN_IP_RANGE},c[a().OPERATOR_TYPE.IN_IP_RANGE_NMSP]={name:"In IP Range Namespaced",value:a().OPERATOR_TYPE.IN_IP_RANGE_NMSP},c[a().OPERATOR_TYPE.PERCENT]={name:"Percent",value:a().OPERATOR_TYPE.PERCENT},c[a().OPERATOR_TYPE.RANDOM]={name:"Random",value:a().OPERATOR_TYPE.RANDOM}),c}function c(){var b={};return b[a().VALUE_TYPE.NONE]={name:"NONE",value:a().VALUE_TYPE.NONE},b[a().VALUE_TYPE.STRING]={name:"String",value:a().VALUE_TYPE.STRING},b[a().VALUE_TYPE.NUMERIC]={name:"Numeric",value:a().VALUE_TYPE.NUMERIC},b[a().VALUE_TYPE.IPV6]={name:"IPv6",value:a().VALUE_TYPE.IPV6},b[a().VALUE_TYPE.VERSION]={name:"Version / IPv4 address",value:a().VALUE_TYPE.VERSION},b}var d={buildOperators:b,buildValueTypes:c};return d}angular.module("uxData.expression").factory("expressionBuilderService",a),a.$inject=["EXPRESSION_CONSTANTS"]}(),function(){"use strict";function a(a,b){function c(a,b,c){angular.isUndefined(b[a])||angular.forEach(b[a],function(b,e){var f=!1;angular.forEach(c[a].expValues,function(a,c){f||(f=angular.equals(b.name,a.name),b.alreadySelected=f)}),!f&&angular.equals(c[j].expOperator,c[k].expOperator)&&angular.forEach(c[d(a)].expValues,function(a,c){f||(f=angular.equals(b.name,a.name),b.alreadySelected=f)})})}function d(a){return angular.equals(a,j)?k:j}function e(a){for(var b=[],c=0;c<a.expValues.length;c++)"function"==typeof a.expValues[c]||"object"==typeof a.expValues[c]?b.push(a.expValues[c].name):b.push(a.expValues[c]);return b}function f(b,c,d){return angular.equals(c[b].expOperator,a().OPERATOR_TYPE.CONTAINS)||angular.equals(c[b].expOperator,a().OPERATOR_TYPE.CONTAINS_NMSP)||angular.equals(c[b].expOperator,a().OPERATOR_TYPE.IN_IP_RANGE)||angular.equals(c[b].expOperator,a().OPERATOR_TYPE.IN_IP_RANGE_NMSP)}function g(b){return angular.equals(b.expOperator,a().OPERATOR_TYPE.LESSTHAN)||angular.equals(b.expOperator,a().OPERATOR_TYPE.LESSOREQUAL)||angular.equals(b.expOperator,a().OPERATOR_TYPE.GREATERTHAN)||angular.equals(b.expOperator,a().OPERATOR_TYPE.GREATEROREQUAL)}function h(b,c){return angular.equals(b[c].expOperator,a().OPERATOR_TYPE.CONTAINS_NMSP)||angular.equals(b[c].expOperator,a().OPERATOR_TYPE.IN_IP_RANGE_NMSP)}function i(b,c){return angular.equals(b[c].expOperator,a().OPERATOR_TYPE.IN_IP_RANGE)||angular.equals(b[c].expOperator,a().OPERATOR_TYPE.IN_IP_RANGE_NMSP)}var j=b().LEFT,k=b().RIGHT,l={isRelationalOperator:g,isValueTypeNamespace:h,isOperatorInIpRange:i,isMultivalueOperatorSelected:f,updateSelectedNamespaces:c,getNamespaceNames:e,getOppositeSide:d};return l}angular.module("uxData.expression").factory("expressionService",a),a.$inject=["EXPRESSION_CONSTANTS","RULES_CONSTANTS"]}(),function(){"use strict";function a(a){function b(a,b,c){return function(d){c.$apply(function(){b.resolve(a.result)}),c.$emit("fileProgress",{total:d.loaded,loaded:d.loaded})}}function c(a,b,c){return function(){c.$apply(function(){b.reject(a.result)})}}function d(a,b){return function(a){b.$emit("fileProgress",{total:a.total,loaded:a.loaded})}}function e(a,e){var f=new FileReader;return f.onload=b(f,a,e),f.onerror=c(f,a,e),f.onprogress=d(f,e),f}function f(b,c){var d=a.defer(),f=e(d,c);return f.readAsDataURL(b),d.promise}function g(b,c){var d=a.defer(),f=e(d,c);return f.readAsText(b),d.promise}var h={readAsDataUrl:f,readAsTextContent:g};return h}angular.module("uxData.services").factory("fileReader",a),a.$inject=["$q"]}(),function(){"use strict";function a(a,b,c,d,e){function f(a,e,f){var h=b.defer();return angular.isUndefined(a)?(h.reject("File name is undefined"),h.promise):((null==e||angular.isUndefined(e))&&(e=g),a.size>g?(h.reject("File is too big ["+a.name+"], try to use a smaller one, limit is "+e+" bytes"),h.promise):(d.wait(void 0,void 0,0),c.readAsTextContent(a,f)))}var g=52428800;a.$on("fileProgress",function(b,c){if(c.loaded<c.total){var d=Math.round(100*c.loaded/c.total);a.$broadcast("dialogs.wait.progress",{progress:d})}else a.$broadcast("dialogs.wait.progress",{progress:100}),e(function(){a.$broadcast("dialogs.wait.complete")},1e3)});var h={openFile:f};return h}angular.module("uxData.services").factory("importService",a),a.$inject=["$rootScope","$q","fileReader","dialogs","$timeout"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(d,e){var f=c.defer();return l.openFile(d,null,b).then(function(b){a.info("File "+d+" is read successfully"),p(b,e).then(function(a){f.resolve(a)},function(a){f.reject(a)})},function(b){a.error("File is not read: "+b.message),h.errorGetFile(b.message),f.reject(b)}),f.promise}function p(b,e){var f=c.defer();return d.loadServicePaths().then(function(c){try{c=c.servicePaths,a.info("Trying to get rules from the following structure: ",b);var d=JSON.parse(b);angular.isDefined(d.id)&&(d={"if":d}),f.resolve(k.unmarshallJSONRulesForPreview(d,void 0,e===w?c:null,e,e===w?j:m))}catch(g){f.reject(),h.genericError("can't parse file"),a.error("can't parse file",g)}},function(b){f.reject(),a.error("Error loading stacks")}),f.promise}function q(b,d,e){var f=c.defer(),i=e===w?g.saveRule:n.saveUrlRule;return i(d[b].rule,b).then(function(c){delete d[b],a.info("Rule "+b+" is imported"),h.successImportRule(b),f.resolve()},function(c){h.genericError(angular.isDefined(c.data.message)?c.data.message:c.message),d[b].error={showError:!0,message:c.data.message},a.error("error importing rule ",c.data.message),f.reject(c)}),f.promise}function r(b,d,e){var g=c.defer();return f.saveTemplate(e===w?i().TEMPLATES_TYPE.PATH:i().TEMPLATES_TYPE.URL,d[b].rule,b).then(function(c){delete d[b],a.info("Rule "+b+" is imported as template"),h.successImportRule(b),g.resolve()},function(c){h.genericError(angular.isDefined(c.message.data)?c.message.data:c.message),d[b].error={showError:!0,message:"Error: "+c.message.data},a.error("Error importing rule as template",c),g.reject(c)}),g.promise}function s(b,c,f,g){var i=g===w?d.loadRulesPathsChanges:e.loadUrlRulesPathsChanges;i().then(function(a){
t(a,b,f,g)&&(c?r(b,f,g):q(b,f,g))},function(c){h.genericError(c.message),f[b].error={showError:!0,message:"Error: "+c.message.data},a.error("Error validating rule",error)})}function t(b,c,d,e){if(angular.isDefined(b)){var f=e==w?b.rules:b.urlRules;if(angular.isDefined(f)&&angular.isDefined(f["if"])&&angular.isArray(f["if"]))for(var g=0;g<f["if"].length;g++)if(f["if"][g].id===c)return h.errorDuplicateCurrent(c),d[c].error={showError:!0,message:"Error: the rule with this name already exists in current rules"},a.error("Duplicates found "+d[c].error.message),!1;var i=e==w?b.pendingChanges.pathRules:b.pendingChanges.urlRules;if(angular.isDefined(i)&&angular.isDefined(i.entry)&&angular.isArray(i.entry))for(var g=0;g<i.entry.length;g++)if(i.entry[g].key===c)return h.errorDuplicatePending(c),d[c].error={showError:!0,message:"Error: the rule with this name already exists in pending rules"},a.error("Duplicates found "+d[c].error.message),!1;return!0}return!1}function u(b,c){a.info("Importing all rules");var f=c===w?d.loadRulesPathsChanges:e.loadUrlRulesPathsChanges;f().then(function(a){var d=[];for(var e in b)b.hasOwnProperty(e)&&d.push(e);v(b,a,c,d)},function(b){h.genericError(b.message),a.error("Error while importing all rules: ",b)})}function v(a,b,c,d){if(0!=d.length){var e=d[0];a.hasOwnProperty(e)&&t(b,e,a,c)?a[e].asTemplate?r(e,a,c).then(function(e){d.splice(0,1),v(a,b,c,d)},function(e){d.splice(0,1),v(a,b,c,d)}):q(e,a,c).then(function(e){d.splice(0,1),v(a,b,c,d)},function(e){d.splice(0,1),v(a,b,c,d)}):(d.splice(0,1),v(a,b,c,d))}}var w=i().RULE_TYPE.PATH;i().RULE_TYPE.URL;return{getFile:o,validateDuplicatesAndImportOneRule:s,importAll:u}}angular.module("uxData.services").factory("RulesImportService",a),a.$inject=["$log","$rootScope","$q","rulesService","urlRulesService","templatesService","rulesRequestService","rulesAlertsService","RULES_CONSTANTS","pathRulesBuilderService","rulesBuilderService","importService","urlRulesBuilderService","urlRulesRequestService"]}(),function(){"use strict";function a(a){function b(){return a.getAllExistingApplications()}function c(b){return a.createDefaultModel(b)}function d(b){return a.defaultModelConstructionDetails(b)}function e(b){return a.validateApplication(b)}var f={getAllExistingApplications:b,createDefaultModel:c,defaultModelConstructionDetails:d,validateApplication:e};return f}angular.module("uxData.modelInitializer").factory("modelInitializerRequestService",a),a.$inject=["requestsService"]}(),function(){"use strict";function a(a,b,c){function d(){var b=a.defer();return c.getAllExistingApplications().then(function(a){b.resolve(a)},function(a){b.reject({message:a.data,status:a.status})}),b.promise}function e(b){var d=a.defer();return c.createDefaultModel(b).then(function(a){d.resolve(a)},function(a){d.reject({message:a.data,status:a.status})}),d.promise}function f(b){var d=a.defer();return c.defaultModelConstructionDetails(b).then(function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise}function g(b){var d=a.defer();return c.validateApplication(b).then(function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise}var h=(b("hostnameAndIP"),{getAllExistingApplications:d,createDefaultModel:e,defaultModelConstructionDetails:f,validateApplication:g});return h}angular.module("uxData.modelInitializer").factory("modelInitializerService",a),a.$inject=["$q","$filter","modelInitializerRequestService"]}(),function(){"use strict";function a(a){function b(b){var c="Data saved";angular.isDefined(b)&&(c+=" - "+b),a.success(c,"Success",{closeButton:!0,timeOut:3e3})}function c(b){a.error('The "'+b+'" exists already.',"Error",{closeButton:!0,timeOut:3e3})}function d(){a.error("Can't save items","Error",{closeButton:!0,timeOut:3e3})}function e(b){a.error("Can't save items: "+b,"Error",{closeButton:!0,timeOut:3e3})}function f(b){var c="Will try to delete namespaced list";angular.isDefined(b)&&(c+=" - "+b),a.info(c,"Info",{closeButton:!0,timeOut:3e3})}function g(b){var c="Deleted namespaced list";angular.isDefined(b)&&(c+=" - "+b),a.success(c,"Success",{closeButton:!0,timeOut:3e3})}function h(){a.error("Can't retrieve items","Error",{closeButton:!0,timeOut:3e3})}function i(){a.error("Something wrong when convert file","Error",{closeButton:!0,timeOut:3e3})}function j(){a.error("Can't parse file","Error",{closeButton:!0,timeOut:3e3})}function k(){a.error("Can't delete value in namespaced list","Error",{closeButton:!0,timeOut:3e3})}function l(b){a.error("Can't save '"+b+"' is already exists","Error",{closeButton:!0,timeOut:6e3})}function m(b){a.error("Can't get search result: "+b,"Error",{closeButton:!0,timeOut:6e3})}var n={success:b,duplicate:c,errorPost:d,willTryDelete:f,errorPostWithMessage:e,errorGet:h,errorDelete:k,errorGetFile:i,errorParse:j,successDelete:g,alreadyExists:l,errorSearch:m};return n}angular.module("uxData.namespaced").factory("namespacedAlertsService",a),a.$inject=["toastr"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(){var a=e.defer();return c.getNamespaces().then(function(b){return d.isNullOrUndefined(b)||""===b?(a.reject({message:"WS returned empty namespaced list data",status:200}),a.promise):void a.resolve(b)},function(b){a.reject({message:b})}),a.promise}function m(b){var f=e.defer();return a.isSaving=!0,c.getAllNamespacedListsWithoutValues().then(function(c){return d.isNullOrUndefined(c)||d.isNullOrUndefined(c.namespace)||""===c.namespace?(f.reject({message:"WS returned empty namespaced list data",status:200}),f.promise):(b.namespace.splice(0,b.namespace.length),c.namespace=d.toArray(c.namespace),Array.prototype.push.apply(b.namespace,c.namespace),f.resolve(b),void(a.isSaving=!1))},function(b){f.reject({message:b}),a.isSaving=!1}),f.promise}function n(b){var f=e.defer();return a.isSaving=!0,c.getNamespacedListByName(b).then(function(c){return d.isNullOrUndefined(c)||d.isNullOrUndefined(c.valueSet)?(f.reject({message:'WS returned empty namespaced list data for "'+b+'"',status:200}),f.promise):(c.namespace=d.toArray(c.namespace),f.resolve(c),void(a.isSaving=!1))},function(b){f.reject({message:b}),a.isSaving=!1}),f.promise}function o(a,b){var c={};return c.position=null,angular.isDefined(b)&&angular.forEach(b,function(b,c){a===b.name&&(this.position=c)},c),c.position}function p(a,b){if(angular.isDefined(b)){var c=o(a,b);return angular.isUndefined(c)&&(c=0),b[c]}return null}function q(b,c){a.currentApplication!==f().APPLICATIONS.DECIDER?s(c,"showFlavorRules",{ruleName:b}):t(c,v(c,b,i().RULES_HASH_PATH.PATH_RULES_SHOW))}function r(b,c){a.currentApplication!==f().APPLICATIONS.DECIDER?s(c,"templates",{name:i().TEMPLATES_TYPE.PATH,ruleName:b}):t(c,v(c,b,i().RULES_HASH_PATH.TEMPLATE_PATH_RULES_SHOW))}function s(a,b,c){g.isAppAccessible(a)?(u(a),h.go(b,c)):toastr.error("You don't have permissions for application: "+a,"Error",{closeButton:!0,timeOut:5e3})}function t(a,c){g.isAppAccessible(a)?(u(a),b.location.href=c):toastr.error("You don't have permissions for application: "+a,"Error",{closeButton:!0,timeOut:5e3})}function u(b){angular.isDefined(b)&&a.currentApplication!==b&&b!==f().APPLICATIONS.DECIDER&&j.changeApp(b)}function v(a,b,c){var d=w()?a!==f().APPLICATIONS.DECIDER?f().DEVELOP_PATH.REDIRECTOR:f().DEVELOP_PATH.DECIDER:a!==f().APPLICATIONS.DECIDER?f().PROD_PATH.REDIRECTOR:f().PROD_PATH.DECIDER;return N()+"/"+d+"/"+c+b+"#"+b}function w(){var a=[];return a.push("/"+f().DEVELOP_PATH.REDIRECTOR+"/"),a.push("/"+f().DEVELOP_PATH.DECIDER+"/"),a.indexOf(b.location.href.replace(b.location.hash,"").replace(N(),""))>0}function x(b,c,f){var g=e.defer();return d.isNullOrUndefined(c)?(g.reject({message:"the item is empty or null or undefined"}),g.promise):d.isNullOrUndefined(f)||""===f?(g.reject({message:"the item is empty or null or undefined"}),g.promise):(f=f.trim(),d.isNullOrUndefined(b)?(g.reject({message:"the namespaced list is null or undefined"}),g.promise):(d.isNullOrUndefined(b)&&(b={_name:c,description:"",valueSet:[]}),angular.isDefined(b.valueSet)||(b.valueSet=[]),b.valueSet.indexOf(f)<0?(b.valueSet.push({value:f}),g.resolve(b),a.isSaving=!1):g.reject({message:'the item "'+f+'" currently exists in list '+b.name}),g.promise))}function y(b,c,f){var g=e.defer();if(d.isNullOrUndefined(c))return g.reject({message:"the item is empty or null or undefined"}),g.promise;if(d.isNullOrUndefined(f)||""===f)return g.reject({message:"the item is empty or null or undefined"}),g.promise;if(d.isNullOrUndefined(b))return g.reject({message:"the namespaced list array is null or undefined"}),g.promise;var h=O(b.valueSet,f);return h>=0?(b.valueSet.splice(h,1),g.resolve(b),a.isSaving=!1):g.reject({message:'the item "'+f.value+'" is absent in list'}),g.promise}function z(a,b){var d=e.defer();return c.deleteNamespaceValue(a,b).then(function(a){d.resolve()},function(a){d.reject({message:a})}),d.promise}function A(a,b){var d=e.defer();return angular.isArray(b)?(c.deleteNamespaceValues(a,b).then(function(a){d.resolve()},function(a){d.reject({message:a})}),d.promise):(d.reject({message:"you try to remove list of values, but don't provide array"}),d.promise)}function B(a){var b=e.defer();return angular.isArray(a)?(c.deleteEntitiesFromNamespacedLists(a).then(function(a){b.resolve()},function(a){b.reject({message:a})}),b.promise):(b.reject({message:"you are trying to remove list of values, but do not provide array"}),b.promise)}function C(a,b,c){return p(b,a.namespace).value[a.namespace[o(b,a.namespace).indexOf(c)].value]}function D(b){var f=e.defer();if(d.isNullOrUndefined(b))return f.reject({message:"Namespace with name '"+b.name+"' is not exist"}),f.promise;var g=b;return angular.isDefined(g.valueSet)&&0===g.valueSet.length&&delete g.valueSet,c.getNamespaceDuplicates(g).then(function(b){b.namespaceDuplicatesMap.entry.length>0&&(f.reject({message:"duplicate items are found, please resolve them first",data:b.namespaceDuplicatesMap.entry}),a.isSaving=!1),b.containsNamespacedListsWithoutReadRights?(f.reject({message:"Found duplicates in lists you have no permission to read. Contact your   system administrator to resolve this issue",data:b.namespaceDuplicatesMap.entry}),a.isSaving=!1):f.resolve(b)},function(a){f.reject({message:a.data.message})}),f.promise}function E(b,d){var f=e.defer();return angular.isDefined(b.valueSet)&&0===b.valueSet.length&&delete b.valueSet,c.saveNamespaces(d,b).then(function(b){a.isSaving=!0,f.resolve()},function(b){f.reject(b),a.isSaving=!1}),f.promise}function F(a,b){var c=null;if(a.length>0){for(var d=0;d<a.length;d++)if(a[d].key===b){c=d;break}return c}return null}function G(b,f){var g=e.defer();a.isSaving=!0;var h=p(f,b.namespace);return d.isNullOrUndefined(h)?(g.reject({message:"Namespace '"+f+"' is not available"}),g.promise):(c.exportNamespace(f),g.resolve(),a.isSaving=!1,g.promise)}function H(){var b=e.defer();return a.isSaving=!0,c.exportAllNamespaces(),b.resolve(),a.isSaving=!1,b.promise}function I(b,d){var f=e.defer();return a.isSaving=!0,c.deleteNamespace(d).then(function(){b.namespace.splice(o(d,b.namespace),1),f.resolve(b)},function(a){f.reject(a)}),a.isSaving=!1,f.promise}function J(b){return!(!k().alphaNumericalWithUnderscores.exec(b)||""===b)||(a.isSaving=!1,!1)}function K(b,d,f){var g=e.defer();return f?c.saveNamespacesAutoResolve(d,b).then(function(b){a.isSaving=!0,g.resolve()},function(b){g.reject(b),a.isSaving=!1}):D(b).then(function(){E(b,d).then(function(){g.resolve()},function(a){g.reject(a)})},function(a){g.reject(a)}),g.promise}function L(b,c,d,f){a.isSaving=!0;var g=e.defer();return J(c)?(d?n(c).then(function(a){return g.reject({message:'The namespaced list "'+c+'" already exists',status:409}),g.promise},function(a){K(b,c,f).then(function(){g.resolve()},function(a){return g.reject(a),g.promise})}):K(b,c,f).then(function(){g.resolve()},function(a){return g.reject(a),g.promise}),g.promise):(g.reject({message:'Incorrect namespaced list name "'+c+'"'}),g.promise)}function M(b){a.isSaving=!0;var d=e.defer();return c.searchNamespacesByItem(b).then(function(b){a.isSaving=!1,d.resolve(b)},function(b){a.isSaving=!1,d.reject(b)}),d.promise}function N(){return c.getBaseUrl()}function O(a,b){for(var c=0;c<a.length;c++)if(a[c].value==b.value)return c;return-1}var P={getNamespaces:l,getNamespacesFromDS:m,findPostionOfNamespaceByName:o,getNamespaceByName:p,addItem:x,delItem:y,delItemFromDS:z,deleteEntitiesFromNamespacedLists:B,deleteListOfNamespaceItemsFromDS:A,findValuesInTree:C,isNamespaceNameValid:J,validateDuplicates:D,postNamespace:E,exportNamespace:G,exportAll:H,deleteNamespace:I,validateAndSave:L,getIndexOfDuplicateItemFromMapByKey:F,searchNamespaces:M,getBaseUrl:N,goToFlavorRulePage:q,goToTemplateFlavorRulePage:r,getValuePosition:O,getNamespaceFromDS:n};return P}angular.module("uxData.namespaced").factory("namespacedService",a),a.$inject=["$rootScope","$window","requestsService","utilsService","$q","COMMON_CONSTANTS","authService","$state","RULES_CONSTANTS","messageService","REGEXP_CONSTANTS"]}(),function(){"use strict";function a(a,b,c,d){function e(){var a=b.defer();return c.getPartnersJSON().then(function(b){if(d.isNullOrUndefined(b)||d.isNullOrUndefined(b.partner)||""===b.partner)return a.reject({message:"WS returned empty partners list data",status:200}),a.promise;var c=f(b);a.resolve(c)},function(b){a.reject(b)}),a.promise}function f(a){var b=[];return angular.forEach(d.toArray(a.partner),function(a,c){var e={};e.id=a.id,angular.forEach(d.toArray(a.properties.property),function(a,b){e[a.name]=a.value}),b.push(e)}),b}function g(e){var g=b.defer();return a.isSaving=!0,c.getPartnersJSON().then(function(b){var c=b;if(d.isNullOrUndefined(c)||d.isNullOrUndefined(c.partner)||""===c.partner)return g.reject({message:"WS returned empty partners list data",status:200}),a.isSaving=!1,g.promise;var h=f(c);e.splice(0,e.length),h=d.toArray(h),Array.prototype.push.apply(e,h),a.isSaving=!1,g.resolve(e)},function(b){a.isSaving=!1,g.reject(b)}),g.promise}function h(d){var e=b.defer();a.isSaving=!0;var f={};return f.partner=[],angular.forEach(d,function(a,b){var c={};c.property=[];for(var d in a)"id"!==d&&c.property.push({name:d,value:a[d]});f.partner.push({id:a.id,properties:c})}),c.savePartners(a.currentApplication,f).then(function(b){a.isSaving=!1,e.resolve()},function(b){a.isSaving=!1,e.reject(b)}),e.promise}function i(d){var e=b.defer();a.isSaving=!0;var f={};f.property=[];for(var g in d)"id"!==g&&f.property.push({name:g,value:d[g]});return c.addOrUpdatePartner({id:d.id,properties:f}).then(function(b){a.isSaving=!1,e.resolve()},function(b){a.isSaving=!1,e.reject(b)}),e.promise}function j(d){var e=b.defer();return a.isSaving=!0,c.deletePartner(d).then(function(){a.isSaving=!1,e.resolve()},function(b){a.isSaving=!1,null===b?e.reject({message:"Server return null"}):e.reject(b)}),e.promise}function k(){var d=b.defer();return a.isSaving=!0,c.getExportPartners(),a.isSaving=!1,d.resolve(),d.promise}function l(d){var e=b.defer();return a.isSaving=!0,c.getExportPartner(d),a.isSaving=!1,e.resolve(),e.promise}function m(a,b){for(var c,d=0;d<a.length;d++)if(a[d].id===b){c=d;break}return c}function n(a){for(var b="",c=Object.getOwnPropertyNames(a).sort(),d=0;d<c.length;d++)"id"!==c[d]&&(b+=c[d]+" = "+a[c[d]]+"\n");return""===b?"":b.substring(0,b.length-1)}var o={getPartners:e,getPartnersFromDS:g,savePartners:h,savePartner:i,deletePartner:j,exportAllPartners:k,exportPartner:l,getPartnersFromPartnersObject:f,findPositionOfPartnerById:m,getPartnerPropertiesAsString:n};return o}angular.module("uxData.partners").factory("partnersService",a),a.$inject=["$rootScope","$q","requestsService","utilsService"]}(),function(){"use strict";function a(a,b,c){function d(a,b,c){return c.countDownTime=angular.isDefined(b.returnStatement.countDownTime)?parseInt(b.returnStatement.countDownTime):15,c.enablePrivate=!angular.isDefined(b.returnStatement.enablePrivate)||b.returnStatement.enablePrivate,c.templateName=a.templateName,c}function e(a){var b=[];return angular.forEach(a.servers,function(a,c){var d={};d.url=angular.copy(a.url),d.path=angular.copy(a.path),d.query=angular.copy(a.query),d.serverName=angular.copy(a.serverName),d.description=angular.copy(a.description),d.editMode=d.url.indexOf(p)>-1?q:r,d.isNonWhitelisted=angular.equals(a.isNonWhitelisted,"true")||a.isNonWhitelisted===!0,b.push(d)}),angular.copy(b,a.servers),a}function f(a){angular.forEach(a.servers,function(b,c){b.name=a.ruleName,b.description=a.ruleName+" server route"});var b,c=g(a.servers);return b=c.length>1?{"return":{serverGroup:[{enablePrivate:a.enablePrivate,countDownTime:a.countDownTime,server:c}]}}:{"return":{server:c}}}function g(a){for(var b=[],c=0;c<a.length;c++)b.push(h(a[c]));return b}function h(a){var b={name:a.name,description:a.description,url:a.url,query:angular.copy(a.query)};return"simple"===a.editMode&&(b.path=a.path),b.isNonWhitelisted=angular.isDefined(a.isNonWhitelisted)?a.isNonWhitelisted:"false",b}function i(a,b,c){var d={};return d.params=a.expressions,d.returnStatement=a.returnStatement,d.data={},d.data.rule=b,d.data.countDownTime=a.countDownTime,d.data.enablePrivate=a.enablePrivate,d.data.path=[],d.data.serverEditMode=[],angular.forEach(d.returnStatement.servers,function(a,b){var e=q;angular.isUndefined(a.path)&&(a.path="",e=r),a.editMode=e,d.data.serverEditMode[b]=e;var f=j(a,c);d.data.path.push(f),e===r&&(d.data.url=a.url,d.data.query=a.query)}),d}function j(a,b){var c=a.path.indexOf("/")===-1?b.flavor:b.stack,d={value:a.path,nodes:0};return angular.forEach(c,function(b,c){angular.equals(b.value,a.path)&&angular.copy(b,d)}),d.isNonWhitelisted=a.isNonWhitelisted,d}function k(a){return c.objectToXml(a.data.rule)}function l(a){for(var b="",d=0;d<a.servers.length;d++){if("simple"===a.servers[d].editMode){var e=s;e=e.replace("protocol",a.servers[d].protocol),e=e.replace("port",a.servers[d].port),e=e.replace("URN",a.servers[d].urn);var f=n(a.servers[d].query,"","&");c.isEmptyString(f)||(f="; query: "+f),b+="(url: "+a.servers[d].url+"; serverName: "+a.servers[d].serverName+"; path: "+a.servers[d].path+"; description: "+a.servers[d].description+f+")"}else{var f=n(a.servers[d].query,"","&");c.isEmptyString(f)||(f="; query: "+f),b+="url: "+a.servers[d].url+f}d!=a.servers.length-1&&(b+=", ")}if(a.servers.length>1){var g="; countDownTime = "+a.countDownTime+" seconds, ",h=" private = "+a.enablePrivate;b="\nRETURN SERVER_GROUP [ "+b+g+h+" ]"}else 1===a.servers.length&&(b="\nRETURN [ "+b+" ]");return b}function m(a){for(var b="\n\t\t-----",d="",e=0;e<a.servers.length;e++){if(a.servers[e].url.indexOf("{host}")!=-1){var f=s;f=f.replace("protocol",a.servers[e].protocol),f=f.replace("port",a.servers[e].port),f=f.replace("URN",a.servers[e].urn);var g=n(a.servers[e].query,"\n\t\t\t","");d+="\n\t\turl: "+a.servers[e].url+"\n\t\tpath: "+a.servers[e].path+"\n\t\tisNonWhitelistedOnly: "+a.servers[e].isNonWhitelisted,c.isEmptyString(g)||(d+="\n\t\tquery: "+g)}else{var g=n(a.servers[e].query,"\n\t\t\t","");d+="\n\turl: "+a.servers[e].url,c.isEmptyString(g)||(d+="\n\t\tquery: "+g)}e!=a.servers.length-1&&(d+=b)}if(a.servers.length>1){var h=" countDownTime = "+a.countDownTime+" seconds, ",i=" private = "+a.enablePrivate;d="\nRETURN SERVER_GROUP\n   [ "+d+b+"\n\t"+h+i+"\n   ]"}else 1===a.servers.length&&(d="\nRETURN\n\t[ "+d+"\n\t]");return d}function n(a,b,d){var e="";return c.isEmptyObject(a)||angular.forEach(a.entry,function(a,c){e+=b+(c>0?d:"")+a.key+"="+a.value}),e}var o={completeRuleUnmarshalling:d,buildReturnStatement:e,prepareReturnForMarshalling:f,buildRuleObjectForPreview:i,objectToXml:k,getRuleReturnSimpleText:l,getRuleReturnDiffText:m},p=a().HOST,q=b().EXP_EDIT_MODE.SIMPLE,r=b().EXP_EDIT_MODE.ADVANCED,s="protocol://{host}:port/URN";return o}angular.module("uxData.services").factory("pathRulesBuilderService",a),a.$inject=["RULES_CONSTANTS","SERVER_CONSTANTS","utilsService"]}(),function(){"use strict";function a(a,b){function c(c,d){var e="Failed to load ' "+c+" '";b.isEmptyString(d)||(e+=" "+d),a.error(e,"Error",{closeButton:!0,timeOut:3e3})}function d(b){var c="Saved "+b;a.success(c,"Success",{closeButton:!0,timeOut:3e3})}function e(b){var c="Deleted "+b;a.success(c,"Success",{closeButton:!0,timeOut:3e3})}function f(c,d){var e="Failed to save "+c+".";b.isEmptyString(d)||(e+=" "+d),a.error(e,"Error",{closeButton:!0,timeOut:3e3})}function g(c,d){var e="Failed to delete "+c+".";b.isEmptyString(d)||(e+=" "+d),a.error(e,"Error",{closeButton:!0,timeOut:3e3})}function h(b){var c="Make some changes before saving the "+b;a.warning(c,"Warning",{closeButton:!0,timeOut:3e3})}function i(c){var d="Failed to load file";b.isEmptyString(c)||(d+=" "+c),a.error(d,"Error",{closeButton:!0,timeOut:3e3})}function j(c){var d="Error: rule duplicates a current one";b.isEmptyString(c)||(d+=" "+c),a.error(d,"Error",{closeButton:!0,timeOut:3e3})}function k(c){var d="Error: rule duplicates a pending one";b.isEmptyString(c)||(d+=" "+c),a.error(d,"Error",{closeButton:!0,timeOut:3e3})}function l(b){a.error("An error occured: "+b,"Error",{closeButton:!0,timeOut:3e3})}function m(b){var c="Imported rule "+b;a.success(c,"Success",{closeButton:!0,timeOut:3e3})}var n={failedToLoadData:c,failedToSave:f,successfullySaved:d,successfullyDeleted:e,failedToDelete:g,hasNotChangedWarning:h,errorGetFile:i,successImportRule:m,errorDuplicateCurrent:j,errorDuplicatePending:k,genericError:l};return n}angular.module("uxData.rules").factory("rulesAlertsService",a),a.$inject=["toastr","utilsService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(a,b){var c=d.unmarshallJsonRule(a),e={};return e.expressions=d.buildExpressionsObjects(c.params),e.returnStatement=b.buildReturnStatement(c.returnStatement),b.completeRuleUnmarshalling(a,c,e),e}function i(a,b,c){var d=w(a),f=c.prepareReturnForMarshalling(b);return e.marshallRuleToJSON(d,f)}function j(a,c,d,e,f){var g={},h=b.toArray(a["if"]);return angular.forEach(h,function(a,b){g[a.id]=n(a.id,a,c,d,e,f)}),angular.isDefined(c)&&angular.forEach(c[e].entry,function(a,b){var h=a.value;angular.equals(h.changeType,A)&&(g[h.id]=n(h.id,h.changedExpression,c,d,e,f))}),g}function k(a,c,d,e,f,g,h){var i={},j=b.toArray(angular.isDefined(c)?c["if"]:[]),k=l(h[a]);return angular.forEach(j,function(b,c){var h=n(b.id,b,d,e,f,g);h.dependentRules=m(a,b,k),i[b.id]=h}),angular.isDefined(d)&&angular.forEach(d[f].entry,function(a,b){var c=a.value;angular.equals(c.changeType,A)&&(i[c.id]=n(c.id,c.changedExpression,d,e,f,g))}),i}function l(a){var c=[],d=b.toArray(a["if"]);return angular.forEach(d,function(a,b){angular.isDefined(a.templateName)&&c.push(a)}),c}function m(a,b,c){for(var d="",e=0;e<c.length;e++)c[e].templateName===b.id&&(""===d&&(d="rules"===a?"(Depending Rules: ":"(Depending Url Rules: "),d=d+c[e].id+", ");return""!=d&&(d=d.substring(0,d.length-2)+")"),d}function n(a,b,c,d,e,f){var g=o(a,c,e),h=b;angular.isDefined(g)&&(h=angular.isDefined(g.value.changedExpression)?g.value.changedExpression:g.value.currentExpression);var i=p(h,d,f);if(i.data.id=a,angular.isDefined(g)&&angular.isDefined(g.value.changedExpression)&&angular.isDefined(g.value.currentExpression)){var j=p(g.value.currentExpression,d,f);i.data.path=j.data.path}return q(i,g,d,f),i.data}function o(a,c,d){var e;return b.isEmptyObject(c)||angular.forEach(c[d].entry,function(b,c){angular.equals(b.key,a)&&(e=b)}),e}function p(a,b,c){var d=h(a,c);return c.buildRuleObjectForPreview(d,a,b)}function q(a,c,d,e){var g=e.objectToXml(a),h=r(a.params,a.returnStatement,e),i=s(a.params,a.returnStatement,e);if(angular.isDefined(c)){switch(c.value.changeType){case f().PENDING_CHANGE_TYPE.ADD:a.data.xmlRuleCurrent=g,a.data.simpleRuleCurrent=h,a.data.diffRuleChangedText=i;break;case f().PENDING_CHANGE_TYPE.DELETE:a.data.xmlRuleCurrent=g,a.data.simpleRuleCurrent=h,a.data.diffRuleCurrentText=i;break;case f().PENDING_CHANGE_TYPE.UPDATE:var j=p(c.value.currentExpression,d,e);a.data.xmlRuleCurrent=b.jsonObjToXml(j.data.rule),a.data.simpleRuleCurrent=r(j.params,j.returnStatement,e),a.data.diffRuleCurrentText=s(j.params,j.returnStatement,e),a.data.diffRuleChangedText=i}a.data.changeType=c.value.changeType,a.data.hasChanges=!0}else a.data.xmlRuleCurrent=g,a.data.simpleRuleCurrent=h,a.data.diffRuleCurrentText=i,a.data.diffRuleChangedText=i}function r(a,b,c){var d=t(a),e=c.getRuleReturnSimpleText(b);return d+e}function s(a,b,c){var d=u(a),e=c.getRuleReturnDiffText(b);return d+e}function t(a){var c="IF ";return angular.forEach(a,function(d,e){c+=d.isBinary?"(":"",angular.forEach(d,function(a,e){if(angular.equals(e,B)||angular.equals(e,C)){var f=angular.isDefined(a.expName)?a.expName:"",g=a.negation?"NOT ":"",h=g+a.expOperator,i=v(a.expValues),j=b.isEmptyString(a.expType)?"":"("+a.expType.toUpperCase()+")";c+="("+f+" "+h+" "+j+i+")",c+=d.isBinary&&angular.equals(e,B)?" "+d.type.toUpperCase()+" ":""}}),c+=d.isBinary?")":"",c+=e!=a.length-1?" AND ":""}),c}function u(a){var c="IF\n\t";return angular.forEach(a,function(d,e){c+=d.isBinary?"(\n\t":"",angular.forEach(d,function(a,e){if(angular.equals(e,B)||angular.equals(e,C)){var f=angular.isDefined(a.expName)?a.expName:"",g=a.negation?"NOT ":"",h=g+a.expOperator,i=v(a.expValues),j=b.isEmptyString(a.expType)?"":"("+a.expType.toUpperCase()+")";c+="\t("+f+" "+h+j+" "+i+")",c+=d.isBinary&&angular.equals(e,B)?"\n\t\t"+d.type.toUpperCase()+"\n\t":""}}),c+=d.isBinary?"\n\t)":"",c+=e!=a.length-1?"\n\tAND\n\t":""}),c}function v(a){return angular.isArray(a)?a.join(", "):a}function w(a){var b=[];return angular.forEach(a,function(a,c){var d={};x(a.type)?(d[C]={},d[C].paramName=a[C].expName,d[C].expression=a[C].expOperator,d[C].negation=a[C].negation,d[C].paramValue=a[C].expValues,d[B]={},d[B].paramName=a[B].expName,d[B].expression=a[B].expOperator,d[B].negation=a[B].negation,d[B].paramValue=a[B].expValues,d.isBinary=!0,d.operatorName=a.type.toLowerCase(),angular.equals(a.type.toLowerCase(),D)?d.isOr=!0:angular.equals(a.type.toLowerCase(),E)&&(d.isXor=!0),y(a[C].expOperator)&&(d[C].type=a[C].expType),y(a[B].expOperator)&&(d[B].type=a[B].expType)):(d={},d.paramName=a[B].expName,d.expression=a[B].expOperator,d.negation=a[B].negation,d.paramValue=a[B].expValues,y(a[B].expOperator)&&(d.type=a[B].expType)),b.push(angular.copy(d))}),b}function x(a){return angular.equals(a,D)||angular.equals(a,E)}function y(a){return angular.equals(a,F)||angular.equals(a,G)||angular.equals(a,I)||angular.equals(a,H)}var z={unmarshallJSONRule:h,unmarshallJSONTemplateRules:k,marshallRuleToJSON:i,unmarshallJSONRulesForPreview:j,getRuleDiffText:s,getRuleSimpleText:r},A=f().PENDING_CHANGE_TYPE.ADD,B=a().LEFT,C=a().RIGHT,D=a().OR,E=a().XOR,F=g().OPERATOR_TYPE.LESSTHAN,G=g().OPERATOR_TYPE.LESSOREQUAL,H=g().OPERATOR_TYPE.GREATERTHAN,I=g().OPERATOR_TYPE.GREATEROREQUAL;return z}angular.module("uxData.services").factory("rulesBuilderService",a),a.$inject=["RULES_CONSTANTS","utilsService","rulesService","rulesUnmarshaller","rulesMarshaller","COMMON_CONSTANTS","EXPRESSION_CONSTANTS"]}(),function(){"use strict";function a(a){function b(a,b,c,d,e,f){var g={};return g.type="",g[e]={},g[e].expName=a,g[e].expOperator=c,g[e].negation=f,g[e].expValues=d,g[e].expType=b,g}function c(a,b,c){return angular.extend(a,b),a.type=c,a}function d(b){return b===a().OR||b===a().XOR}function e(a){return"lessThan"===a||"lessOrEqual"===a||"greaterThan"===a||"greaterOrEqual"===a}var f={createExpression:b,createBinaryExpression:c,isBinary:d,isRelationalOperator:e};return f}angular.module("uxData.rules").factory("rulesEditService",a),a.$inject=["RULES_CONSTANTS"]}(),function(){"use strict";function a(a,b,c,d){function e(a,b){return f(a,0,b)}function f(a,b,c){var d=null;if(a.length-b===0)return c;if(a.length-b===1)return a[b].isBinary?(d=g(a[b],a[b].operatorName),i(d,c)):(d=h(a[b].expression,a[b].paramName,a[b].paramValue,a[b]),i(d,c));var e=null,j=null;return a[b].isBinary?(d=g(a[b],a[b].operatorName),b++,i(d,f(a,b,c))):(e=h(a[b].expression,a[b].paramName,a[b].paramValue,a[b]),b++,a[b].isBinary?i(e,f(a,b,c)):(j=h(a[b].expression,a[b].paramName,a[b].paramValue,a[b]),d=h("and",e,j),b++,i(d,f(a,b,c))))}function g(a,b){var c=h(a[y].expression,a[y].paramName,a[y].paramValue,a[y]),d=h(a[z].expression,a[z].paramName,a[z].paramValue,a[z]);return h(b,c,d)}function h(a,b,c,d){switch(a.toLowerCase()){case"equals":case"notequal":return j(a,b,c,d);case"greaterorequal":case"lessorequal":case"lessthan":case"greaterthan":return k(a,b,c,d);case"contains":return m(b,c,d);case"containsnmsp":return n(b,c,d);case"matches":return l(b,c,d);case"and":return q(b,c);case"or":return r(b,c);case"xor":return s(b,c);case"isempty":return u(b,d);case"percent":return v(c,d);case"random":return w(c,d);case"iniprangelist":return p(b,c,d);case"iniprange":return o(b,c,d)}}function i(a,b){var c=Object.keys(a)[0],d=Object.keys(b)[0],e={},f={};return f[c]=a[c],f[d]=b[d],e["if"]=[f],e}function j(a,b,c,d){var e={};return e[a]=[{param:b,value:c[0]}],e}function k(a,b,c,d){var e={};return e[a]=[{param:b,value:c[0],type:angular.isDefined(d.type)?d.type:"none"}],e}function l(a,b,c){return{matches:[{negation:c.negation,param:a,pattern:b}]}}function m(a,b,c){return{contains:[{negation:c.negation,param:a,values:{value:b}}]}}function n(a,b,c){return{contains:[{negation:c.negation,type:"namespacedList",param:a,namespacedList:{value:b}}]}}function o(a,b,c){return{inIpRange:[{negation:c.negation,param:a,values:{value:b}}]}}function p(a,b,c){return{inIpRange:[{negation:c.negation,type:"namespacedList",param:a,namespacedList:{value:b}}]}}function q(a,b){return t("and",a,b)}function r(a,b){return t("or",a,b)}function s(a,b){return t("xor",a,b)}function t(a,b,c){var d=Object.keys(b)[0],e=Object.keys(c)[0],f={};if(d===e){var g={};return g[d]=[b[d][0],c[e][0]],f[a]=[g],f}var h={};return h[d]=b[d],h[e]=c[e],f[a]=[h],f}function u(a,b){return{isEmpty:[{negation:b.negation,param:a}]}}function v(a,b){return{percent:[{negation:b.negation,value:a}]}}function w(a,b){return{random:[{negation:b.negation,value:a}]}}var x={marshallRuleToJSON:e},y=a().LEFT,z=a().RIGHT;a().OR,a().XOR,a().RULE_TYPE.PATH,a().RULE_TYPE.URL,a().RULE_TYPE.DECIDER,c().OPERATOR_TYPE.LESSTHAN,c().OPERATOR_TYPE.LESSOREQUAL,c().OPERATOR_TYPE.GREATERTHAN,c().OPERATOR_TYPE.GREATEROREQUAL;return x}angular.module("uxData.services").factory("rulesMarshaller",a),a.$inject=["RULES_CONSTANTS","SERVER_CONSTANTS","EXPRESSION_CONSTANTS","utilsService"]}(),function(){"use strict";function a(a,b,c,d){function e(){var d=b.defer();return c.getServicePaths(a.currentApplication).then(function(a){var b={};angular.isDefined(a.paths)&&angular.isDefined(a.paths[0])&&(b=a.paths[0]),d.resolve(b)},function(a){d.reject({message:a.data,status:a.status})}),d.promise}function f(){var d=b.defer();return c.getPendingChanges(a.currentApplication).then(function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise}function g(){var d=b.defer();return c.getAllRules(a.currentApplication).then(function(a){d.resolve(a)},function(a){d.reject({message:a.data,status:a.status})}),d.promise}function h(d){var e=b.defer();return c.getRule(a.currentApplication,d).then(function(a){e.resolve(a)},function(a){e.reject({message:a.data,status:a.status})}),e.promise}function i(){var d=b.defer();return c.getAllRuleIds(a.currentApplication).then(function(a){d.resolve(a)},function(a){d.reject({message:a.data,status:a.status})}),d.promise}function j(d,e){var f=b.defer();return c.saveJSONRule(d,a.currentApplication,e).then(function(){f.resolve()},function(a){f.reject(a)}),f.promise}function k(d){var e=b.defer();return c.deleteRule(a.currentApplication,d).then(function(){e.resolve()},function(a){e.reject({message:a})}),e.promise}function l(){c.exportAllRules(a.currentApplication)}var m={getAllRules:g,getRule:h,getAllRuleIds:i,getPendingChanges:f,getServicePaths:e,saveRule:j,deleteRule:k,exportAllRules:l};return m}angular.module("uxData.rules").factory("rulesRequestService",a),a.$inject=["$rootScope","$q","requestsService","utilsService"]}(),function(){"use strict";function a(a,b,c,d){function e(a){var b={params:[],returnStatement:{}};if(a["if"]){$.merge(b.params,f(a));var c=e(a["if"][0]);$.merge(b.params,c.params),b.returnStatement=c.returnStatement;
}else a["return"]&&($.merge(b.params,f(a)),b.returnStatement=j(a["return"]));return b}function f(a){var b=[];if(a.equals&&b.push.apply(b,g(a,"equals")),a.notEqual&&b.push.apply(b,g(a,"notEqual")),a.matches&&b.push.apply(b,g(a,"matches")),a.greaterThan&&b.push.apply(b,g(a,"greaterThan")),a.lessThan&&b.push.apply(b,g(a,"lessThan")),a.greaterOrEqual&&b.push.apply(b,g(a,"greaterOrEqual")),a.lessOrEqual&&b.push.apply(b,g(a,"lessOrEqual")),a.contains&&b.push.apply(b,g(a,"contains")),a.inIpRange&&b.push.apply(b,g(a,"inIpRange")),a.isEmpty&&b.push.apply(b,g(a,"isEmpty")),a.random&&b.push.apply(b,g(a,"random")),a.percent&&b.push.apply(b,g(a,"percent")),a.and)return f(a.and[0]);if(a.or){var c={};c.operatorName="or",c.isBinary=!0,c.isOr=!0;var d=f(a.or[0]);c[o]=d[0],c[p]=d[1],b.push(c)}if(a.xor){var e={};e.operatorName="xor",e.isBinary=!0,e.isXOR=!0;var d=f(a.xor[0]);e[o]=d[0],e[p]=d[1],b.push(e)}return b}function g(a,b){var c=[];angular.isArray(a[b])||(a[b]=[a[b]]);for(var e=0;e<a[b].length;e++){var f={};f.name=a[b][e].param,f.type=a[b][e].type,f.expression=b,h(f.type,f.expression)?f.expression=d().OPERATOR_TYPE.CONTAINS_NMSP:i(f.type,f.expression)&&(f.expression=d().OPERATOR_TYPE.IN_IP_RANGE_NMSP),f.negation=a[b][e].negation,a[b][e].pattern?f.value=a[b][e].pattern:a[b][e].values?f.value=a[b][e].values.value:a[b][e].namespacedList?f.value=a[b][e].namespacedList.value:f.value=a[b][e].value,angular.isArray(f.value)||(f.value=[f.value]),c.push(f)}return c}function h(a,b){return angular.equals(a,d().OPERATOR_TYPE.NAMESPACED_LIST)&&angular.equals(b,d().OPERATOR_TYPE.CONTAINS)}function i(a,b){return angular.equals(a,d().OPERATOR_TYPE.NAMESPACED_LIST)&&angular.equals(b,d().OPERATOR_TYPE.IN_IP_RANGE)}function j(a){var b={};if(a.urlRule)angular.isArray(a.urlRule)&&(a.urlRule=a.urlRule[0]),a.urlRule.urn&&(b.urn=a.urlRule.urn),a.urlRule.port&&(b.port=a.urlRule.port),a.urlRule.protocol&&(b.protocol=a.urlRule.protocol),a.urlRule.ipProtocolVersion&&(b.ipProtocolVersion=a.urlRule.ipProtocolVersion);else if(a.partner)b.partner=a.partner[0];else{var c=a.serverGroup?a.serverGroup[0].server:a.server;b.servers=[];for(var d=0;d<c.length;d++){var e={};e.path=c[d].path,e.serverName=c[d].name,e.description=c[d].description,e.url=c[d].url,e.query=c[d].query,e.isNonWhitelisted="true"===c[d].isNonWhitelisted||c[d].isNonWhitelisted===!0,b.servers.push(e)}angular.isDefined(a.serverGroup)&&a.serverGroup[0]&&(b.countDownTime=a.serverGroup[0].countDownTime,b.enablePrivate=a.serverGroup[0].enablePrivate)}return b}function k(a){var b=[];return angular.forEach(a,function(a,c){var d={};if(a.isBinary){var e=l(a[o].name,a[o].type,a[o].expression,a[o].value,o,a[o].negation),f=l(a[p].name,a[p].type,a[p].expression,a[p].value,p,a[p].negation);d=m(e,f,a.isOr?q:r)}else d=l(a.name,a.type,a.expression,a.value,o,a.negation);b.push(angular.copy(d))}),b}function l(a,b,c,d,e,f){var g={};return g.type="",g[e]={},g[e].expName=a,g[e].expOperator=c,g[e].expValues=d,g[e].expType=b,g[e].negation=f,g}function m(a,b,c){return angular.extend(a,b),a.type=c,a.isBinary=!0,a}var n={unmarshallJsonRule:e,buildExpressionsObjects:k},o=a().LEFT,p=a().RIGHT,q=a().OR,r=a().XOR;a().HOST,a().RULE_TYPE.PATH,a().RULE_TYPE.URL,a().RULE_TYPE.DECIDER,b().EXP_EDIT_MODE.SIMPLE,b().EXP_EDIT_MODE.ADVANCED;return n}angular.module("uxData.services").factory("rulesUnmarshaller",a),a.$inject=["RULES_CONSTANTS","SERVER_CONSTANTS","utilsService","EXPRESSION_CONSTANTS"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(b,c){var d={isValid:!0,errorMsg:""};return!a.isEmptyString(b)||angular.equals(c,y)||angular.equals(c,x)||(d.errorMsg="Expression name is required",d.isValid=!1),d}function i(c,e,f,g,h){var i={isValid:!0,errorMsg:""};if(c&&a.isDefinedAndNotEmpty(c)){if(b.isRelationalOperator(f))angular.equals(g,C)&&(!d().numericPattern.test(c)||angular.equals(c,"-0")||angular.equals(c,"-0.0"))?(i.errorMsg="value should contain only numbers",i.isValid=!1):angular.equals(g,D)&&!d().versionPattern.test(c)?(i.errorMsg="value should be a version / IPv4 address (alphabet/numbers/hyphens separated by dots)",i.isValid=!1):angular.equals(g,B)&&!new v6.Address(c).isValid()&&(i.errorMsg="value should be a valid IPv6 address",i.isValid=!1);else if(angular.equals(f,y))isNaN(c)?(i.errorMsg="Invalid percent format",i.isValid=!1):!isNaN(c)&&(c<=0||c>100)&&(i.errorMsg="Invalid range",i.isValid=!1);else if(angular.equals(f,x)){var j=/^(?:100|\d{1,2})(?:\.\d{1,2})?$/,k=!!angular.isDefined(c)&&c.match(j);k||(i.errorMsg="value should be from 0 to 100",i.isValid=!1)}else if(angular.equals(f,z)&&!angular.equals(g,A)){var l=new v6.Address(c).isValid(),m=new v4.Address(c).isValid();m||l||(i.errorMsg="value should be a valid IPv4/IPv6 or range address",i.isValid=!1)}}else e===!1&&(i.errorMsg="Expression value is required",i.isValid=!1);return i}function j(b,c,e){var f={isValid:!0,errorMsg:""};return a.isDefinedAndNotEmpty(b)&&d().alphaNumericalWithUnderscores.test(b)?e===!1&&angular.isDefined(c[b])&&(f.errorMsg="Rule or Template '"+b+"' already exists.",f.isValid=!1):(f.errorMsg="Rule name is required and must contain only word characters, i.e. letters, numbers and _",f.isValid=!1),f}function k(b){return a.isDefinedAndNotEmpty(b)}function l(a,b,c){var d=m(a),e=n(a),f=!!c||b.validateReturnValue(a);return d&&e&&f}function m(a){var b=j(a.uiModelHolder.ruleName,angular.extend(a.existingRuleIDs,a.existingTemplatesIDs),a.uiModelHolder.editMode);return b.isValid===!0?a.ruleNameError="":a.ruleNameError=b.errorMsg,b.isValid}function n(a){if(0===a.uiModelHolder.rawExpressions.length)return g.failedToSave("rule","Rule must contain at least one expression"),!1;var b=!0,c=!0,d=!0,e=0;return angular.forEach(a.uiModelHolder.rawExpressions,function(f,g){angular.forEach(f,function(h,i){i!==u&&i!==v||(q(f[i],g,i,a)||(b=!1),s(f[i],g,i,a)||(c=!1),e="percent"===h.expOperator?++e:e,p(e,g,h.expOperator,i,a)||(d=!1))})}),b&&c&&d}function o(a){var b=0;angular.forEach(a.uiModelHolder.rawExpressions,function(c,d){angular.forEach(c,function(c,e){e!==u&&e!==v||(b="percent"===c.expOperator?++b:b,p(b,d,c.expOperator,e,a))})})}function p(b,c,d,e,f){var g=!0,h=f.exprValidationData[c][e].generalErrorMsg;return h&&a.stringContains(h,"percent")&&(f.exprValidationData[c][e].generalErrorMsg=""),"percent"===d&&("OR"===f.uiModelHolder.rawExpressions[c].type||"XOR"===f.uiModelHolder.rawExpressions[c].type?(f.exprValidationData[c][e].generalErrorMsg="Binary "+f.uiModelHolder.rawExpressions[c].type+" expression should not contain expression with 'percent' operand",g=!1):b>1&&(f.exprValidationData[c][e].generalErrorMsg="Rule already contains percent expression",g=!1)),g}function q(a,b,c,d){var e=h(a.expName,a.expOperator);return e.isValid===!0?d.exprValidationData[b][c].nameErrorMsg="":d.exprValidationData[b][c].nameErrorMsg=e.errorMsg,e.isValid}function r(a,b,c,d,e,f){var g=angular.equals(b.expOperator,w),h=i(a,g,b.expOperator,b.expType,b.type);return h.isValid===!0?f.exprValidationData[c][d].valueErrorMsg[e]="":f.exprValidationData[c][d].valueErrorMsg[e]=h.errorMsg,h.isValid}function s(a,b,c,d){var e=!0;return angular.forEach(a.expValues,function(f,g){r(f,a,b,c,g,d)||(e=!1)}),e}var t={validateName:h,validateValue:i,validateExprName:q,validateExprValue:r,validateRuleName:m,validateRuleNameBase:j,validateRule:l,validatePercentExpressions:o,hasError:k},u=f().LEFT,v=f().RIGHT,w=c().OPERATOR_TYPE.ISEMPTY,x=c().OPERATOR_TYPE.RANDOM,y=c().OPERATOR_TYPE.PERCENT,z=c().OPERATOR_TYPE.IN_IP_RANGE,A=c().OPERATOR_TYPE.NAMESPACED_LIST,B=c().VALUE_TYPE.IPV6,C=c().VALUE_TYPE.NUMERIC,D=c().VALUE_TYPE.VERSION;e().EXP_EDIT_MODE.SIMPLE,e().EXP_EDIT_MODE.ADVANCED;return t}angular.module("uxData.rules").factory("RulesCommonValidationService",a),a.$inject=["utilsService","rulesEditService","EXPRESSION_CONSTANTS","REGEXP_CONSTANTS","SERVER_CONSTANTS","RULES_CONSTANTS","rulesAlertsService"]}(),function(){"use strict";function a(a,b,c,d,e,f){function g(a,b){angular.forEach(b,function(a,b){angular.forEach(a,function(a,b){a.duplicates={},a.generalErrorMsg=""})}),angular.forEach(a,function(c,d){angular.forEach(c,function(c,e){(angular.equals(e,p)||angular.equals(e,q))&&h(a,b,d,e)})})}function h(b,c,d,e){a.isBinary(b[d].type)&&(m(b[d][p],b[d][q])?(c[d][p].duplicates[d+q]=d,c[d][q].duplicates[d+p]=d):(delete c[d][p].duplicates[d+q],delete c[d][q].duplicates[d+p]),l(c[d],b[d])),angular.forEach(b,function(f,g){g!==d&&angular.forEach(f,function(f,h){a.isRelationalOperator(f.expOperator)&&(k(f,b[d][e])?(c[g][h].duplicates[d+e]=d,c[d][e].duplicates[g+h]=g):(delete c[g][h].duplicates[d+e],delete c[d][e].duplicates[g+h]),l(c[d],b[d]),l(c[g],b[g]))})})}function i(a,b,c){angular.forEach(c,function(d,e){angular.forEach(d,function(d,f){delete d.duplicates[a+p],delete d.duplicates[a+q];var g=angular.copy(d.duplicates);d.duplicates={},angular.forEach(g,function(b,c){if(b<a)d.duplicates[c]=b;else if(b>=a){var e=c.replace(/\d/g,""),f=b-1+e;d.duplicates[f]=b-1}}),l(c[e],b[e])})}),c.length>0&&(a-1<0?h(b,c,0,p):h(b,c,a-1,p))}function j(a){if(0===a.uiModelHolder.servers.length)return e.failedToSave("rule","Rule must contain at least one return server"),!1;var b=!0;return angular.forEach(a.uiModelHolder.servers,function(c,d){n(d,a)||(b=!1)}),b}function k(b,c){return a.isRelationalOperator(b.expOperator)&&a.isRelationalOperator(c.expOperator)&&angular.equals(b.expOperator,c.expOperator)&&angular.isDefined(b.expName)&&angular.isDefined(c.expName)&&angular.equals(b.expName,c.expName)&&b.expName.replace(/\s/g,"").length>0}function l(a,b){angular.forEach(a,function(a,c){var d=[];if(angular.forEach(a.duplicates,function(a,b){$.inArray(a+1,d)===-1&&d.push(a+1)}),d.length>0){d.sort();var e="";angular.forEach(d,function(a,b){e+=a+", "}),e=e.substr(0,e.length-2),a.generalErrorMsg="Expression "+b[c].expOperator+" has a duplicate in condition(s) no: "+e}else a.generalErrorMsg=""})}function m(b,c){return a.isRelationalOperator(b.expOperator)&&a.isRelationalOperator(c.expOperator)&&angular.equals(b.expOperator,c.expOperator)&&angular.isDefined(b.expName)&&angular.isDefined(c.expName)&&angular.equals(b.expName,c.expName)&&b.expName.replace(/\s/g,"").length>0}function n(a,b){var d=b.uiModelHolder.servers[a],e=o(d);if(e.isValid===!0)b.serverValidationData[a].pathError="",b.serverValidationData[a].urlError="",b.serverValidationData[a].queryError=[];else{if(e.invalidQuery.length>0){for(var f=[],g=0;g<d.query.entry.length;g++){var h=!1;for(var i in e.invalidQuery)if(e.invalidQuery[i]==g){h=!0;break}f.push(h?"Query key/value should not be empty":"")}b.serverValidationData[a].queryError=f}else b.serverValidationData[a].queryError=[];angular.isUndefined(d.editMode)||angular.equals(d.editMode,c().EXP_EDIT_MODE.SIMPLE)?b.serverValidationData[a].pathError=e.errorMsg:b.serverValidationData[a].urlError=e.errorMsg}return e.isValid}function o(a){var b={isValid:!0,errorMsg:"",invalidQuery:[]};return angular.equals(a.editMode,r)&&f.isEmptyString(a.path)?(b.errorMsg="Service path is required",b.isValid=!1):!angular.equals(a.editMode,s)||d().urlPattern.test(a.url)||d().urlIPv6Pattern.test(a.url)||(b.errorMsg="Valid service url is required. Valid service url must match pattern: protocol://host[:port][/urn]",b.isValid=!1),f.isEmptyObject(a.query)||angular.forEach(a.query.entry,function(a,c){(f.isEmptyString(a.key)||f.isEmptyString(a.value))&&(b.isValid=!1,b.invalidQuery.push(c))}),b}var p=b().LEFT,q=b().RIGHT,r=c().EXP_EDIT_MODE.SIMPLE,s=c().EXP_EDIT_MODE.ADVANCED,t={validateDuplicatesOfAllExpressions:g,validateDuplicatedRelationalExpressions:h,revalidateDuplicatesOnRemove:i,validateReturnValue:j,validateServer:n};return t}angular.module("uxData.rules").factory("rulesValidationService",a),a.$inject=["rulesEditService","RULES_CONSTANTS","SERVER_CONSTANTS","REGEXP_CONSTANTS","rulesAlertsService","utilsService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(){var a=b.defer(),c={},d=[];return d.push(b.when(u())),d.push(b.when(v())),b.all(d).then(function(b){angular.forEach(b,function(a,b){angular.extend(c,a)}),a.resolve(c)},function(b){a.reject(b)}),a.promise}function m(a){var c=b.defer(),d={},e=[];return e.push(b.when(r(a))),e.push(b.when(v())),b.all(e).then(function(a){angular.forEach(a,function(a,b){angular.extend(d,a)}),c.resolve(d)},function(a){c.reject(a)}),c.promise}function n(){var a=b.defer(),c={},d=[];return d.push(b.when(s())),d.push(b.when(t())),d.push(b.when(u())),b.all(d).then(function(b){angular.forEach(b,function(a,b){angular.extend(c,a)}),a.resolve(c)},function(b){a.reject(b)}),a.promise}function o(a){var d={},e=b.defer(),f=[];return f.push(b.when(p())),f.push(b.when(q(a))),b.all(f).then(function(a){angular.forEach(a,function(a,b){angular.extend(d,a)}),e.resolve(d)},function(a){e.reject(a),c.error("Failed to load rules IDs")}),e.promise}function p(){var a=b.defer();return d.getAllRuleIds().then(function(b){var c={};angular.forEach(b.id,function(a,b){f.isEmptyString(a)||(c[a]=a)}),a.resolve(c)},function(b){a.reject({message:b}),c.error("Failed to load existing approved rule names. "+b)}),a.promise}function q(a){var d=b.defer();return j.getUnapprovedRulesIds(a).then(function(a){var b={};angular.forEach(a.id,function(a,c){f.isEmptyString(a)||(b[a]=a)}),d.resolve(b)},function(a){d.reject({message:a}),c.error("Failed to load existing rule names of pending changes. "+a)}),d.promise}function r(e){var g=b.defer();return d.getRule(e).then(function(a){g.resolve({rule:{"if":[a]}})},function(b){j.getPendingChangesJson(a.currentApplication).then(function(a){var b=f.getPendingChangesObjectById(a,y,e);g.resolve({rule:{"if":[b.changedExpression]}})},function(a){g.reject({message:a}),c.error("Failed to load rule "+e+". "+a)})}),g.promise}function s(){var a=b.defer();return d.getServicePaths().then(function(b){a.resolve({servicePaths:b}),c.info("Service paths successfully loaded")},function(b){a.reject(b),c.error("Failed to load service paths: "+b.message)}),a.promise}function t(){var e=b.defer();return d.getPendingChanges(a.currentApplication).then(function(a){e.resolve({pendingChanges:a})},function(a){e.reject(),c.error("Failed to load pending changes for rules: "+a.message)}),e.promise}function u(){var f=b.defer();return d.getAllRules(a.currentApplication).then(function(a){f.resolve({rules:a})},function(a){f.reject(),c.error("Failed to load rules: "+a.message),404!==a.status&&e.failedToLoadData("rules")}),f.promise}function v(){var a=b.defer();return k.loadTemplateRule().then(function(b){var c={};angular.forEach(b.templatePathRules["if"],function(a,b){c[a.id]=a}),a.resolve({templates:c})},function(b){e.failedToLoadData("templates"),a.reject()}),a.promise}function w(a,b){var c=!1;return angular.equals(a.editMode,b.editMode)&&(c=angular.equals(a.editMode,x)?angular.equals(a.path,b.path):angular.equals(a.url,b.url)),c}var x=h().EXP_EDIT_MODE.SIMPLE,y=g().RULE_TYPE.PATH,z={loadRulesAndTemplates:l,loadRuleAndTemplates:m,loadRulesPathsChanges:n,loadServicePaths:s,loadPendingChanges:t,loadAllRules:u,loadAllRuleIds:o,getAllNotApprovedNewRulesIds:q,loadRule:r,areServersEqual:w};return z}angular.module("uxData.rules").factory("rulesService",a),a.$inject=["$rootScope","$q","$log","rulesRequestService","rulesAlertsService","utilsService","RULES_CONSTANTS","SERVER_CONSTANTS","COMMON_CONSTANTS","changesRequestsService","templatesService"]}(),function(){"use strict";function a(){function a(a,b,c,d,e){var f=[];return $.isEmptyObject(a)||angular.isDefined(b)&&(angular.isArray(a.stack)||(a.stack=[a.stack]),angular.isArray(a.flavor)||(a.flavor=[a.flavor]),(angular.isUndefined(c)||angular.isDefined(c)&&c===!0)&&angular.forEach(a.stack,function(a,b){var c=e?parseInt(a.nodesWhitelisted):parseInt(a.nodes);f.push({GROUP:"Stacks",NAME:a.value,VALUE:c>0?a.value+" ("+c+")":a.value+" (inactive)",ACTIVE:c>0})}),(angular.isUndefined(d)||angular.isDefined(d)&&d===!0)&&angular.forEach(a.flavor,function(a,b){var c=e?parseInt(a.nodesWhitelisted):parseInt(a.nodes);c>0&&f.push({GROUP:"Flavors",NAME:a.value,NUMBER_VALUE:parseFloat(a.value),VALUE:c>0?a.value+" ("+c+")":a.value+" (inactive)",ACTIVE:c>0})})),f}var b={getListOfPaths:a};return b}angular.module("uxData.server").factory("serverService",a),a.$inject=[]}(),function(){"use strict";function a(a,b,c){function d(){return f.getRedirectorConfig()}function e(a){return f.saveRedirectorConfig(a)}var f;f=c?b.get("IndexedDBDataSource"):b.get("WebServiceDataSource");var g={getRedirectorConfig:d,saveRedirectorConfig:e};return g}angular.module("uxData.settings").factory("settingsRequestService",a),a.$inject=["requestsService","$injector","redirectorOfflineMode"]}(),function(){"use strict";function a(a){function b(){return a.getRedirectorConfig()}function c(b){return a.saveRedirectorConfig(b)}var d={getRedirectorConfig:b,saveRedirectorConfig:c};return d}angular.module("uxData.settings").factory("settingsService",a),a.$inject=["settingsRequestService"]}(),function(){"use strict";function a(a,b,c,d,e){function f(a,b,d,e){var f=c.defer();return h(a,[],b).then(function(){g(d).then(function(a){var c=k(d,b,a,e);f.resolve(c)},function(a){k(d,b,{paths:[]},e),f.reject(a)})},function(a){f.reject(a)}),f.promise}function g(b){a.isSaving=!0;var f=c.defer();return e.isNullOrUndefined(b)||!angular.isArray(b)?(f.reject({message:"Initial object is null or object",status:1}),a.isSaving=!1,f.promise):(d.getWhitelisted(a.currentApplication).then(function(c){var d=c;return e.isNullOrUndefined(d)||e.isNullOrUndefined(d.paths)||e.isNullOrUndefined(d.paths.entry)||!angular.isArray(d.paths.entry)?(f.reject({message:"WS returned empty whitelisted data or incorrect",status:200}),a.isSaving=!1,f.promise):(b.splice(0,b.length),a.isSaving=!1,void f.resolve(c))},function(b){f.reject({message:b.data,status:b.status}),a.isSaving=!1}),f.promise)}function h(b,e,f){a.isSaving=!0;var g=c.defer();return d.getServicePaths(a.currentApplication).then(function(c){if(!(angular.isDefined(c)&&angular.isDefined(c.paths)&&angular.isArray(c.paths)&&angular.isDefined(c.paths[0])&&angular.isDefined(c.paths[0].stack)))return a.isSaving=!1,g.reject({message:"WS returned incorrect or empty data for service paths",status:200}),g.promise;i(f);for(var d=0;d<c.paths[0].stack.length;d++){var h=j(c.paths[0].stack[d]);e.indexOf(h.path)===-1&&e.push(h.path),b.push(h.rawPath);var k={name:h.flavor,active:h.nodes>0,nodes:h.nodes,nodesWhitelisted:h.nodesWhitelisted};angular.isDefined(f[h.path])?f[h.path].flavors.push(k):f[h.path]={name:h.path,flavors:[k]}}a.isSaving=!1,g.resolve()},function(b){a.isSaving=!1,g.reject({message:b.message,status:b.status})}),g.promise}function i(a){angular.forEach(a,function(a,b){for(;a.flavors.length;)a.flavors.pop()})}function j(a){var b=a.value,c=b.substr(0,b.lastIndexOf("/")),d=b.substr(b.lastIndexOf("/")+1,b.length),e=a.nodes;return{rawPath:b,path:c,flavor:d,nodes:e,nodesWhitelisted:a.nodesWhitelisted}}function k(a,c,d,f){if(e.isNullOrUndefined(c))return null;var g=b("orderBy");return angular.forEach(c,function(b,h){for(var i=l(h,d),j=c[h],k=[],o=0;o<j.flavors.length;o++)k.push({flavor:h+"/"+j.flavors[o].name}),j.flavors[o].realFlavor=l(h+"/"+j.flavors[o].name,d),j.flavors[o].fullName=h+"/"+j.flavors[o].name,e.isNullOrUndefined(j.flavors[o].realFlavor)?j.flavors[o].realFlavor={}:j.flavors[o].realFlavor.updated=e.isNullOrUndefined(j.flavors[o].realFlavor.updated)||e.isNullOrUndefined(j.flavors[o].realFlavor.updated)||0===j.flavors[o].realFlavor.updated?"":m(j.flavors[o].realFlavor.updated);var p=n(h,b,f);if(p>0){var q=e.isNullOrUndefined(i)||e.isNullOrUndefined(i.action),r=!(e.isNullOrUndefined(i)||e.isNullOrUndefined(i.path)),s=q?r:"DELETE"!==i.action,t=c[h].flavors[0].fullName,u=c[h].flavors[0],v=void 0==u.realFlavor.updated?"":u.realFlavor.updated,w=void 0==u.realFlavor.action?"NEW":u.realFlavor.action,x={pos:a.length+1,isChecked:s,path:h,flavorFullName:t,flavor:u,nodes:u.nodes,updated:v,action:w,secondSorting:g(c[h].flavors,"name",!1)[0].name+" "+h};a.push(x)}}),a}function l(a,b){if(e.isNullOrUndefined(b.paths)||e.isNullOrUndefined(b.paths.entry))return null;for(var c=0;c<b.paths.entry.length;c++)if(b.paths.entry[c].key===a)return b.paths.entry[c].value;return null}function m(a){var b=new Date(a);return b.toLocaleString("en-US")}function n(a,b,c){var d=0;if(b.flavors.length>0)for(var e=0;e<b.flavors.length;e++)b.flavors[e].active?d+=b.flavors[e].nodes:c.push({value:a+"/"+b.flavors[e].name});return d}function o(b){var e=c.defer();if(null===b||angular.isUndefined(b)||0===b.length)return e.reject({message:"The whitelisted array is empty or null"}),e.promise;a.isSaving=!0;for(var f=[],g=0;g<b.length;g++)b[g].isChecked&&f.push(b[g].path);return d.sendWhitelisted(a.currentApplication,{paths:f}).then(function(b){a.isSaving=!1,e.resolve(b)},function(b){e.reject(b),a.isSaving=!1}),e.promise}function p(){d.exportAllWhitelisted(a.currentApplication)}function q(){d.exportAllServicePaths(a.currentApplication)}return{getStacks:f,getWhitelistedFromDS:g,getServicePathsFromDS:h,saveWhitelisted:o,exportAllWhitelisted:p,exportAllStacks:q}}angular.module("uxData.stacks").factory("stacksManagementService",a),a.$inject=["$rootScope","$filter","$q","requestsService","utilsService"]}(),function(){"use strict";function a(a,b){function c(c){return b.getData(b.getBaseApiUrl()+"summary/"+a.currentApplication+"/"+c+"/",{Accept:"application/json"})}var d={getSummary:c};return d}angular.module("uxData.summary").factory("summaryRequestService",a),a.$inject=["$rootScope","requestsService"]}(),function(){"use strict";function a(a,b,c,d){function e(d,e){var f=a.defer();return b.getSummary(e).then(function(a){a.defaultServer.traffic=c().TRAFFIC.DEFAULT_SERVER,g(a),h(a),d.push(a),f.resolve(d)},function(a){f.reject({message:"Can't load data"+a})}),f.promise}function f(c){var e=a.defer();return b.getNamespaces().then(function(a){var b=a;if(d.isNullOrUndefined(b)||d.isNullOrUndefined(b.namespace)||""===b.namespace)return e.reject({message:"WS returned empty namespaced list data",status:200}),e.promise;var f=b;c.namespace.splice(0,f.namespace.length);for(var g=0;g<f.namespace.length;g++)c.namespace.push(f.namespace[g].name);e.resolve(c)},function(a){e.reject({message:a})}),e.promise}function g(a){for(var b=0;b<a.distributions.length;b++)a.distributions[b].traffic=c().TRAFFIC.DISTRIBUTIONS,a.distributions[b].pos=b+i}function h(a){for(var b=a.distributions.length,c=0;c<a.rules.length;c++)a.rules[c].pos=b+c+i}var i=2,j={getSummary:e,getNamespaces:f};return j}angular.module("uxData.summary").factory("summaryService",a),a.$inject=["$q","summaryRequestService","SUMMARY_CONSTANTS","utilsService"]}(),function(){"use strict";function a(a,b){function c(c,d){return b.saveTemplateFlavorRule(a.currentApplication,c,d)}function d(c,d){return b.saveTemplateUrlRule(a.currentApplication,c,d)}function e(){return b.getFlavorRulesTemplates(a.currentApplication)}function f(){return b.getFlavorRuleTemplatesIds(a.currentApplication)}function g(){return b.getUrlRulesTemplates(a.currentApplication)}function h(){return b.getUrlRuleTemplatesIds(a.currentApplication)}function i(c){return b.deleteTemplateFlavorRule(a.currentApplication,c)}function j(c){return b.deleteTemplateUrlRule(a.currentApplication,c)}function k(a,c,d){window.open(b.getBaseApiUrl()+a+"/"+c+"/export/"+d)}var l={saveTemplateRule:c,saveTemplateUrlRule:d,getTemplateRules:e,getTemplateRulesIds:f,getTemplateUrlRules:g,getTemplateUrlRulesIds:h,deleteTemplateRule:i,deleteTemplateUrlRule:j,exportTemplate:k};return l}angular.module("uxData.templates").factory("templatesRequestsService",a),a.$inject=["$rootScope","requestsService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(a){return 409===a&&c.error("Can't delete template","Template is used in rules."),!1}function j(c){var d=b.defer(),e={},f=[];switch(c){case h().TEMPLATES_TYPE.PATH:f.push(b.when(k()));break;case h().TEMPLATES_TYPE.URL:f.push(b.when(l()));break;default:return d.reject("You should provide a template name (rules or urlRules)"),d.promise}return f.push(b.when(q())),f.push(b.when(p())),b.allSettled(f).then(function(b){angular.forEach(b,function(a,b){angular.extend(e,a.value)}),a.isSaving=!1,d.resolve(e)},function(b){a.isSaving=!1,d.reject(b)}),d.promise}function k(){var a=b.defer();return e.getTemplateRules().then(function(b){a.resolve({templatePathRules:b})},function(b){a.reject(b)}),a.promise}function l(){var a=b.defer();return e.getTemplateUrlRules().then(function(b){a.resolve({templateUrlPathRules:b})},function(b){a.reject(b)}),a.promise}function m(a){var c={},d=b.defer(),e=[];return e.push(b.when(n(a))),e.push(b.when(o(a))),b.all(e).then(function(a){angular.forEach(a,function(a,b){angular.extend(c,a)}),d.resolve(c)},function(a){d.reject({message:"Failed to load rules IDs",data:a})}),d.promise}function n(a){var c=b.defer(),d=null;switch(a){case h().TEMPLATES_TYPE.PATH:d=e.getTemplateRulesIds();break;case h().TEMPLATES_TYPE.URL:d=e.getTemplateUrlRulesIds();break;default:return c.reject("You should provide a template name (rules or urlRules)"),c.promise}return d.then(function(a){var b={};angular.forEach(a.id,function(a,c){g.isEmptyString(a)||(b[a]=a)}),c.resolve(b)},function(a){c.reject({message:"Failed to load existing approved rule names. "+a})}),c.promise}function o(a){var c=b.defer();return f.getUnapprovedRulesIds(a).then(function(a){var b={};angular.forEach(a.id,function(a,c){g.isEmptyString(a)||(b[a]=a)}),c.resolve(b)},function(a){c.reject({message:"Failed to load existing rule names of pending changes. "+a})}),c.promise}function p(){var a=b.defer();return d.getServicePaths().then(function(b){a.resolve({servicePaths:b})},function(b){a.reject({message:"Failed to load service paths: "+b.message})}),a.promise}function q(){var a=b.defer();return f.getPendingChangesJson().then(function(b){a.resolve({pending:b})},function(b){a.reject(b)}),a.promise}function r(a,c){var d,f=b.defer();switch(a){case h().TEMPLATES_TYPE.PATH:d=e.deleteTemplateRule(c);break;case h().TEMPLATES_TYPE.URL:d=e.deleteTemplateUrlRule(c);break;default:return f.reject("You should provide a template name (rules or urlRules)"),f.promise}return d.then(function(){f.resolve()},function(a,b){i(a),angular.isUndefined(b)?f.reject(a):f.reject(b)}),f.promise}function s(a,c,d){var f,g=b.defer();switch(a){case h().TEMPLATES_TYPE.PATH:f=e.saveTemplateRule(c,d);break;case h().TEMPLATES_TYPE.URL:f=e.saveTemplateUrlRule(c,d);break;default:return g.reject('You should provide a template type ("templatePathRules" or "saveTemplateRule")'),g.promise}return f.then(function(a){g.resolve(a)},function(a){g.reject({message:a})}),g.promise}var t={getAll:j,deleteTemplate:r,loadTemplateRule:k,loadTemplateUrlRule:l,loadAllTemplateIds:m,saveTemplate:s};return t}angular.module("uxData.templates").factory("templatesService",a),a.$inject=["$rootScope","$q","dialogs","rulesRequestService","templatesRequestsService","changesRequestsService","utilsService","RULES_CONSTANTS"]}(),function(){"use strict";function a(a){function b(){a.error("Something wrong when convert file","Error",{closeButton:!0,timeOut:3e3})}function c(b){a.success("Test case "+b+" saved","Success",{closeButton:!0,timeOut:3e3})}function d(b){a.error("Can't save test cases ("+b+")","Error",{closeButton:!0,timeOut:3e3})}function e(b){a.success("Deleted test case "+b,"Success",{closeButton:!0,timeOut:3e3})}function f(b){a.error("Error while deleting test case "+b,"Error",{closeButton:!0,timeOut:3e3})}function g(){a.error("Can't retrieve items","Error",{closeButton:!0,timeOut:3e3})}function h(b){a.error("Cannot run test "+b+", please rerun","Error",{closeButton:!0,timeOut:3e3})}function i(b){a.error("Cannot import test "+b,"Error",{closeButton:!0,timeOut:3e3})}function j(b){a.error("Cannot validate test  for reason: '"+b+"'. Probably, it`s corrupted or incompatible with this UI","Error",{closeButton:!0,timeOut:3e3})}function k(b,c){a.error("Cannot validate test "+b+"  for reason: '"+c+"'. Probably, it`s corrupted or incompatible with this UI. THIS TEST CASE WILL NOT BE DISPLAYED IN THE UI","Error",{closeButton:!0,timeOut:3e4})}function l(){a.error("Cannot validate incoming data from DS: there are undefined or null","Error",{closeButton:!0,timeOut:3e5})}function m(b){a.success("Test "+b+" was imported successfully","Success",{closeButton:!0,timeOut:3e3})}function n(b){a.success("Test "+b+" was executed successfully","Success",{closeButton:!0,timeOut:3e3})}var o={successSave:c,errorPost:d,errorGet:g,errorGetFile:b,successRun:n,errorRunTest:h,errorImportTest:i,successImportTest:m,successDelete:e,errorDelete:f,errorValidateIncomingTest:j,errorValidateIncomingTestNotDisplayed:k,errorValidationNullUndefined:l};return o}angular.module("uxData.testsuite").factory("testsuiteAlertsService",a),a.$inject=["toastr"]}(),function(){"use strict";function a(a,b,c){function d(a){return b.getData(b.getBaseApiUrl()+"testSuite/"+a,{Accept:"application/json"})}function e(a,c){return b.getData(b.getBaseApiUrl()+"testSuite/runAuto/"+a+"/"+c,{Accept:"application/json"})}function f(a){window.open(b.getBaseApiUrl()+"testSuite/export/"+a)}function g(c){return b.getData(b.getBaseApiUrl()+"testSuite/"+a.currentApplication+"/"+c,{Accept:"application/json"})}function h(a,c){window.open(b.getBaseApiUrl()+"testSuite/export/"+a+"/"+c)}function i(c,d){return b.getData(b.getBaseApiUrl()+"testSuite/"+a.currentApplication+"/"+c+"/"+d,{Accept:"application/json"})}function j(a,c){return b.saveData(b.getBaseApiUrl()+"testSuite/"+a+"/"+c.testName,c)}function k(a,d){return angular.isArray(d)?b.deleteItem(b.getBaseApiUrl()+"testSuite/"+a+"/"+d.join(),{Accept:"application/json"}):void c.errorDelete()}function l(a,b){return k(a,[b])}return{getTestCases:d,getAutoTestCases:e,getTestCase:g,sendTestCase:j,exportTestCase:h,exportTestCases:f,runTestCase:i,deleteTestCases:k,deleteTestCase:l}}angular.module("uxData.testsuite").factory("testSuiteRequestService",a),a.$inject=["$rootScope","requestsService","testsuiteAlertsService"]}(),function(){"use strict";function a(a,b,c,d){function e(a){return!c.isUnDefinedOrNullOrHasMiddleSpaces(a)&&!!a.match(b().alphaNumericalWithUnderscores)}function f(a){return!c.isUnDefinedOrNullOrHasMiddleSpaces(a)&&!!a.match(b().alphaNumericalWithUnderscoresDotsAndColons)}function g(a){return!c.isUnDefinedOrNullOrHasMiddleSpaces(a)}function h(a){return c.isProtocolValid(a)||d.isEmptyString(a)}function i(a){return c.isIpValid(a)||d.isEmptyString(a)}function j(a){return c.isIpVersionValid(a)||d.isEmptyString(a)}function k(a){return c.isPortValid(a)||d.isEmptyString(a)}function l(a){return c.isUrnValid(a)||d.isEmptyString(a)}function m(a){return c.isStackValid(a)||d.isEmptyString(a)}function n(a){return c.isFlavorValid(a)||d.isEmptyString(a)}function o(a){return!(c.isUnDefinedOrNullOrHasMiddleSpaces(a)&&!d.isEmptyString(a))}function p(a){return!(c.isUnDefinedOrNullOrHasMiddleSpaces(a)&&!d.isEmptyString(a))}function q(a){return c.isRuleNameValid(a)||d.isEmptyString(a)}function r(a,b){return{result:a,message:b}}function s(b){var c=a.defer(),d=t(b);return d.result?c.resolve(d.message):c.reject(d.message),c.promise}function t(a){try{var b=!1;if(c.isNullOrUndefined(a))return r(!1,"testCase is null or undefined");for(var i in a.expected)if(a.expected.hasOwnProperty(i)){if(!d.isEmptyString(a.expected[i])){b=!0;break}if(Array.isArray(a.expected[i])&&0!=a.expected[i].length){b=!0;break}}return b?q(a.expected.rule)?q(a.expected.urlRule)?p(a.expected.responseType)?n(a.expected.flavor)?m(a.expected.xreStack)?l(a.expected.urn)?k(a.expected.port)?j(a.expected.ipVersion)?h(a.expected.protocol)?e(a.testName)?0===a.parameters.parameter.length?r(!1,"Parameters are empty"):(angular.forEach(a.parameters.parameter,function(a,b){return f(a.name)?void angular.forEach(a.values,function(a){if(!g(a))return r(!1,"test case value "+a+" is invalid")}):r(!1,"test case parameter is invalid")}),r(!0,"Validation is passed")):r(!1,"test case name is invalid"):r(!1,"expected response protocol is invalid"):r(!1,"expected response ip version is invalid"):r(!1,"expected response port is invalid"):r(!1,"expected response urn is invalid"):r(!1,"expected response stack is invalid"):r(!1,"expected response flavor is invalid"):r(!1,"expected response type is invalid"):r(!1,"expected URL rule name is invalid"):r(!1,"expected rule name is invalid"):r(!1,"All expected properties are empty. At least one is required");
}catch(o){return r(!1,o)}return r(!1,"")}function u(b){var c=a.defer();return q(b.actual.rule)?q(b.actual.urlRule)?p(b.actual.responseType)?o(b.actual.mode)?n(b.actual.flavor)?m(b.actual.xreStack)?l(b.actual.urn)?k(b.actual.port)?j(b.actual.ipVersion)?h(b.actual.protocol)?(c.resolve("Test result is valid"),c.promise):(c.reject("actual response protocol is invalid"),c.promise):(c.reject("actual response ip is invalid"),c.promise):(c.reject("actual response port is invalid"),c.promise):(c.reject("actual response urn is invalid"),c.promise):(c.reject("actual response stack is invalid"),c.promise):(c.reject("actual response flavor is invalid"),c.promise):(c.reject("actual response mode is invalid"),c.promise):(c.reject("actual response type is invalid"),c.promise):(c.reject("actual URL rule name is invalid"),c.promise):(c.reject("actual rule name is invalid"),c.promise)}return{isNameValid:e,isParameterNameValid:f,isParameterValueValid:g,isProtocolValid:h,isIpValid:i,isIpVersionValid:j,isPortValid:k,isUrnValid:l,isStackValid:m,isFlavorValid:n,isModeValid:o,isResponseTypeValid:p,isRuleNameValid:q,validateTestCase:s,validateTestResult:u,validateTestCaseInstantly:t}}angular.module("uxData.testsuite").factory("validationServicetestsuite",a),a.$inject=["$q","REGEXP_CONSTANTS","validationService","utilsService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(a){var b=angular.copy(a);for(var c in b)if(b.hasOwnProperty(c)){var d=b[c];angular.isArray(d)&&(b[c]=d.join(", "))}return b}function k(c){var d=a.defer();return g.getTestCase(c).then(function(a){b.info("Got testcase",a),h.validateTestCase(a).then(function(c){b.info("Testcase ",a," is valid"),d.resolve(a)},function(c){b.error("Test case ",a," from DS is invalid: ",c.data.message),i.errorValidateIncomingTest(c.data.message),d.reject(c)})},function(a){d.reject(a),b.error("Error while getting testcase: ",a.data.message)}),d.promise}function l(){var c=a.defer();return b.info("Trying to get all test cases"),g.getTestCases(d.currentApplication).then(function(d){var e=[],f=[];angular.isDefined(d.items.testCase)&&angular.isArray(d.items.testCase)?(angular.forEach(d.items.testCase,function(a){var b=h.validateTestCase(a);b.testCase=a,f.push(b)}),a.allSettled(f).then(function(){angular.forEach(f,function(a,c){a.then(function(b){e.push(a.testCase)},function(c){b.error("Test case ",a.testCase.testName,a.testCase," was invalid and WILL NOT BE DISPLAYED"),i.errorValidateIncomingTestNotDisplayed(a.testCase.testName,a.$$state.value)})}),c.resolve(e)})):c.resolve([])},function(a){b.error("Error getting all test cases: ",a.data.message),i.errorGet(a.data.message),c.reject(a)}),c.promise}function m(c){var e=a.defer();return b.info("Trying to get all test cases"),g.getAutoTestCases(d.currentApplication,c).then(function(a){var b=[];angular.isDefined(a.testCaseResult)&&angular.isArray(a.testCaseResult)?(angular.forEach(a.testCaseResult,function(a){b.push(a)}),e.resolve(b)):e.resolve([])},function(a){b.error("Error getting all automatically created test cases: ",a.data.message),e.reject(a)}),e.promise}function n(a){if(angular.isDefined(a)&&angular.isDefined(a.actual&&angular.isDefined(a.expected))){var b="";if(a.status.toLowerCase()!==z)b="Passed";else for(var c in a.actual)a.actual.hasOwnProperty(c)&&a.expected.hasOwnProperty(c)&&(a.expected[c]===a.actual[c]||o(a.expected[c])||(b+="expected "+c+" to be "+a.expected[c]+", was "+a.actual[c]+"\n"));return angular.isDefined(a.logs)&&angular.forEach(a.logs,function(a){b+="\n"+a}),angular.isDefined(a.actual.appliedUrlRules)&&(b+="\nurl rules applied: "+a.actual.appliedUrlRules),b}return"Response string is not defined, probably test was in error."}function o(a){return f.isEmptyString(a)&&f.isNullOrUndefinedOrEmptyStringArrayOfValues(a)}function p(a,b){for(var c=0;c<b.length;c++)if(b[c].testName===a)return b[c]}function q(a,b){for(var c=0;c<b.length;c++)if(b[c].testName===a)return c}function r(c){var e=a.defer();return g.deleteTestCase(d.currentApplication,c).then(function(a){b.warn("Deleted testcase",c,a),e.resolve(a)},function(a){i.errorDelete(c),b.error("Error deleting testcase",a.data.message),e.reject(a)}),e.promise}function s(a,c){g.sendTestCase(d.currentApplication,c).then(function(d){i.successSave(c.testName),a.resolve(d),b.info("Test case '"+c.testName+"' is successfully saved")},function(c){b.error("Cannot save test case: ",c.data.message),i.errorPost(c.data.message),a.reject(c)})}function t(c,e){var f=a.defer();return d.isSaving=!0,h.validateTestCase(c).then(function(a){g.getTestCase([c.testName]).then(function(a){e?(s(f,c),d.isSaving=!1):(b.error("duplicates are found"),f.reject("Duplicates are found"),d.isSaving=!1,i.errorPost("Duplicates are found"))},function(a){s(f,c),d.isSaving=!1})},function(a){b.error("Cannot save test case: ",a.data.message),i.errorPost(a.data.message),f.reject(a),d.isSaving=!1}),f.promise}function u(a){var b="";if(!angular.isDefined(a.testName))return b="Test case name is undefined.";b+="Case "+a.testName+" ",b+="for application "+a.application+", expected return is ";var c=a.expected;return b+=(e.isNullOrUndefinedOrEmptyString(c.protocol)?"any_protocol":c.protocol)+"://"+(e.isNullOrUndefinedOrEmptyString(c.ipVersion)?"any_ip_ver":"6"===c.ipVersion?"{ipv6 address}":"{ipv4 address}")+":"+(e.isNullOrUndefinedOrEmptyString(c.port)?"any_port":c.port)+"/"+(e.isNullOrUndefinedOrEmptyString(c.urn)?"any_urn":c.urn)+","+(e.isNullOrUndefinedOrEmptyString(c.xreStack)?" any stack":" stack "+c.xreStack)+","+(e.isNullOrUndefinedOrEmptyString(c.flavor)?" any flavor":" flavor "+c.flavor)+","+(e.isNullOrUndefinedOrEmptyString(c.rule)?" through any rule":" through rule "+c.rule)+","+(f.isNullOrUndefinedOrEmptyStringArrayOfValues(c.appliedUrlRules)?" through any URL rule":" through URL rules: "+c.appliedUrlRules)}function v(a){var b=angular.copy(a);for(var c in b.expected)b.expected.hasOwnProperty(c)&&f.isEmptyString(b.expected[c])&&delete b.expected[c];return $.format(f.objectToXml(a),{method:"xml"})}var w,x=[],y=[],z="failed";return w={arrayPropertiesToStrings:j,getAndValidateOneTestCase:k,getAndValidateAllTestCases:l,getAllAutoTestCases:m,getSimpleViewForTestCase:u,getXmlViewForTestCase:v,generateDiffStringForTestResult:n,deleteTestCaseByName:r,findTestCaseByName:p,findTestCaseIndexByName:q,validateAndSaveTestCase:t,testNamesToRunNext:x,testNamesToRun:y},d.isSaving=!1,w}angular.module("uxData.testsuite").service("testsuiteService",a),a.$inject=["$q","$log","$state","$rootScope","validationService","utilsService","testSuiteRequestService","validationServicetestsuite","testsuiteAlertsService"]}(),function(){"use strict";function a(){function a(a){}var b={getTraffic:a};return b}angular.module("uxData.services").factory("IndexedDBTrafficService",a),a.$inject=["DataRequesterSimple"]}(),function(){"use strict";function a(a,b){function c(a){return g.getTraffic(a)}function d(a,b,c){return g.getCurrentTraffic(a,b,c)}function e(a,b,c,d){return g.getAdjustedWeights(a,b,c,d)}function f(a,b,c,d){return g.getAdjustedThreshold(a,b,c,d)}var g;g=b?a.get("IndexedDBTrafficService"):a.get("TrafficWebService");var h={getTraffic:c,getCurrentTraffic:d,getAdjustedWeights:e,getAdjustedThreshold:f};return h}angular.module("uxData.traffic").factory("trafficRequestService",a),a.$inject=["$injector","redirectorOfflineMode"]}(),function(){"use strict";function a(a,b){function c(c){return b.saveData(b.getBaseApiUrl()+"traffic/"+a.currentApplication,c,{"Content-Type":"application/json",Accept:"application/json"})}function d(c,d,e){return b.getData(b.getBaseApiUrl()+"traffic/current/"+a.currentApplication+"/"+c+"/"+d+"/"+e,{Accept:"application/json"})}function e(c,d,e,f){return b.getData(b.getBaseApiUrl()+"weightCalculator/calculateAdjustedWeights/"+a.currentApplication+"?adjustedWeightHosts="+c+"&totalConnections="+d+"&defaultWeight="+e+"&adjustedTraffic="+f,{Accept:"application/json"})}function f(c,d,e,f){return b.getData(b.getBaseApiUrl()+"weightCalculator/calculateAdjustedThreshold/"+a.currentApplication+"?adjustedWeightHosts="+c+"&totalConnections="+d+"&defaultWeight="+e+"&adjustedWeight="+f,{Accept:"application/json"})}var g={getTraffic:c,getCurrentTraffic:d,getAdjustedWeights:e,getAdjustedThreshold:f};return g}angular.module("uxData.services").factory("TrafficWebService",a),a.$inject=["$rootScope","requestsService"]}(),function(){"use strict";function a(a,b,c){function d(a){return b.getTraffic(a)}function e(b,c,d,e,k,l,m,n){var o=a.defer(),p={},q=[];return q.push(a.when(h(b,c,d))),angular.equals(n,j)?q.push(a.when(f(e,b,k,m))):angular.equals(n,i)&&q.push(a.when(g(e,b,k,l))),a.allSettled(q).then(function(a){angular.forEach(a,function(a,b){angular.isDefined(a.value)&&angular.extend(p,a.value)}),o.resolve(p)},function(a){o.reject(a)}),o.promise}function f(c,d,e,f){var g=a.defer();return b.getAdjustedWeights(c,d,e,f).then(function(a){g.resolve({adjustedWeights:a})},function(a){g.reject(a)}),g.promise}function g(c,d,e,f){var g=a.defer();return b.getAdjustedThreshold(c,d,e,f).then(function(a){g.resolve({adjustedThreshold:a})},function(a){g.reject(a)}),g.promise}function h(c,d,e){var f=a.defer(),g={};return b.getCurrentTraffic(c,d,e).then(function(a){g=angular.copy(a),f.resolve({traffic:g})},function(a){f.reject({message:"Can't load data"+a})}),f.promise}var i=c().ADJUSTED_TRAFFIC,j=c().ADJUSTED_WEIGHT,k={getAllTraffic:e,getTraffic:d};return k}angular.module("uxData.traffic").factory("trafficService",a),a.$inject=["$q","trafficRequestService","TRAFFIC_CONSTANTS"]}(),function(){"use strict";function a(a){function b(a,b,c){return c.templateName=a.templateName,c}function c(a){return a}function d(b){var c={"return":{urlRule:{}}};return a.isEmptyString(a.getString(b.protocol))||(c["return"].urlRule.protocol=b.protocol),a.isEmptyString(a.getString(b.urn))||(c["return"].urlRule.urn=b.urn),a.isEmptyString(a.getString(b.port))||angular.equals(a.getString(b.port),"0")||(c["return"].urlRule.port=b.port),a.isEmptyString(a.getString(b.ipProtocolVersion))||angular.equals(a.getString(b.ipProtocolVersion),"0")||(c["return"].urlRule.ipProtocolVersion=b.ipProtocolVersion),c}function e(b){return a.objectToXml(f(b.data.rule))}function f(b){var c=angular.copy(b);if(angular.isDefined(c["return"])&&angular.isDefined(c["return"].urlRule)){var d=c["return"].urlRule;angular.isDefined(d.protocol)&&a.isEmptyString(a.getString(d.protocol))&&delete d.protocol,angular.isDefined(d.port)&&(a.isEmptyString(a.getString(d.port))||angular.equals(a.getString(d.port),"0"))&&delete d.port,angular.isDefined(d.urn)&&a.isEmptyString(a.getString(d.urn))&&delete d.urn,angular.isDefined(d.ipProtocolVersion)&&(a.isEmptyString(a.getString(d.ipProtocolVersion))||angular.equals(a.getString(d.ipProtocolVersion),"0"))&&delete d.ipProtocolVersion}return c}function g(b){var c="";return a.isEmptyString(a.getString(b.protocol))||(c+="protocol: "+b.protocol+"; "),a.isEmptyString(a.getString(b.port))||angular.equals(a.getString(b.port),"0")||(c+="port: "+b.port+"; "),a.isEmptyString(a.getString(b.urn))||(c+="urn: "+b.urn+";"),a.isEmptyString(a.getString(b.ipProtocolVersion))||angular.equals(a.getString(b.ipProtocolVersion),"0")||(c+="ipProtocolVersion: "+b.ipProtocolVersion+";"),"\nRETURN [ "+c+" ]"}function h(a){var b="";return angular.isDefined(a.protocol)&&(b+="\n\t\tprotocol: "+a.protocol+";"),angular.isDefined(a.port)&&(b+="\n\t\tport: "+a.port+";"),angular.isDefined(a.urn)&&(b+="\n\t\turn: "+a.urn+";"),angular.isDefined(a.ipProtocolVersion)&&(b+="\n\t\tipProtocolVersion: "+a.ipProtocolVersion+";"),"\nRETURN\n\t[ "+b+"\n\t]"}function i(a,b,c){var d={};return d.params=a.expressions,d.returnStatement=a.returnStatement,d.data={},d.data.rule=b,d}var j={completeRuleUnmarshalling:b,buildReturnStatement:c,prepareReturnForMarshalling:d,objectToXml:e,getRuleReturnSimpleText:g,getRuleReturnDiffText:h,buildRuleObjectForPreview:i};return j}angular.module("uxData.services").factory("urlRulesBuilderService",a),a.$inject=["utilsService"]}(),function(){"use strict";function a(a,b,c,d,e){function f(){var c=b.defer();return d.loadDefaultUrlParams(a.currentApplication).then(function(a){c.resolve({result:a})},function(a){c.reject({message:a.data,status:a.status})}),c.promise}function g(c){var e=b.defer();return d.getUrlRule(a.currentApplication,c).then(function(a){e.resolve(a)},function(a){e.reject({message:a.data,status:a.status})}),e.promise}function h(){var c=b.defer();return d.getUrlRulesJSON(a.currentApplication).then(function(a){c.resolve({urlRules:a})},function(a){c.reject({message:a.data,status:a.status})}),c.promise}function i(){var f=b.defer();return d.getAllUrlRuleIds(a.currentApplication).then(function(a){var b={};angular.forEach(a.id,function(a,c){e.isEmptyString(a)||(b[a]=a)}),f.resolve(b)},function(a){f.reject({message:a}),c.error("Failed to load existing approved url rule names. "+a)}),f.promise}function j(c){var e=b.defer();return d.deleteUrlRule(a.currentApplication,c).then(function(){e.resolve()},function(a){e.reject({message:a})}),e.promise}function k(c,e){var f=b.defer();return d.saveJSONUrlRule(c,a.currentApplication,e).then(function(){f.resolve()},function(a){f.reject(a)}),f.promise}function l(c){var e=b.defer();return d.saveJSONDefaultUrlParam(a.currentApplication,c).then(function(){e.resolve()},function(a){e.reject({message:a})}),e.promise}function m(){d.exportAllURLRules(a.currentApplication)}var n={getUrlRule:g,getAllUrlRules:h,deleteUrlRule:j,getAllApprovedUrlRuleIds:i,saveUrlRule:k,loadDefaultUrlParams:f,saveDefaultUrlParams:l,exportAllUrlRules:m};return n}angular.module("uxData.urlRules").factory("urlRulesRequestService",a),a.$inject=["$rootScope","$q","$log","requestsService","utilsService"]}(),function(){"use strict";function a(a,b){function c(a){var b=e(a.uiModelHolder.urlParams);return angular.copy(b.validationData,a.urlParamsValidationData),b.isValid}function d(a){var b=f(a.defaultUrlParams);return angular.copy(b.validationData,a.defaultUrlParamsValidationData),b.isValid}function e(a){var b={isValid:!0,validationData:{generalErrorMsg:"",ipProtocolVersionErrorMsg:"",urnErrorMsg:"",portErrorMsg:"",protocolErrorMsg:""}};return m(a)&&(b.isValid=!1,b.validationData.generalErrorMsg="At least one server url parameter should be added."),g(a,b),b}function f(a){var b={isValid:!0,validationData:{generalErrorMsg:"",ipProtocolVersionErrorMsg:"",urnErrorMsg:"",portErrorMsg:"",protocolErrorMsg:""}};return l(a)&&(b.isValid=!1,b.validationData.generalErrorMsg="All Default URL Parameters should be filled in."),g(a,b),b}function g(b,c){var d=h(b.protocol);a.isEmptyString(b.protocol)||d.isValid||(c.isValid=!1,c.validationData.protocolErrorMsg=d.error);var e=i(b.port);a.isEmptyString(b.port)||e.isValid||(c.isValid=!1,c.validationData.portErrorMsg=e.error);var f=j(b.urn);a.isEmptyString(b.urn)||f.isValid||(c.isValid=!1,c.validationData.urnErrorMsg=f.error);var g=k(b.ipProtocolVersion);return a.isEmptyString(b.ipProtocolVersion)||g.isValid||(c.isValid=!1,c.validationData.ipProtocolVersionErrorMsg=g.error),c}function h(c){var d={isValid:!0,error:""},e=!c||a.isEmptyString(c);return e?(d.error="Protocol is required",d.isValid=!1):e||b().nonEmptyAlphabetical.test(c)||(d.error="Protocol is invalid. Only word characters are allowed.",d.isValid=!1),d}function i(c){var d={isValid:!0,error:""},e=!c||a.isEmptyString(a.getString(c));return e?(d.error="Port is required",d.isValid=!1):!e&&(!b().portPattern.test(a.getString(c))||c<1||c>65535)&&(d.error="Port is invalid. Must be a value between 1 and 65535.",d.isValid=!1),d}function j(c){var d={isValid:!0,error:""},e=!c||a.isEmptyString(c);return e?(d.error="Urn is required",d.isValid=!1):e||b().urnPattern.test(c)||(d.error="Urn is invalid. Allowed symbols are: alphanumeric and - _ ; .",d.isValid=!1),d}function k(b){var c={isValid:!0,error:""},d=a.isEmptyString(a.getString(b));return d?(c.error="IP protocol version is required",c.isValid=!1):d||"4"===a.getString(b)||"6"===a.getString(b)||(c.error="IP protocol version is invalid. Allowed 'IPv4' or 'IPv6'",c.isValid=!1),c}function l(b){return a.isEmptyString(b.protocol)||!a.isDefinedAndNotEmpty(b.port)||a.isEmptyString(b.urn)||!a.isDefinedAndNotEmpty(b.ipProtocolVersion)}function m(b){return a.isEmptyString(b.protocol)&&!a.isDefinedAndNotEmpty(b.port)&&a.isEmptyString(b.urn)&&!a.isDefinedAndNotEmpty(b.ipProtocolVersion)}var n={validateReturnValue:c,validateDefaultReturnValue:d};return n}angular.module("uxData.urlRules").factory("urlRulesValidationService",a),a.$inject=["utilsService","REGEXP_CONSTANTS"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(){var a=b.defer(),c={},e=[];return e.push(b.when(d.getAllUrlRules())),e.push(b.when(n())),b.all(e).then(function(b){angular.forEach(b,function(a,b){angular.extend(c,a)}),a.resolve(c)},function(b){a.reject(b)}),a.promise}function m(a){var c=b.defer(),d={},e=[];return e.push(b.when(q(a))),e.push(b.when(n())),b.all(e).then(function(a){angular.forEach(a,function(a,b){angular.extend(d,a)}),c.resolve(d)},function(a){c.reject(a)}),c.promise}function n(){var a=b.defer();return j.loadTemplateUrlRule().then(function(b){var c={};angular.forEach(b.templateUrlPathRules["if"],function(a,b){c[a.id]=a}),a.resolve({templates:c})},function(b){k.failedToLoadData("URL Templates",b),a.reject()}),a.promise}function o(){var a=b.defer(),c={},f=[];return f.push(b.when(e.loadServicePaths())),f.push(b.when(e.loadPendingChanges())),f.push(b.when(d.getAllUrlRules())),b.all(f).then(function(b){angular.forEach(b,function(a,b){angular.extend(c,a)}),a.resolve(c)},function(b){a.reject(b)}),a.promise}function p(a){var f={},g=b.defer(),h=[];return h.push(b.when(d.getAllApprovedUrlRuleIds())),h.push(b.when(e.getAllNotApprovedNewRulesIds(a))),b.all(h).then(function(a){angular.forEach(a,function(a,b){angular.extend(f,a)}),g.resolve(f)},function(a){g.reject(a),c.error("Failed to load rules IDs")}),g.promise}function q(e){var h=b.defer();return d.getUrlRule(e).then(function(a){h.resolve({rule:{"if":[a]}})},function(b){g.getPendingChangesJson(a.currentApplication).then(function(a){var b=f.getPendingChangesObjectById(a,v,e);h.resolve({rule:{"if":[b.changedExpression]}})},function(a){h.reject({message:a}),c.error("Failed to load url rule "+e+". "+a)})}),h.promise}function r(){var a=b.defer(),c={},e=[];return e.push(b.when(d.loadDefaultUrlParams())),e.push(b.when(g.getPendingChangesJsonByEntityType(w,"default"))),b.all(e).then(function(b){angular.forEach(b,function(a,b){angular.extend(c,a.result)}),a.resolve(c)},function(b){a.reject(b)}),a.promise}function s(){var e=b.defer();return d.getAllUrlRules(a.currentApplication).then(function(a){e.resolve(a)},function(a){e.reject(),c.error("Failed to load url rules: "+a.message),404!==a.status&&k.failedToLoadData("url rules")}),e.promise}function t(a,b){return angular.equals(a.protocol,b.protocol)&&angular.equals(a.port,b.port)&&angular.equals(a.urn,b.urn)&&angular.equals(a.ipProtocolVersion,b.ipProtocolVersion)}var u={loadRulesAndTemplates:l,loadRuleAndTemplates:m,loadUrlRulesPathsChanges:o,loadAllUrlRuleIds:p,loadDefaultUrlParams:r,areUrlParamsEquals:t,loadAllRules:s},v=h().RULE_TYPE.URL,w=i().PENDING_CHANGES_ENTITY_TYPE.URL_PARAMS;i().PENDING_CHANGES_ENTITY_TYPE.URL_PARAMS;return u}angular.module("uxData.urlRules").factory("urlRulesService",a),a.$inject=["$rootScope","$q","$log","urlRulesRequestService","rulesService","utilsService","changesRequestsService","RULES_CONSTANTS","COMMON_CONSTANTS","templatesService","rulesAlertsService"]}(),function(){"use strict";function a(){var a={sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"};return a}angular.module("uxData.constants").constant("AUTH_EVENTS",a)}(),function(){"use strict";function a(){var a={DEFAULT:"xreGuide",DECIDER:"decider"},b={REDIRECTOR:"dev",DECIDER:"devDecider"},c={REDIRECTOR:"admin",DECIDER:"decider"},d={ADD:"ADD",UPDATE:"UPDATE",DELETE:"DELETE"},e={URL_PARAMS:"urlParams",DEFAULT_URL_PARAMS:"default"},f={PENDING_CHANGE_TYPE:d,PENDING_CHANGES_ENTITY_TYPE:e,APPLICATIONS:a,PROD_PATH:c,DEVELOP_PATH:b};return f}angular.module("uxData.constants").constant("COMMON_CONSTANTS",a)}(),function(){"use strict";function a(){var a={DISTRIBUTION:"distributions",PATHRULES:"pathRules",PENDINGCHANGES:"pendingChanges",STACKS:"stacks",APPLICATIONS:"applicationsNames",TEMPLATEPATHRULES:"templatePathRules",TEMPLATEURLRULES:"templateUrlPathRules",URLRULES:"urlRules",WHITELISTED:"whitelisted",WHITELISTED_UPDATES:"whitelistedUpdates",DEFAULTPARAMS:"urlParams",SERVERS:"servers",NAMESPACE:"namespace",VERSION:"version",STACKBACKUP:"stackBackup",REDIRECTORCONFIG:"redirectorConfig"};return a}angular.module("uxData.constants").constant("IndexedDB_CONSTANTS",a)}(),function(){"use strict";function a(){var a={PATH_RULE_EXP:"pathRuleExp",URL_RULE_EXP:"urlRuleExp"},b={NONE:"none",STRING:"string",NUMERIC:"numeric",VERSION:"version",IPV6:"ipv6"},c={EQUAL:"equals",MATCHES:"matches",NOTEQUAL:"notEqual",CONTAINS:"contains",IN_IP_RANGE:"inIpRange",CONTAINS_NMSP:"containsnmsp",IN_IP_RANGE_NMSP:"inIpRangeList",LESSTHAN:"lessThan",LESSOREQUAL:"lessOrEqual",GREATERTHAN:"greaterThan",GREATEROREQUAL:"greaterOrEqual",ISEMPTY:"isEmpty",PERCENT:"percent",RANDOM:"random",NAMESPACED_LIST:"namespacedList"},d={IN_IP_RANGE:"clientAddress"},e={EXPRESSION_TYPE:a,OPERATOR_TYPE:c,VALUE_TYPE:b,DEFAULT_TITLE_NAME:d};return e}angular.module("uxData.constants").constant("EXPRESSION_CONSTANTS",a)}(),function(){"use strict";function a(){var a={rulesAdd:"rulesadd",rulesEdit:"rulesedit",rulesShow:"rulesshow",urlRulesAdd:"urlrulesadd",urlRulesEdit:"urlrulesedit",urlRulesShow:"urlrulesshow",namespacedAdd:"namespacedadd",namespacedEdit:"namespacededit",testSuiteAdd:"testsuiteadd",testSuiteEdit:"testsuiteedit",whitelisted:"whitelisted",distribution:"distribution",summary:"summary",settings:"settings",trafficGet:"traffic"};return a}angular.module("uxData.constants").constant("LOCALSTORAGE_PAGE_NAMES",a)}(),function(){"use strict";function a(){var a={read:"read",write:"write",readRules:"read-rules",readUrlRules:"read-urlRules",readChanges:"read-changes",readDistributions:"read-distributions",readServers:"read-servers",readNamespacedLists:"read-namespacedLists",readBackups:"read-backups",readStacks:"read-stacks",readWhitelist:"read-whitelist",readTestSuite:"read-testSuite",readPartners:"read-partners",readDeciderRules:"read-deciderRules",writeRules:"write-rules",writeUrlRules:"write-urlRules",writeChanges:"write-changes",writeDistributions:"write-distributions",writeServers:"write-servers",writeNamespacedLists:"write-namespacedLists",writeBackups:"write-backups",writeStacks:"write-stacks",writeWhitelist:"write-whitelist",writeDeciderRules:"write-deciderRules",writePartners:"write-partners",all:"permitAll",writeTestSuite:"write-testSuite",writeSettings:"write-settings",writeModelInitializer:"write-modelInitializer"};return a}angular.module("uxData.constants").constant("USER_PERMISSIONS",a)}(),function(){"use strict";function a(){var a=new RegExp("^[-]?[0-9]+([.]{1}[0-9]+)?$"),b=new RegExp("^([0-9a-zA-Z]+([-]?[0-9a-zA-Z]+)*)+([.]{1}[0-9a-zA-Z]+([0-9a-zA-Z-]+[0-9a-zA-Z]+)?)*$"),c=new RegExp("^([a-z]+){1}(:\\/\\/)([\\w\\-]+(\\.{1})?)+(:([1-9]){1}(([0-9]){1,4})?)?(\\/[\\w~!@#$%^&*()_+-=\\{\\}\\[\\]']+)*$"),d=new RegExp("^([a-z]+){1}(:\\/\\/)\\[[a-fA-F0-9:]*\\](:([1-9]){1}(([0-9]){1,4})?)?(\\/[\\w~!@#$%^&*()_+-=\\{\\}\\[\\]']+)*$"),e={alphabetical:/^[a-zA-Z]*$/,nonEmptyAlphabetical:/^[a-zA-Z]+$/,numerical:/^\d+$/,percent:/^(?:100|\d{1,2})(?:\.\d{1,2})?$/,alphaNumericalWithUnderscores:/^[a-zA-z0-9_]+$/,alphaNumericalWithUnderscoresDotsAndColons:/^[a-zA-Z0-9.:_]+$/,alphaNumericalWithUnderscoresAndSpaces:/^[a-zA-z0-9_ ]+$/,ipv4:/^0*([1-9]?\d|1\d\d|2[0-4]\d|25[0-5])\.0*([1-9]?\d|1\d\d|2[0-4]\d|25[0-5])\.0*([1-9]?\d|1\d\d|2[0-4]\d|25[0-5])\.0*([1-9]?\d|1\d\d|2[0-4]\d|25[0-5])$/,stackName:/^\/[a-zA-Z0-9._-]+\/[a-zA-Z0-9._-]+$/,numericPattern:a,versionPattern:b,urlPattern:c,urlIPv6Pattern:d,urnPattern:/^[a-zA-Z0-9-_;\.]+$/,portPattern:/^[0-9]{1,5}$/};return e}angular.module("uxData.constants").constant("REGEXP_CONSTANTS",a)}(),function(){"use strict";function a(){var a={PATH:"pathRules",URL:"urlRules",DECIDER:"deciderRules"},b={URL_PARAMS:"urlParams"},c={PATH:"templatePathRules",URL:"templateUrlPathRules"},d={PATH_RULES_SHOW:"#/flavorRules/showAll/",TEMPLATE_PATH_RULES_SHOW:"#/templates/"+c.PATH+"/",URL_RULES_SHOW:"#/"+a.URL+"/showAll/",TEMPLATE_URL_RULES_SHOW:"#/templates/"+c.URL+"/",DECIDER_RULES_SHOW:"#/showDeciderRules/"},e={LEFT:"left",RIGHT:"right",OR:"OR",XOR:"XOR",HOST:"{host}",RULE_TYPE:a,RETURN_TYPE:b,TEMPLATES_TYPE:c,RULES_HASH_PATH:d};return e}angular.module("uxData.constants").constant("RULES_CONSTANTS",a)}(),function(){"use strict";function a(){var a={SIMPLE:"simple",ADVANCED:"advanced"},b={EXP_EDIT_MODE:a};return b}angular.module("uxData.constants").constant("SERVER_CONSTANTS",a)}(),function(){"use strict";function a(){var a={showFlavorRules:"showFlavorRules",editFlavorRule:"editFlavorRule",addNewFlavorRule:"addNewFlavorRule",importFlavorRules:"importFlavorRules",showURLRules:"showURLRules",editURLRule:"editURLRule",importURLRules:"importURLRules",addNewURLRule:"addNewURLRule",distribution:"distribution",backup:"backup",stacksManagement:"stacksManagement",summary:"summary",settings:"settings",changes:"changes",changesOffline:"changesOffline",testsuiteShow:"testsuite-show",testsuiteShowAuto:"testsuite-showauto",testsuiteAdd:"testsuite-add",testsuiteEdit:"testsuite-edit",testsuiteRun:"testsuite-run",testsuiteImport:"testsuite-import",addDeciderRule:"addDeciderRule",editDeciderRule:"editDeciderRule",showDeciderRules:"showDeciderRules",importDeciderRules:"importDeciderRules",partners:"partners",namespacesAdd:"namespacesAdd",namespacesAddIp:"namespacesAddIp",namespacesAddEncoded:"namespacesAddEncoded",namespacesImport:"namespacesImport",namespacesShow:"namespacesShow",namespacesEdit:"namespacesEdit",namespacesFindByItem:"namespacesFindByItem",namespacesSearch:"namespacesSearch",templates:"templates",error:"error",modelInitializer:"modelInitializer"};return a}angular.module("uxData.constants").constant("STATES_CONSTANTS",a)}(),function(){"use strict";function a(){var a={DEFAULT_SERVER:"Customer",DISTRIBUTIONS:"Customer/Internal (Maintenance)/Prod Preview",RULES:"Feature"},b={INTERNAL_MAINTENANCE:"Internal_Maintenance",PRODUCTION_PREVIEW_LIST_2:"Production_Preview_List_2",PRODUCTION_PREVIEW_LIST:"Production_Preview_List",INTERNAL_FEATURE:"Internal_Feature"},c={TRAFFIC:a,NAMESPACED_DEFAULT_NAMES:b};return c}angular.module("uxData.constants").constant("SUMMARY_CONSTANTS",a)}(),function(){"use strict";function a(){var a={ADJUSTED_TRAFFIC:"ADJUSTED_TRAFFIC",ADJUSTED_WEIGHT:"ADJUSTED_WEIGHT"},b={CURRENT:"CURRENT",NEXT:"NEXT"},c={ONLY_ACTIVE_WHITELISTED:"ONLY_ACTIVE_WHITELISTED",ALL_WHITELISTED:"ALL_WHITELISTED"},d={ADJUSTED_CALCULATION_MODE:a,DISTRIBUTION_MODE:b,HOSTS_MODE:c};return d}angular.module("uxData.constants").constant("TRAFFIC_CONSTANTS",a)}(),function(){"use strict";function a(){var a={urns:["shell"],protocols:["xre","xres","ws","wss","http","https","xmpp"]};return a}angular.module("uxData.constants").constant("TYPEAHEAD_DATA",a)}(),function(){"use strict";function a(a){function b(){}function c(a){return a.partner}function d(a){return{"return":{partner:[a.partner]}}}function e(b){return a.objectToXml(b.data.rule)}function f(a){return"\nRETURN [ Partner: "+a+" ]"}function g(a){return""}function h(a,b,c){var d={};return d.params=a.expressions,d.returnStatement=a.returnStatement,d.data={},d.data.rule=b,d}var i={completeRuleUnmarshalling:b,buildReturnStatement:c,prepareReturnForMarshalling:d,objectToXml:e,getRuleReturnSimpleText:f,getRuleReturnDiffText:g,buildRuleObjectForPreview:h};return i}angular.module("uxData.services").factory("deciderRulesBuilderService",a),a.$inject=["utilsService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){s(),d.getPartners().then(function(a){angular.forEach(a.partners.partner,function(a,b){P.partners.push(a.id)}),r()},function(a){o.failedToLoadData("decider partners",a.message),r()})}function r(){P.editMode&&d.getRule(P.ruleName).then(function(a){t(a.rule,P.ruleName)},function(a){o.failedToLoadData("rule: "+P.ruleName,a.message)})}function s(){d.getRuleIds().then(function(a){angular.copy(a.ids,P.existingRuleIDs)},function(a){o.failedToLoadData("rules data")})}function t(a,b){y(),P.ruleName=b,P.editMode=!0;var c=h.unmarshallJSONRule(a,p);angular.copy(c.expressions,P.rawExpressions),P.selectedPartner=c.returnStatement,u(),T.id=P.ruleName;var d={partner:P.selectedPartner,ruleName:P.ruleName};T.jsonRule=h.marshallRuleToJSON(P.rawExpressions,d,p)}function u(){angular.forEach(P.rawExpressions,function(a,b){P.exprValidationData[b]={},P.exprValidationData[b][Q]={duplicates:{},valueErrorMsg:[]},m.isEmptyString(a.type)||(P.exprValidationData[b][R]={duplicates:{},valueErrorMsg:[]})}),P.partnerErrorMsg=""}function v(a){var b={},c=g.createExpression("","",f().OPERATOR_TYPE.EQUAL,[""],Q);if(b[Q]={duplicates:{},valueErrorMsg:[]},g.isBinary(a)){var d=g.createExpression("","",f().OPERATOR_TYPE.EQUAL,[""],R);c=g.createBinaryExpression(c,d,a),b[R]={duplicates:{},valueErrorMsg:[]}}P.exprValidationData.push(b),P.rawExpressions.push(c)}function w(a){P.rawExpressions.splice(a,1),P.exprValidationData.splice(a,1),j.revalidateDuplicatesOnRemove(a,P.rawExpressions,P.exprValidationData)}function x(){y(),angular.isDefined(a.previousState)&&a.previousState.name===c().showDeciderRules?a.go(a.previousState.name,a.previousParams):a.go(c().addDeciderRule)}function y(){P.rawExpressions.splice(0,P.rawExpressions.length),P.ruleName="",P.ruleNameError="",P.editMode=!1,P.selectedPartner="",P.exprValidationData.splice(0,P.exprValidationData.length),P.partnerErrorMsg="",P.isSaving=!1}function z(a,b,c,d,e,f,g,h){F(a,b,c,d,e,f,g,h),j.validateDuplicatedRelationalExpressions(P.rawExpressions,P.exprValidationData,a,b),L(P.rawExpressions[a][b],a,b)}function A(a,b,c,d,e,f,g,h){F(a,b,c,d,e,f,g,h),M(e[f],P.rawExpressions[a][b],a,b,f)}function B(a,b,c,d,e,f,g,h){F(a,b,c,d,e,f,g,h),P.exprValidationData[a][b].valueErrorMsg=[""],L(P.rawExpressions[a][b],a,b),j.validateDuplicatedRelationalExpressions(P.rawExpressions,P.exprValidationData,a,b)}function C(a,b,c,d,e,f,g,h){F(a,b,c,d,e,f,g,h),M(e[f],P.rawExpressions[a][b],a,b,f)}function D(a,b,c,d,e,f,g){P.rawExpressions[a][b].expValues=e,P.exprValidationData[a][b].valueErrorMsg.push("")}function E(a,b,c,d,e,f,g){P.rawExpressions[a][b].expValues=e,P.exprValidationData[a][b].valueErrorMsg.splice(f,1)}function F(a,b,c,d,e,f,g,h){P.rawExpressions[a][b].expName=c,P.rawExpressions[a][b].expOperator=d,P.rawExpressions[a][b].negation=h,P.rawExpressions[a][b].expValues=e,P.rawExpressions[a][b].expType=g}function G(){var b=H();if(b){var e={partner:P.selectedPartner,ruleName:P.ruleName},f=h.marshallRuleToJSON(P.rawExpressions,e,p);angular.equals(T.id,P.ruleName)&&angular.equals(T.jsonRule,f)?o.hasNotChangedWarning("Decider Rule"):d.saveRule(f["if"][0],P.ruleName).then(function(b){o.successfullySaved(" '"+P.ruleName+"' rule."),a.go(c().showDeciderRules,{ruleName:P.ruleName})},function(a){o.failedToSave("rule: '"+P.ruleName+"'",a.message),P.isSaving=!1})}else o.failedToSave("rule","Due to validation errors.")}function H(){var a=I(),b=J(),c=K();return a&&b&&c}function I(){var a=i.validateRuleNameBase(P.ruleName,P.existingRuleIDs,P.editMode);return a.isValid===!0?P.ruleNameError="":P.ruleNameError=a.errorMsg,a.isValid}function J(){if(0===P.rawExpressions.length)return o.failedToSave("decider rule","Rule must contain at least one expression"),!1;var a=!0,b=!0;return angular.forEach(P.rawExpressions,function(c,d){angular.forEach(c,function(e,f){f!==Q&&f!==R||(L(c[f],d,f)||(a=!1),N(c[f],d,f)||(b=!1))})}),a&&b}function K(){var a=!0;return P.partnerErrorMsg="",m.isDefinedAndNotEmpty(P.selectedPartner)||(P.partnerErrorMsg="Partner is required",a=!1),a}function L(a,b,c){var d=i.validateName(a.expName,a.expOperator);return d.isValid===!0?P.exprValidationData[b][c].nameErrorMsg="":P.exprValidationData[b][c].nameErrorMsg=d.errorMsg,
d.isValid}function M(a,b,c,d,e){var f=angular.equals(b.expOperator,S),g=i.validateValue(a,f,b.expOperator,b.expType,b.type);return g.isValid===!0?P.exprValidationData[c][d].valueErrorMsg[e]="":P.exprValidationData[c][d].valueErrorMsg[e]=g.errorMsg,g.isValid}function N(a,b,c){var d=!0;return angular.forEach(a.expValues,function(e,f){M(e,a,b,c,f)||(d=!1)}),d}function O(a){return angular.isDefined(a)&&!$.isEmptyObject(a)}var P=this,Q=e().LEFT,R=e().RIGHT,S=(e().RULE_TYPE.PATH,f().OPERATOR_TYPE.ISEMPTY),T=(n().EXP_EDIT_MODE.SIMPLE,{});P.authService=k,P.USER_PERMISSIONS=l,P.existingRuleIDs={},P.exprValidationData=[],P.partnerErrorMsg="",P.rawExpressions=[],P.partners=[],P.selectedPartner="",P.ruleName=angular.isDefined(b.ruleId)?b.ruleId:"",P.editMode=angular.isDefined(b.ruleId),P.ruleNameError="",P.isSaving=!1,P.saveRule=G,P.addExpression=v,P.removeExpression=w,P.updateExpressions=F,P.cancelEditRule=x,P.onExprNameChanged=z,P.onExprOperatorChanged=B,P.onExprValueAdded=D,P.onExprValueRemoved=E,P.onExprValueChanged=A,P.onExprValueTypeChanged=C,P.validateRuleName=I,P.validatePartner=K,P.hasError=O,q()}angular.module("uxData.deciderRules").controller("DeciderRulesEditController",a),a.$inject=["$state","$stateParams","STATES_CONSTANTS","deciderRulesRequestService","RULES_CONSTANTS","EXPRESSION_CONSTANTS","rulesEditService","rulesBuilderService","RulesCommonValidationService","rulesValidationService","authService","USER_PERMISSIONS","utilsService","SERVER_CONSTANTS","rulesAlertsService","deciderRulesBuilderService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a){l.openFile(a,null,this).then(function(b){c.info("File "+a+" is read successfully"),t.loading=!0,o(b)},function(a){c.error("File is not read: "+a.message),e.errorGetFile(a.message)})}function o(a){try{c.info("Trying to get rules from the following structure: ",a);var b=JSON.parse(a);angular.isDefined(b.id)&&(b={"if":b}),t.rulesFromFile=k.unmarshallJSONRulesForPreview(b,void 0,void 0,u,j),c.info("Got rule(s) to import: ",t.rulesFromFile),t.loading=!1,t.title='Save rules by clicking "Import" button'}catch(d){e.genericError("can't parse file"),c.error("can't parse file"),t.loading=!1}}function p(a){d.saveRule(t.rulesFromFile[a].rule,a).then(function(b){delete t.rulesFromFile[a],c.info("Rule "+a+" is imported"),e.successImportRule(a)},function(b){e.genericError(b.message),t.rulesFromFile[a].error={showError:!0,message:"Error: "+b.message},c.error("error importing rule ",b)})}function q(a){d.getPartners().then(function(b){d.getRuleIds().then(function(c){r(b,c,a)&&p(a)},function(a){e.genericError(a.message),c.error("Error while importing all rules: ",a)})},function(a){e.genericError(a.message),c.error("Error while importing all rules: ",a)})}function r(a,b,d){if(angular.isDefined(a)||angular.isDefined(b)){if(angular.isDefined(b)&&angular.isDefined(b.ids))for(var f in b.ids)if(b.ids.hasOwnProperty(f)&&f===d)return e.errorDuplicateCurrent(d),t.rulesFromFile[d].error={showError:!0,message:"Error: the rule with this name already exists in current rules"},c.error("Duplicates found "+t.rulesFromFile[d].error.message),!1;var g=!0;if(angular.isDefined(a.partners)&&angular.isDefined(a.partners.partner)&&angular.isArray(a.partners.partner)){for(var h=0;h<a.partners.partner.length;h++)a.partners.partner[h].id===t.rulesFromFile[d].rule["return"].partner[0]&&(g=!1);if(g)return e.genericError(d),t.rulesFromFile[d].error={showError:!0,message:"Error: partner does not exist"},c.error("Partner does not exist "+t.rulesFromFile[d].error.message),!1}return!0}return!1}function s(){c.info("Importing all rules"),d.getPartners().then(function(a){d.getRuleIds().then(function(b){for(var c in t.rulesFromFile)t.rulesFromFile.hasOwnProperty(c)&&r(a,b,c)&&p(c)},function(a){e.genericError(a.message),c.error("Error while importing all rules: ",a)})},function(a){e.genericError(a.message),c.error("Error while importing all rules: ",a)})}var t=this,u=i().RULE_TYPE.DECIDER;t.authService=g,t.USER_PERMISSIONS=h,t.focusedRule=angular.isDefined(a.ruleName)?a.ruleName:"",t.rulesFromFile={},t.loading=!1,t.getFile=n,t.validateDuplicatesAndImportOneRule=q,t.isMapEmpty=f.isMapEmpty,t.importAll=s,m.onChangeApp(b,function(a){angular.copy({},t.rulesFromFile)})}angular.module("uxData.deciderRules").controller("DeciderRulesImportController",a),a.$inject=["$stateParams","$scope","$log","deciderRulesRequestService","rulesAlertsService","utilsService","authService","USER_PERMISSIONS","RULES_CONSTANTS","deciderRulesBuilderService","rulesBuilderService","importService","messageService"]}(),function(){"use strict";function a(a,b,c,d){function e(){var d=b.defer();return c.getRules(a.currentApplication).then(function(a){d.resolve({rules:a})},function(a){d.reject({message:a.data,status:a.status})}),d.promise}function f(){var a=b.defer();return c.getRuleIds().then(function(b){var c={};angular.forEach(b.id,function(a,b){d.isEmptyString(a)||(c[a]=a)}),a.resolve({ids:c})},function(b){a.reject({message:b.data,status:b.status})}),a.promise}function g(a){var d=b.defer();return c.getRule(a).then(function(a){d.resolve({rule:a})},function(a){d.reject({message:a.data,status:a.status})}),d.promise}function h(a,d){var e=b.defer();return c.saveRule(a,d).then(function(a){e.resolve({rule:a})},function(a){e.reject({message:a.data,status:a.status})}),e.promise}function i(a){var d=b.defer();return c.deleteRule("",a).then(function(a){d.resolve()},function(a){d.reject({message:a.data,status:a.status})}),d.promise}function j(){var a=b.defer();return c.getPartnersJSON().then(function(b){a.resolve({partners:b})},function(b){a.reject({message:b.data,status:b.status})}),a.promise}var k={getAllRules:e,getRuleIds:f,getRule:g,saveRule:h,deleteRule:i,getPartners:j,exportRule:c.exportRule,exportAllRules:c.exportAllRules};return k}angular.module("uxData.deciderRules").factory("deciderRulesRequestService",a),a.$inject=["$rootScope","$q","requestsService","utilsService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){f.getAllRules().then(function(a){s.rules=m.unmarshallJSONRulesForPreview(a.rules,a.pendingChanges,a.servicePaths,t,n),s.loading=!1,""!==s.focusedRule&&(c.hash(s.focusedRule),d())},function(a){s.loading=!1,h.failedToLoadData("rules data")})}function p(b){a.go(e().editDeciderRule,{ruleId:b.toString()})}function q(a){f.deleteRule(a).then(function(){h.successfullyDeleted("path rule: '"+a+"'"),o()},function(b){h.failedToDelete("path rule: '"+a+"/",b)})}function r(a){var b="Are you sure you want to delete rule '"+a+"' ?",c=k.confirm(b);c.result.then(function(b){q(a)},function(){})}var s=this;s.authService=i,s.USER_PERMISSIONS=j;var t=g().RULE_TYPE.DECIDER;s.loading=!0,s.rules={},s.editRule=p,s.deleteRule=q,s.confirmDeleteRule=r,s.exportRule=f.exportRule,s.exportAllRules=f.exportAllRules,s.isMapEmpty=l.isMapEmpty,s.searchSort={sortBy:"id",sortType:"asc",search:""},s.focusedRule=angular.isDefined(b.ruleName)?b.ruleName:"",o()}angular.module("uxData.deciderRules").controller("ShowDeciderRulesController",a),a.$inject=["$state","$stateParams","$location","$anchorScroll","STATES_CONSTANTS","deciderRulesRequestService","RULES_CONSTANTS","rulesAlertsService","authService","USER_PERMISSIONS","dialogs","utilsService","rulesBuilderService","deciderRulesBuilderService"]}(),function(){"use strict";angular.module("uxData.config").value("currentApplication","decider").value("redirectorOfflineMode",!1)}(),function(){"use strict";function a(a,b,c,d){b.otherwise(function(a,b){var c=a.get("$rootScope");if(!c.isPageReloading){var e=a.get("$state");e.go(d().showDeciderRules)}}),a.state(d().addDeciderRule,{controller:"DeciderRulesEditController",controllerAs:"vm",url:"/addNewDeciderRule",templateUrl:"../deciderAdmin/decider-rules/deciderRules-edit.html",data:{permissions:[c().readDeciderRules]}}).state(d().editDeciderRule,{controller:"DeciderRulesEditController",controllerAs:"vm",url:"/editDeciderRule/edit/:ruleId",templateUrl:"../deciderAdmin/decider-rules/deciderRules-edit.html",data:{permissions:[c().readDeciderRules]}}).state(d().showDeciderRules,{controller:"ShowDeciderRulesController",controllerAs:"vm",url:"/showDeciderRules/:ruleName",templateUrl:"../deciderAdmin/decider-rules/deciderRules-show.html",data:{permissions:[c().readDeciderRules]}}).state(d().importDeciderRules,{controller:"DeciderRulesImportController",controllerAs:"vm",url:"/importDeciderRules",templateUrl:"../deciderAdmin/decider-rules/deciderRules-import.html",data:{permissions:[c().writeDeciderRules]}}).state(d().partners,{controller:"Partners",controllerAs:"vm",url:"/partners",templateUrl:"../uxData/scripts/partners/partners.html",data:{permissions:[c().readPartners]}}).state(d().error,{templateUrl:"../uxData/views/error.html"}),a.state(d().namespacesAdd,{controller:"NamespacedDetail",controllerAs:"vm",url:"/namespaces/add",templateUrl:"../uxData/scripts/namespaced/namespaced-edit.html",data:{permissions:[]}}).state(d().namespacesAddIp,{controller:"NamespacedDetail",controllerAs:"vm",url:"/namespaces/addIp",templateUrl:"../uxData/scripts/namespaced/namespaced-edit.html",params:{type:"IP"},data:{permissions:[]}}).state(d().namespacesAddEncoded,{controller:"NamespacedDetail",controllerAs:"vm",url:"/namespaces/addEncoded",templateUrl:"../uxData/scripts/namespaced/namespaced-edit.html",params:{type:"ENCODED"},data:{permissions:[]}}).state(d().namespacesImport,{controller:"NamespacedImport",controllerAs:"vm",url:"/namespaces/import",templateUrl:"../uxData/scripts/namespaced/namespaced-import.html",data:{permissions:[]}}).state(d().namespacesShow,{controller:"NamespacedList",controllerAs:"vm",url:"/namespaces/show",templateUrl:"../uxData/scripts/namespaced/namespaced-list.html",data:{permissions:[]}}).state(d().namespacesEdit,{controller:"NamespacedDetail",controllerAs:"vm",url:"/namespaces/edit/:id",templateUrl:"../uxData/scripts/namespaced/namespaced-edit.html",data:{permissions:[]}}).state(d().namespacesFindByItem,{controller:"NamespacedSearcher",controllerAs:"vm",url:"/namespaces/findByItem",templateUrl:"../uxData/scripts/namespaced/namespaced-search.html",data:{permissions:[]}}).state(d().namespacesSearch,{controller:"NamespacedSearcher",controllerAs:"vm",url:"/namespaces/findByItem/:serviceName/:search",templateUrl:"../uxData/scripts/namespaced/namespaced-search.html",data:{permissions:[]}})}angular.module("uxData.config").config(a),a.$inject=["$stateProvider","$urlRouterProvider","USER_PERMISSIONS","STATES_CONSTANTS"]}(),function(){"use strict";function a(a,b,c,d,e){function f(){i.url=b.path(),i.getWhitelistedInfo()}function g(){e.getServicePathsFromDS([],[],i.stacksAndFlavors).then(function(){var a=0;angular.forEach(i.whitelistedStacks,function(b){angular.isDefined(i.stacksAndFlavors[b])&&angular.isDefined(i.stacksAndFlavors[b].flavors)&&angular.forEach(i.stacksAndFlavors[b].flavors,function(b){b.nodesWhitelisted>0&&(angular.isDefined(i.flavors[b.name])?i.flavors[b.name].nodes+=b.nodesWhitelisted:i.flavors[b.name]={name:b.name,nodes:b.nodesWhitelisted}),b.active&&(a+=b.nodes)})}),i.whitelistedCount=a})}function h(){i.whitelistedStacks=[],e.getWhitelistedFromDS(i.whitelistedStacks).then(function(a){angular.forEach(a.paths.entry,function(a){"DELETE"!==a.value.action&&i.whitelistedStacks.push(a.key)}),g()},function(a){c.error(a.message,"Error",{closeButton:!0,timeOut:3e3})})}var i=this;i.getWhitelistedInfo=h,i.whitelistedCount=0,i.whitelistedStacks=[],i.stacksAndFlavors={},i.flavors={},f(),d.onChangeApp(a,function(){i.whitelistedCount=0,i.whitelistedStacks=[],i.stacksAndFlavors={},i.flavors={},i.getWhitelistedInfo()})}angular.module("uxData.active-whitelisted").controller("ActiveWhitelistedCtrl",a),a.$inject=["$scope","$location","toastr","messageService","stacksManagementService"]}(),function(){"use strict";function a(){return{restrict:"E",replace:!0,templateUrl:"../uxData/scripts/active-whitelisted/active-whitelisted.html",controller:"ActiveWhitelistedCtrl",controllerAs:"directiveCtrl"}}angular.module("uxData.active-whitelisted").directive("activeWhiteList",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a,b){if(409===a){var d=f.notify("Pending changes are out of date","While you are reviewing the changes someone made more changes so you need to reload the page and review again before approving or canceling any change.");return d.result.then(function(a){c.location.reload()},function(){}),!0}if(406===a){var g=f.confirm("Please Confirm",'Approve impossible because settings for redirector config are not exist. If you have access to  "Settings" page, please set settings for redirector config or contact your administrator. Do you want to go to "Settings" page?');return g.result.then(function(a){p()},function(){}),!0}return e.error("Action failed due to server error: "+b.message,"Error",{closeButton:!0,timeOut:2e4}),!1}function o(a){angular.isDefined(a)&&""!==a&&e.warning(a.message,"Warning",{closeButton:!0,timeOut:12e3})}function p(){return V.authService.isAuthorized(V.USER_PERMISSIONS().writeSettings)?void d.go(m().settings):void e.error('You do not have permission to access on "Settings" page.',"Error",{closeButton:!0,timeOut:2e4})}function q(a){g.cancelPendingRule(a,V.changes.version).then(function(a){U()},function(a){n(a.status,a.data)})}function r(a){g.approvePendingRule(a,V.changes.version).then(function(a){o(a),U()},function(a){n(a.status,a.data)})}function s(a){g.cancelTemplatePendingRule(a,V.changes.version).then(function(a){U()},function(a){n(a.status,a.data)})}function t(a){g.approveTemplatePendingRule(a,V.changes.version).then(function(a){U()},function(a){n(a.status,a.data)})}function u(a){g.cancelTemplatePendingUrlRule(a,V.changes.version).then(function(a){U()},function(a){n(a.status,a.data)})}function v(a){g.approveTemplatePendingUrlRule(a,V.changes.version).then(function(a){U()},function(a){n(a.status,a.data)})}function w(a){g.approvePendingUrlRule(a,V.changes.version).then(function(a){o(a),U()},function(a){n(a.status,a.data)})}function x(a){g.cancelPendingUrlRule(a,V.changes.version).then(function(a){U()},function(a){n(a.status,a.data)})}function y(){g.approvePendingUrlParams(V.changes.version).then(function(a){U()},function(a){n(a.status,a.data)})}function z(){g.cancelPendingUrlParams(V.changes.version).then(function(a){U()},function(a){n(a.status,a.data)})}function A(a){g.cancelPendingServer(a,V.changes.version).then(function(a){U()},function(a){n(a.status,a.data)})}function B(a){g.approvePendingServer(a,V.changes.version).then(function(a){o(a),U()},function(a){n(a.status,a.data)})}function C(){g.cancelPendingStackManagement(V.changes.version).then(function(a){U()},function(a){n(a.status,a.data)})}function D(){g.approvePendingStackManagement(V.changes.version).then(function(a){U()},function(a){n(a.status,a.data)})}function E(){g.validateAndApprovePendingStackManagement(V.changes.version).then(function(a){o(a),U()},function(a){n(a.status,a.data)})}function F(){var a=f.confirm("Approve changes confirmation","Are you sure you want to approve all the changes in the list ?");a.result.then(function(a){g.approvePendingChanges(V.changes.version).then(function(a){U()},function(a){n(a.status,a.data)})},function(){})}function G(){var a=f.confirm("Approve changes confirmation","Are you sure you want to approve all the changes in the list ?");a.result.then(function(a){g.validateAndApprovePendingChanges(V.changes.version).then(function(a){o(a),U()},function(a){n(a.status,a.data)})},function(){})}function H(){var a=f.confirm("Model reload confirmation","Are you sure you want to reload current model on XRE Redirector? ");a.result.then(function(a){g.triggerModelReload().then(function(a){e.success("Model reload triggered","Success",{closeButton:!0,timeOut:3e3})},function(a){e.error("Action failed due to server error:"+a.data.message,"Error",{closeButton:!0,timeOut:3e3})})},function(){})}function I(){var a=f.confirm("Stacks reload confirmation","Are you sure you want to reload stacks on XRE Redirector? ");a.result.then(function(a){g.triggerStacksReload().then(function(a){e.success("Stacks reload triggered","Success",{closeButton:!0,timeOut:3e3})},function(a){e.error("Action failed due to server error:"+a.data.message,"Error",{closeButton:!0,timeOut:3e3})})},function(){})}function J(){var a=f.confirm("Approve changes confirmation","Are you sure you want to <b>cancel</b> all the changes in the list ?");a.result.then(function(a){K()},function(){})}function K(){g.cancelAllPendingChanges(V.changes.version).then(function(a){U()},function(a){n(a.status,a.data)})}function L(){g.cancelAllPendingDistribution(V.changes.version).then(function(a){U()},function(a){n(a.status,a.data)})}function M(){g.approveAllPendingDistribution(V.changes.version).then(function(a){o(a),U()},function(a){n(a.status,a.data)})}function N(a,b){var c=V.changes[W[b]];c.entry.forEach(function(b){var c=b;c.key===a&&(c.value.open=!c.value.open)})}function O(a){return angular.isDefined(a)?a.percent+"% - "+a.server.path:""}function P(){g.downloadCoreBackup()}function Q(){g.exportAllPending()}function R(a,b){g.exportPending(a,b)}function S(){g.exportPendingDistributions()}function T(){g.exportPendingStackManagement()}function U(){j.loadPendingChanges().then(function(a){V.pendingDistribution=angular.copy(a.pendingDistribution),V.currentDistribution=angular.copy(a.currentDistribution),V.changes=angular.copy(a.pending),V.changes.pathRules=j.generatePathRules(V.changes.pathRules),V.changes.templatePathRules=j.generatePathRules(V.changes.templatePathRules),V.changes.urlRules=j.generateUrlRules(V.changes.urlRules),V.changes.templateUrlPathRules=j.generateUrlRules(V.changes.templateUrlPathRules);var b=j.generateWhitelistedData(V.changes.whitelisted,a.whitelisted);V.whitelistChangedDiff=b.whitelistChangedDiff,V.whitelistCurrentDiff=b.whitelistCurrentDiff},function(b){a.error(b)})}var V=this;V.changes={},V.version=0,V.parseInt=parseInt,V.currentDistribution={},V.pendingDistribution={},V.whitelistChangedDiff="",V.whitelistCurrentDiff="",V.authService=h,V.USER_PERMISSIONS=i,V.ITEM_TYPES={RULE:"RULE",TEMPLATE_RULE:"TEMPLATE_RULE",URLRULE:"URLRULE",TEMPLATE_URLRULE:"TEMPLATE_URLRULE",DISTRIBUTION:"DISTRIBUTION",SERVER:"SERVER",WHITELISTED:"WHITELISTED"};var W={};W[V.ITEM_TYPES.RULE]="pathRules",W[V.ITEM_TYPES.TEMPLATE_RULE]="templatePathRules",W[V.ITEM_TYPES.URLRULE]="urlRules",W[V.ITEM_TYPES.TEMPLATE_URLRULE]="templateUrlPathRules",W[V.ITEM_TYPES.DISTRIBUTION]="distributions",W[V.ITEM_TYPES.SERVER]="servers",W[V.ITEM_TYPES.WHITELISTED]="whitelisted",V.cancelAllPendingChanges=K,V.toggleItem=N,V.exportAllPending=Q,V.exportPending=R,V.exportPendingStackManagement=T,V.approvePendingRule=r,V.cancelPendingRule=q,V.approveTemplatePendingRule=t,V.cancelTemplatePendingRule=s,V.approveTemplatePendingUrlRule=v,V.cancelTemplatePendingUrlRule=u,V.approvePendingUrlRule=w,V.cancelPendingUrlRule=x,V.approvePendingUrlParams=y,V.cancelPendingUrlParams=z,V.getUrlParamsViewText=j.getUrlParamsViewText,V.approveAllPendingDistributionChanges=M,V.cancelAllPendingDistribution=L,V.exportPendingDistributions=S,V.getDistributionViewText=O,V.approvePendingServer=B,V.cancelPendingServer=A,V.approvePendingWhitelisted=D,V.validateAndApprovePendingWhitelisted=E,V.cancelPendingWhitelisted=C,V.confirmApprovePendingChanges=F,V.confirmValidateAndApprovePendingChanges=G,V.confirmCancelPendingChanges=J,V.triggerModelReload=H,V.triggerStacksReload=I,V.downloadCoreBackup=P,U(),k.onChangeApp(b,function(a){U()})}angular.module("uxData").controller("Changes",a),a.$inject=["$log","$scope","$window","$state","toastr","dialogs","changesRequestsService","authService","USER_PERMISSIONS","changesService","messageService","LOCALSTORAGE_PAGE_NAMES","STATES_CONSTANTS"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a,b){if(409===a){var d=f.notify("Pending changes are out of date","While you are reviewing the changes someone made more changes so you need to reload the page and review again before approving or canceling any change.");return d.result.then(function(a){c.location.reload()},function(){}),!0}if(406===a){var g=f.confirm("Please Confirm",'Approve impossible because settings for redirector config are not exist. If you have access to  "Settings" page, please set settings for redirector config or contact your administrator. Do you want to go to "Settings" page?');return g.result.then(function(a){q()},function(){}),!0}return e.error("Action failed due to server error: "+b,"Error",{closeButton:!0,timeOut:2e4}),!1}function p(a){angular.isDefined(a)&&""!==a&&e.warning(a.message,"Warning",{closeButton:!0,timeOut:12e3})}function q(){return ba.authService.isAuthorized(ba.USER_PERMISSIONS().writeSettings)?void d.go(n().settings):void e.error('You do not have permission to access on "Settings" page.',"Error",{closeButton:!0,timeOut:2e4})}function r(a){g.cancelPendingRule(a,ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function s(a){g.approvePendingRule(a,ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function t(a){g.cancelTemplatePendingRule(a,ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function u(a){g.approveTemplatePendingRule(a,ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function v(a){g.cancelTemplatePendingUrlRule(a,ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function w(a){g.approveTemplatePendingUrlRule(a,ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function x(a){g.approvePendingUrlRule(a,ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function y(a){g.cancelPendingUrlRule(a,ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function z(){g.approvePendingUrlParams(ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function A(){g.cancelPendingUrlParams(ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function B(a){g.cancelPendingServer(a,ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function C(a){g.approvePendingServer(a,ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function D(){g.cancelPendingStackManagement(ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function E(){g.approvePendingStackManagement(ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function F(){g.validateAndApprovePendingStackManagement(ba.changes.version).then(function(a){p(a),Z()},function(a){o(a.status,a.data)})}function G(){var a=f.confirm("Approve changes confirmation","Are you sure you want to approve all the changes in the list ?");a.result.then(function(a){g.approvePendingChanges(ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})},function(){})}function H(){var a=f.confirm("Approve changes confirmation","Are you sure you want to approve all the changes in the list ?");a.result.then(function(a){g.hasPendingChanges().then(function(a){"true"==a?g.validateAndApprovePendingChanges(ba.changes.version).then(function(a){p(a),W(),Z()},function(a){o(a.status,a.data)}):W()},function(){})})}function I(){var a=f.confirm("Model reload confirmation","Are you sure you want to reload current model on XRE Redirector? ");a.result.then(function(a){h.triggerModelReload().then(function(a){e.success("Model reload triggered","Success",{closeButton:!0,timeOut:3e3})},function(a){e.error("Action failed due to server error","Error",{closeButton:!0,timeOut:3e3})})},function(){})}function J(){var a=f.confirm("Approve changes confirmation","Are you sure you want to <b>cancel</b> all the changes in the list ?");a.result.then(function(a){K()},function(){})}function K(){V(),g.cancelAllPendingChanges(ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function L(){g.cancelAllPendingDistribution(ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function M(){g.approveAllPendingDistribution(ba.changes.version).then(function(a){Z()},function(a){o(a.status,a.data)})}function N(a,b){var c=ba.changes[ca[b]];c.entry.forEach(function(b){var c=b;c.key===a&&(c.value.open=!c.value.open)})}function O(a){return angular.isDefined(a)?a.percent+"% - "+a.server.path:""}function P(){h.downloadCoreBackup()}function Q(){h.exportAllPending()}function R(a,b){h.exportPending(a,b)}function S(){h.exportPendingDistributions()}function T(){h.exportPendingStackManagement()}function U(a){g.cancelNamespacesChanges(a.key).then(function(a){Z()},function(a){e.error("Cancel failed due to server error: "+a.data,"Error",{closeButton:!0,timeOut:2e4})})}function V(){g.cancelAllNamespacesChanges().then(function(a){Z()},function(a){e.error("Cancel failed due to server error: "+a.data,"Error",{closeButton:!0,timeOut:2e4})})}function W(){g.approveAllNamespacesChanges(ba.namespacesChanges).then(function(a){ba.namespacesChanges=angular.copy(a.namespaceChanges),e.success("Approve Namespaces Changes","Success",{closeButton:!0,timeOut:3e3}),Z()},function(a){_(),f.notify("Failed to approve namespaced list(s): "+aa(),a.data)})}function X(a){g.approveNamespacesChanges(a.key).then(function(a){e.success("Approve Namespaces Changes","Success",{closeButton:!0,timeOut:3e3})},function(a){e.error("Approve failed due to server error: "+a.data,"Error",{closeButton:!0,timeOut:2e4})})}function Y(b){g.hasChanges(b).then(function(a){"true"==a?e.warning("Model has no changes to import","Warning",{closeButton:!0,timeOut:12e3}):Z()},function(b){a.error("Error occured  while determining pending changes emptyness",b)})}function Z(){_(),k.loadPendingChanges().then(function(a){$(a)},function(b){a.error(b)})}function $(a){ba.pendingDistribution=angular.copy(a.pendingDistribution),ba.currentDistribution=angular.copy(a.currentDistribution),ba.changes=angular.copy(a.pending),ba.changes.pathRules=k.generatePathRules(ba.changes.pathRules),ba.changes.templatePathRules=k.generatePathRules(ba.changes.templatePathRules),ba.changes.urlRules=k.generateUrlRules(ba.changes.urlRules),ba.changes.templateUrlPathRules=k.generateUrlRules(ba.changes.templateUrlPathRules);var b=k.generateWhitelistedData(ba.changes.whitelisted,a.whitelisted);ba.whitelistChangedDiff=b.whitelistChangedDiff,ba.whitelistCurrentDiff=b.whitelistCurrentDiff}function _(){k.loadNamespacesChanges().then(function(a){ba.namespacesChanges=angular.copy(a.namespaceChanges)},function(b){a.error(b)})}function aa(){var a="",b="";return angular.forEach(ba.namespacesChanges.entry,function(c){a+=b+c.key.name,b=", "}),a}var ba=this;ba.changes={},ba.version=0,ba.parseInt=parseInt,ba.currentDistribution={},ba.pendingDistribution={},ba.whitelistChangedDiff="",ba.whitelistCurrentDiff="",ba.namespacesChanges={},ba.authService=i,ba.USER_PERMISSIONS=j,ba.ITEM_TYPES={RULE:"RULE",TEMPLATE_RULE:"TEMPLATE_RULE",URLRULE:"URLRULE",TEMPLATE_URLRULE:"TEMPLATE_URLRULE",DISTRIBUTION:"DISTRIBUTION",SERVER:"SERVER",WHITELISTED:"WHITELISTED",NAMESPACES:"NAMESPACES"},Dropzone.options.dzform={url:"/default",paramName:"file",dictDefaultMessage:"Click to select XRE backup archive.",maxFiles:1,init:function(){this.on("processing",function(a){this.options.url=g.getCoreBackupUploadUrl()}),this.on("success",function(a,b){Y(b)}),this.on("error",function(a,b){angular.isDefined(a.accepted)&&a.accepted&&f.error("Failed to import XRE backup changes",b)})},maxfilesexceeded:function(a){this.removeAllFiles(),this.addFile(a)}};var ca=(new Dropzone("#dzform"),{});ca[ba.ITEM_TYPES.RULE]="pathRules",ca[ba.ITEM_TYPES.TEMPLATE_RULE]="templatePathRules",ca[ba.ITEM_TYPES.URLRULE]="urlRules",ca[ba.ITEM_TYPES.TEMPLATE_URLRULE]="templateUrlPathRules",ca[ba.ITEM_TYPES.DISTRIBUTION]="distributions",ca[ba.ITEM_TYPES.SERVER]="servers",ca[ba.ITEM_TYPES.WHITELISTED]="whitelisted",ca[ba.ITEM_TYPES.NAMESPACES]="namespaces",ba.cancelAllPendingChanges=K,ba.toggleItem=N,ba.exportAllPending=Q,ba.exportPending=R,ba.exportPendingStackManagement=T,ba.approvePendingRule=s,ba.cancelPendingRule=r,ba.approveTemplatePendingRule=u,ba.cancelTemplatePendingRule=t,ba.approveTemplatePendingUrlRule=w,ba.cancelTemplatePendingUrlRule=v,ba.approvePendingUrlRule=x,ba.cancelPendingUrlRule=y,ba.approvePendingUrlParams=z,ba.cancelPendingUrlParams=A,ba.getUrlParamsViewText=k.getUrlParamsViewText,ba.approveAllPendingDistributionChanges=M,ba.cancelAllPendingDistribution=L,ba.exportPendingDistributions=S,ba.getDistributionViewText=O,ba.approvePendingServer=C,ba.cancelPendingServer=B,ba.approvePendingWhitelisted=E,ba.cancelPendingWhitelisted=D,ba.validateAndApprovePendingWhitelisted=F,ba.confirmApprovePendingChanges=G,ba.confirmValidateAndApprovePendingChanges=H,ba.confirmCancelPendingChanges=J,ba.triggerModelReload=I,ba.downloadCoreBackup=P,ba.approveAllNamespacesChanges=W,ba.cancelAllNamespacesChanges=V,ba.approveNamespacesChanges=X,ba.cancelNamespacesChanges=U,Z(),l.onChangeApp(b,function(a){Z()})}angular.module("uxData").controller("changesOffline",a),a.$inject=["$log","$scope","$window","$state","toastr","dialogs","changesOfflineRequestsService","changesRequestsService","authService","USER_PERMISSIONS","changesOfflineService","messageService","LOCALSTORAGE_PAGE_NAMES","STATES_CONSTANTS"]}(),angular.module("uxData").config(["$provide",function(a){}]),angular.module("uxData").controller("applicationsCtrl",["$scope","$rootScope","$sessionStorage","messageService","$state","requestsService","authService","utilsService","COMMON_CONSTANTS",function(a,b,c,d,e,f,g,h,i){a.applications=[],a.applications.push(i().APPLICATIONS.DEFAULT),angular.isUndefined(c.currentApplication)?b.currentApplication=a.applications[0]:b.currentApplication=c.currentApplication,a.appsChooseHolder={},a.appsChooseHolder.currentApplication=b.currentApplication,a.changeApplication=function(a){b.currentApplication=a,d.changeApp(a)},angular.element(document).ready(function(){b.isPageReloading||f.getApplicationNames().then(function(b,c,d){var e=angular.isDefined(b.appNames)?h.toArray(b.appNames):[];angular.forEach(e,function(b,c){b!==i().APPLICATIONS.DEFAULT&&"shell"!==b&&g.isAppAccessible(b)&&a.applications.push(b)})})}),d.onChangeApp(a,function(d){b.currentApplication=d.name,c.currentApplication=d.name,a.appsChooseHolder.currentApplication=d.name,f.createNodesIfAbsent(b.currentApplication)})}]),function(){"use strict";function a(a,b,c,d,e,f,g,h){a.authService=f,a.USER_PERMISSIONS=g;var i=function(){a.backupTriggerProgress=!1,a.backupUsageUpdateProgress=!1,a.weekDays=[{day:"MON"},{day:"TUE"},{day:"WED"},{day:"THU"},{day:"FRI"},{day:"SAT"},{day:"SUN"}],a.scheduleTime=new Date,a.scheduleDuration={hours:0,minutes:0}};a.triggerBackup=function(){a.backupTriggerProgress=!0,e.triggerStacksBackup(b.currentApplication).then(function(b){h.success("Backup triggered successfully","Success",{closeButton:!0,timeOut:3e3}),a.backupTriggerProgress=!1},function(b){h.error("Can't trigger backup","Error",{closeButton:!0,timeOut:3e3}),a.backupTriggerProgress=!1})},a.updateBackupUsageSchedule=function(){a.backupUsageUpdateProgress=!0;var c='<backupUsageSchedule schedule="'+k()+'" duration="'+o()+'"/>';e.updateBackupUsageSchedule(c,b.currentApplication).then(function(b){h.success("Schedule updated successfully","Success",{closeButton:!0,timeOut:3e3}),a.backupUsageUpdateProgress=!1},function(b){h.error("Can't updated schedule","Error",{closeButton:!0,timeOut:3e3}),a.backupUsageUpdateProgress=!1})};var j=function(){e.getBackupUsageSchedule(b.currentApplication).then(function(b){a.scheduleTime=m(b.schedule),a.scheduleDuration=l(b.duration),n(b.schedule)},function(a){console.log(a.status)})},k=function(){var b=a.scheduleTime.getMinutes(),d=a.scheduleTime.getHours(),e=c("filter")(a.weekDays,{checked:!0}),f="";for(var g in e)""!==f&&(f+=","),f+=e[g].day;return""===f&&(f="*"),"0 "+b+" "+d+" ? * "+f},l=function(a){var b=a/6e4%60,c=(a/6e4-b)/60;return{hours:c,minutes:b}},m=function(a){var b=a.split(" "),c=new Date;return c.setHours(b[2]),c.setMinutes(b[1]),
c},n=function(b){var c=b.split(" "),d=c[5].split(",");for(var e in a.weekDays)for(var f in d)if(d[f]===a.weekDays[e].day){a.weekDays[e].checked=!0;break}},o=function(){return 6e4*(60*a.scheduleDuration.hours+1*a.scheduleDuration.minutes)};d.onChangeApp(a,function(a){i(),j()}),angular.element(document).ready(function(){i(),j()})}angular.module("uxData").controller("BackupCtrl",a),a.$inject=["$scope","$rootScope","$filter","messageService","requestsService","authService","USER_PERMISSIONS","toastr"]}(),angular.module("uxData").controller("logoutCtrl",["$scope","logoutService","authService",function(a,b,c){a.goToRedirect=function(){b.cleanTokenAndGoToLoginPage()},a.showLogoutButton=!c.isDevProfile()}]),angular.module("uxData").controller("PaginatorCtrl",["$scope","localStorageService",function(a,b){a.paginationSettings.arrayRows=a.arrayRows,a.paginationSettings.page="true"==b.get(a.paginationSettings.localStoragePath+".savePageNo")&&angular.isDefined(b.get(a.paginationSettings.localStoragePath+".pageNo"))&&null!=b.get(a.paginationSettings.localStoragePath+".pageNo")?b.get(a.paginationSettings.localStoragePath+".pageNo"):0,b.remove(a.paginationSettings.localStoragePath+".savePageNo"),a.paginationSettings.perPage=angular.isDefined(b.get(a.paginationSettings.localStoragePath))&&null!=b.get(a.paginationSettings.localStoragePath)?b.get(a.paginationSettings.localStoragePath):50,a.prevPage=function(){a.paginationSettings.page>0&&(a.paginationSettings.page-=1)},a.nextPage=function(){a.paginationSettings.page<a.paginationSettings.numPages-1&&(a.paginationSettings.page+=1)},a.toPageId=function(b){b>=0&&b<=a.paginationSettings.numPages-1&&(a.paginationSettings.page=b)},a.paginationSettings.refresh=function(){b.set(a.paginationSettings.localStoragePath,a.paginationSettings.perPage),a.paginationSettings.numPages=Math.ceil(a.paginationSettings.arrayRows.length/a.paginationSettings.perPage),+a.paginationSettings.page+1>a.paginationSettings.numPages&&+a.paginationSettings.numPages>0&&(a.paginationSettings.page=0==a.paginationSettings.page?0:a.paginationSettings.numPages-1),b.set(a.paginationSettings.localStoragePath+".pageNo",a.paginationSettings.page)},a.refresh=a.paginationSettings.refresh,a.paginationSettings.numPages=Math.ceil(a.paginationSettings.itemsLength/a.paginationSettings.perPage)}]).filter("startFrom",function(){return function(a,b){return angular.isUndefined(a)?a:a.slice(+b)}}).filter("range",function(){return function(a,b){b=parseInt(b);for(var c=0;c<b;c++)a.push(c);return a}}),angular.module("uxData").controller("RulePreviewController",["$scope","$rootScope","utilsService","authService","USER_PERMISSIONS","requestsService","templatesRequestsService","deciderRulesRequestService","diffService",function(a,b,c,d,e,f,g,h,i){a.VIEW_MODES={SIMPLE:"simple",XML:"xml",DIFF_XML:"diffXml"},a.ruleId="",a.viewMode=a.VIEW_MODES.SIMPLE,a.authService=d,a.USER_PERMISSIONS=e,angular.isDefined(a.data.id)&&!$.isEmptyObject(a.data.id)&&(a.ruleId=a.data.id),a.onEditRule=function(){a.onRuleEdit({ruleId:a.ruleId})},a.onShowSimple=function(){a.viewMode=a.VIEW_MODES.SIMPLE},a.onShowXML=function(){a.viewMode=a.VIEW_MODES.XML},a.onShowDiff=function(){a.viewMode=a.VIEW_MODES.DIFF_XML},a.onDeleteRule=function(){a.onRuleDelete({ruleId:a.ruleId})},a.isSimpleMode=function(a,b){return"simple"===a.serverEditMode[b]},a.hideDiffButton=function(){return!a.data.changeType||a.viewMode===a.VIEW_MODES.DIFF_XML||!a.hasChanges(a.data.diffRuleCurrentText,a.data.diffRuleChangedText)},a.isEditable=function(){return!(angular.isDefined(a.editable)&&!a.editable)},a.exportRule=function(c,d){switch(d){case"rule":a.template?g.exportTemplate("templates/rules",b.currentApplication,c):f.exportRule(b.currentApplication,c);break;case"urlRule":a.template?g.exportTemplate("templates/urlRules",b.currentApplication,c):f.exportUrlRule(b.currentApplication,c);break;case"deciderRule":h.exportRule(c)}},a.hasAdvancedServers=function(){if(!angular.isDefined(a.data.serverEditMode))return!1;a.advancedServersCount=0;for(var b=0;b<a.data.serverEditMode.length;b++)"advanced"===a.data.serverEditMode[b]&&a.advancedServersCount++;return a.advancedServersCount>0};var j=function(a){return angular.isDefined(a)?a:""};a.getDiffs=function(a,b,c){var d={ignoreLeadingWS:!0,showAllContent:!0,type:"default"};return i.formattedDiff(j(a),j(b),c,d)},a.hasChanges=function(a,b){return!angular.equals(j(a),j(b))}}]),angular.module("uxData").controller("serverCtrl",["$scope","$rootScope","$filter","messageService","requestsService","utilsService",function(a,b,c,d,e,f){a.message="Server",a.data={},a.data.xreGuide={},a.data.xreGuide.path=[],a.data.xreApp={},a.data.xreApp.path=[],a.currentPath="",a.currentApp=b.currentApplication;var g={};a.result=[],a.isCurrentPathDirty=!1,a.isCurrentPathValid=!1,d.onChangeApp(a,function(b){a.disabled||(a.currentApp=b.name)}),d.onEditSelectServer(a,function(b){a.id==b.id&&(a.disabled=!a.disabled)}),a.getCurrentApp=function(){return a.currentApp},d.onGetServerData(a,function(b){a.servicePaths=b.data}),a.isDisabled=function(){return a.disabled},a.isSimple=function(){return!(angular.isDefined(a.editMode)&&!angular.equals(a.editMode,"simple"))},a.updateData=function(){a.isSimple()&&(a.values.url=f.createUrl()),a.values.path=a.currentPath},a.setData=function(){a.isSimple()&&(a.currentPath=a.values.path,a._currentPath={NAME:a.currentPath})},a.urlChanged=function(){a.isCurrentParthDirty=!0},a.getListOfPaths=function(){var b=[];$.isEmptyObject(a.servicePaths)||angular.equals(a.servicePaths,g)||(angular.isDefined(a.getCurrentApp())&&(angular.isArray(a.servicePaths.stack)||(a.servicePaths.stack=[a.servicePaths.stack]),angular.isArray(a.servicePaths.flavor)||(a.servicePaths.flavor=[a.servicePaths.flavor]),(angular.isUndefined(a.showStacks)||angular.isDefined(a.showStacks)&&1==a.showStacks)&&angular.forEach(a.servicePaths.stack,function(b,c){var d=a.showWhitelistedCount?parseInt(b.nodesWhitelisted):parseInt(b.nodes);this.push({GROUP:"Stacks",NAME:b.value,VALUE:d>0?b.value+" ("+d+")":b.value+" (inactive)",ACTIVE:d>0})},b),(angular.isUndefined(a.showFlavors)||angular.isDefined(a.showFlavors)&&1==a.showFlavors)&&angular.forEach(a.servicePaths.flavor,function(b,c){var d=a.showWhitelistedCount?parseInt(b.nodesWhitelisted):parseInt(b.nodes);d>0&&this.push({GROUP:"Flavors",NAME:b.value,NUMBER_VALUE:parseFloat(b.value),VALUE:d>0?b.value+" ("+d+")":b.value+" (inactive)",ACTIVE:d>0})},b)),g=angular.copy(a.servicePaths),a.result=b);angular.isUndefined(a.showFlavors)||angular.isDefined(a.showFlavors)&&1==a.showFlavors,angular.isUndefined(a.showStacks)||angular.isDefined(a.showStacks)&&1==a.showStacks;return a.result},a.pathChanged=function(){a.currentPath=a._currentPath.NAME,a.serverChanged()},a.serverChanged=function(){a.updateData(),a.onChanged(),a.validateServer()},a.validateServer=function(){a.updateData(),a.isCurrentPathDirty=!0,a.isCurrentPathValid=!1;var b=!$.isEmptyObject(a.validationData),c=!!b&&!$.isEmptyObject(a.validationData.generalErrorMsg);if(a.isSimple())a.isCurrentPathValid=""!==a.currentPath;else if(angular.isDefined(a.values.url)&&""!==a.values.url){var d=/^([a-z]+){1}(:\/\/)([\w]+)([:]*)([0-9]*)[\/]*([\w]*)/g;d.exec(a.values.url)&&(a.isCurrentPathValid=!0)}return a.isCurrentPathValid&&!c}}]),function(){"use strict";var a=angular.module("uxData.core");a.factory("zkDownInterceptor",["$q","$injector",function(a,b){return{responseError:function(c){var d=!0;if(null!=c.data&&angular.isDefined(c.data.errors)){var e=" ";angular.forEach(c.data.errors.entry,function(a){e+=a.value+"  "}),c.data.message=e}else angular.isUndefined(c.data.message)&&(angular.isString(c.data)?c.data={message:c.data}:c.data={message:"Cannot get error data"});if(500===c.status&&b.get("$state").go("error"),503===c.status){var f=b.get("$rootScope");if("decider"!=f.currentApplication&&(c.data={message:"Zookeeper is unavaliable"},d=!1),!f.is503DialogShown&&"decider"!=f.currentApplication){var g="/dev",h="/devRedirectorOffline",i="/admin",j="/adminOffline",k=b.get("dialogs").confirm("Offline mode may be needed","Seems that zookeeper is down. We have an offline mode for such cases. Go to offline mode?");f.is503DialogShown=!0,k.result.then(function(a){f.is503DialogShown=!1,b.get("$window").location.href.indexOf(g)>=0?b.get("$window").location.href=b.get("$window").location.href.replace(g,h):b.get("$window").location.href=b.get("$window").location.href.replace(i,j)},function(a){f.is503DialogShown=!1})}}return 400===c.status&&c.data.message.indexOf("UnmarshalException")>0&&d?c:d?a.reject(c):void 0}}}]),a.factory("invalidApplicationInterceptor",["$q","$injector",function(a,b){return{responseError:function(c){var d=b.get("$rootScope");if(!d.invalidApplicationDialogShown&&404===c.status&&angular.isDefined(c.data.message)&&c.data.message.indexOf("Application not found")>-1){var e=b.get("dialogs").error("Need at least one stack","You need to register stack for current application");e.result.then(function(){d.invalidApplicationDialogShown=!1},function(){d.invalidApplicationDialogShown=!1}),d.invalidApplicationDialogShown=!0,a.reject(c)}return a.reject(c)}}}]),a.factory("authInterceptor",["$rootScope","$q","AUTH_EVENTS",function(a,b,c){return{responseError:function(d){return a.$broadcast({401:c().notAuthenticated,403:c().notAuthorized}[d.status],d),b.reject(d)}}}]),a.config(["$httpProvider",function(a){a.interceptors.push("invalidApplicationInterceptor"),a.interceptors.push("zkDownInterceptor"),a.interceptors.push("authInterceptor")}]),a.config(["$locationProvider",function(a){a.html5Mode(!1)}]);var b={appErrorPrefix:"[Redirector-UI Error] ",version:"1.0.0"};a.value("config",b),a.run(["$rootScope","$injector","$location","$window","$state","editableOptions","editableThemes","dialogs","currentApplication","redirectorOfflineMode","requestsService","authService","AUTH_EVENTS","tokenService","logoutService","STATES_CONSTANTS","utilsService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(){var c=q.getFromCookies("token");if(null!=c){var d=s(c);if(d<=u){if(!a.isSessionRestoreDialogShown&&a.showExpirationDialog){a.isSessionRestoreDialogShown=!0;var e=b.get("dialogs").confirm("Session will expire in 2 minute(s). ","Session will expire in 2 minute(s). Restore the session?");e.result.then(function(b){k.searchNamespacesByItem("Stub_for_session_restore").then(function(a){},function(a){o.cleanTokenAndGoToLoginPage()}),a.isSessionRestoreDialogShown=!1},function(b){a.isSessionRestoreDialogShown=!1,a.showExpirationDialog=!1})}}else a.showExpirationDialog=!0}}function s(a){var b=a.split(".")[1],c=d.atob(b),e=JSON.parse(c).exp,f=Math.abs(new Date(1e3*e)-new Date);return Math.round(f/6e4)}var t=["ShowTestSuite","ShowAutoTestSuite","EditTestSuite","EditTestSuite","RunTestSuite","ImportTestSuite","RulesImportController","UrlRulesImportController","summaryController","changesOffline","modelInitializerController"];const u=2;a.tokenTimerVar=setInterval(r,6e4),a.showExpirationDialog=!0,a.isSessionRestoreDialogShown=!1,a.redirectorOfflineMode=j,j||n.removeGlobalUser(),n.saveTokenAndReloadPage(k)||(a.$on(m().notAuthorized,function(a,b){h.error("Access is denied","You are not authorized for this functionality: "+(angular.isDefined(b)?b.data.message:""))}),a.$on(m().notAuthenticated,function(a,b){if(!j){var c=h.notify("Session is expired","Your session is expired. No data and actions will be available until you re-login. Please re-login.");c.result.then(function(a){o.cleanTokenAndGoToLoginPage()})}}),a.$on("$locationChangeSuccess",function(a){n.getHashFromPageAndSaveItGlobal()}),j||"decider"===i||k.atLeastOneValidModelExists().then(function(a){"false"==a&&e.go(p().modelInitializer)}),a.$on("$stateChangeStart",function(b,c){if(angular.isDefined(c.data)){angular.isDefined(a.isPageReloading)&&a.isPageReloading===!0&&b.preventDefault();var d=c.data.permissions;l.isAuthorized(d)||(b.preventDefault(),l.isAuthenticated()?a.$broadcast(m().notAuthorized):a.$broadcast(m().notAuthenticated)),t.indexOf(c.controller)>=0&&a.redirectorOfflineMode&&(b.preventDefault(),e.go(p().showFlavorRules))}}),a.$on("$stateChangeSuccess",function(b,c,d,f,g){e.previousState=f,e.previousParams=g,e.previousServiceName=a.currentApplication}))}])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(){q(),d.getPendingChangesJson(b.currentApplication).then(function(a){s.changes=a,o(b.currentApplication)})}function l(){var a=angular.copy(s.servicePaths);return void 0===s.servicePaths||void 0===s.servicePaths.flavor?[]:(angular.forEach(s.servicePaths.flavor,function(b,c){for(var d=0;d<s.serverHolder.distribution.displayableRules.length;d++)b.value===s.serverHolder.distribution.displayableRules[d].server.path&&a.flavor.splice(m(a.flavor,b.value),1)}),void(s.nonSelectedPaths=a))}function m(a,b){for(var c=0;c<a.length;c++)if(a[c].value===b)return c}function n(a,b,c){var d=null,f=!1,g="",h=e.createUrl();return angular.isDefined(b)&&(f=!0,g=b.changeType,d=b.currentExpression,h=angular.copy(d.url)),{name:c+" Server",url:h,secureUrl:"",path:angular.copy(null!=d?d.path:a.path),description:c+" Server route",editMode:h.indexOf("host")>-1?"simple":"advanced",hasChanges:f,changeType:g}}function o(){d.getDefaultServer(b.currentApplication).then(function(a){var b=e.getPendingChangesObjectById(s.changes,"servers","default");angular.isDefined(b)&&(s.serverHolder.defaultPendingText=b.changedExpression.path,s.serverHolder.defaultCurrentText=b.currentExpression.path),s.serverHolder.defaultServer=n(a,b,"Default"),s.serverBeforeEdit=angular.copy(s.serverHolder.defaultServer)},function(a){i.error("Can't get Default Server","Error",{closeButton:!0,timeOut:3e3})})}function p(){d.exportDistributionsAlongWithServers()}function q(){d.getServicePaths(b.currentApplication).then(function(a){"undefined"!=typeof a.paths?(s.servicePaths=a.paths[0],l()):s.servicePaths=[]},function(a){i.error("Can't get servicePath","Error",{closeButton:!0,timeOut:3e3})})}function r(){s.serverHolder.defaultCurrentText=s.serverBeforeEdit.path,s.serverHolder.defaultPendingText=s.serverHolder.defaultServer.path,s.serverHolder.inputs.saved=!1}var s=this;s.serverHolder=a.serverHolder,s.defaultServerToggle=!1,s.currentApplication=b.currentApplication,s.changes={},s.serverHolder.defaultServer={},s.serverBeforeEdit={},s.isSavingDefaultServer=!1,s.authService=g,s.USER_PERMISSIONS=h,s.entityName="server",s.responseErrorMsg="",s.serverHolder.defaultCurrentText="",s.serverHolder.defaultPendingText="",s.exportAll=p,s.changeDefaultServer=r,s.returnOnlyNonSelectedPaths=l,s.serverHolder.returnOnlyNonSelectedPathsForDefault=l,s.nonSelectedPaths=[],k(),c.onChangeApp(a,function(a){s.serverHolder.defaultCurrentText="",s.serverHolder.defaultPendingText="",s.changes={},s.serverHolder.defaultServer={},k()}),a.$watch(s.serverHolder.distribution,function(a){l()})}angular.module("uxData.defaultserver").controller("DefaultServer",a),a.$inject=["$scope","$rootScope","messageService","requestsService","utilsService","mediator","authService","USER_PERMISSIONS","toastr","dialogs"]}(),function(){"use strict";function a(){return{restrict:"E",scope:{serverHolder:"="},link:function(a,b){},templateUrl:"../uxData/scripts/default-server/default-server.directive.html",controller:"DefaultServer",controllerAs:"vm"}}angular.module("uxData.defaultserver").directive("defaultServer",a)}(),function(){"use strict";function a(a,b){function c(){return!angular.equals(h(a.baseText),h(a.changedText))}function d(){return!e()&&!f()&&!angular.equals(a.baseText,a.changedText)}function e(){return angular.isUndefined(a.baseText)||angular.isDefined(a.baseText)&&""==a.baseText}function f(){return angular.isUndefined(a.changedText)||angular.isDefined(a.changedText)&&""==a.changedText}function g(a,c,d,e){var f={ignoreLeadingWS:!0,showAllContent:!0,type:e};return b.formattedDiff(h(a),h(c),d,f)}function h(a){return angular.isDefined(a)?a:""}var i=this;i.baseHeadTitle=a.baseHeadTitle||"Current",i.changedHeadTitle=a.changedHeadTitle||"Pending",i.isUpdateStatus=d,i.isDeleteStatus=f,i.hasDiffChanges=c,i.isAddStatus=e,i.getDiffs=g}angular.module("uxData.diff").controller("DiffCtrl",a),a.$inject=["$scope","diffService"]}(),angular.module("uxData.diff").directive("diff",function(){return{restrict:"E",replace:!0,scope:{baseHeadTitle:"=?",baseText:"=",changedHeadTitle:"=?",changedText:"=",type:"="},templateUrl:"../uxData/scripts/diff/diff.html",controller:"DiffCtrl",controllerAs:"diffCtrl"}}),angular.module("uxData").directive("btnSwitch",function(){return{restrict:"A",require:"ngModel",templateUrl:"../uxData/views/switcher.html",replace:!0,link:function(a,b,c,d){function e(){var a=d.$viewValue;d.$setViewValue(!a),f()}d.$render=function(){f()};var f=function(){var a=d.$viewValue,c=angular.element(b.children()[0]);c.removeClass(a?"hide":"show"),c.addClass(a?"show":"hide");var e=angular.element(b.children()[1]);e.removeClass(a?"show":"hide"),e.addClass(a?"hide":"show")};b.bind("click",function(b){b.preventDefault(),b.stopPropagation(),a.$apply(e)}),d&&f()}}}),angular.module("uxData").directive("convertNumber",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){function e(a){return a.indexOf(".")===-1}var f=6,g=" M",h=".",i="0",j=12;d.$parsers.unshift(function(a){return o(a)?(d.$setValidity("convertNumber",!0),a):void d.$setValidity("convertNumber",!1)}),d.$formatters.push(function(a){return null==a?a:("0"!==a.toString()&&(a=m(a)),a.length>f&&(a=k(a.toString())),a)}),b.on("blur",function(){var a,b=d.$modelValue;if(null!=b){for(var c=d.$formatters,e=c.length,f=0;f<e;f++)a=c[f],b=a(b);return d.$viewValue=b,d.$render()}}),b.on("focus",function(){var a=b.val();return a!==i&&a.indexOf(g)!==-1&&(a=a.replace(g,""),a=n(a),b.val(a.replace(h,""))),b[0].select()});var k=function(a){return a=a.replace(/(\d)(?=(\d{6})+(?!\d))/g,"$1."),a=l(a),a.indexOf(h)+1===a.length&&(a=a.replace(h,"")),a+=g},l=function(a){return a=a.replace(/0+$/,"")},m=function(a){return a=a.replace(/^0+/,"")},n=function(a){for(var b=a.indexOf(h)===-1?0:a.substring(a.indexOf(h),a.length-1).length,c=0;c<f-b;c++)a+=i;return a},o=function(a){return p(a)&&q(a,j)},p=function(a){return e(a)&&isFinite(a)&&a>0},q=function(a,b){return a.toString().length<b}}}}),angular.module("uxData").directive("expressionold",function(){return{restrict:"E",replace:!0,scope:{type:"@",data:"=",validationData:"=",onNameChanged:"&",onOperatorChanged:"&",onValueTypeChanged:"&"},templateUrl:"../uxData/views/Expression.html",controller:"ExpressionController"}});var maxlengthDirective=function(){return{require:"?ngModel",priority:101,link:function(a,b,c,d){if(d){var e=0;c.$observe("maxlength",function(a){e=int(a)||0,d.$validate()}),d.$validators.maxlength=function(a,b){return d.$isEmpty(b)||b.length<=e}}}}};angular.module("uxData").directive("ngMaxlength",maxlengthDirective).directive("maxlength",maxlengthDirective),angular.module("uxData").directive("optionsDisabled",["$parse","$timeout",function(a,b){var c=function(a,b,c,d,e){$("option[value!='?']",c).each(function(c,f){var g={};g[b]=d[c],$(this).attr("disabled",e(a,g))})},d=function(a,d,e,f,g){var h=$("option[value!='?']",e);h.length<f.length?b(function(){c(a,d,e,f,g)},10):c(a,d,e,f,g)};return{priority:0,require:"ngModel",link:function(b,c,e,f){var g=e.optionsDisabled.match(/^\s*(.+)\s+for\s+(.+)\s+in\s+(.+)?\s*/),h=g[3],i=a(g[1]);b.$watch(h,function(a,e){a&&d(b,g[2],c,a,i)},!0),b.$watch(e.ngModel,function(e,f){var j=a(h)(b);e&&d(b,g[2],c,j,i)})}}}]),angular.module("uxData").directive("paginator",function(){return{restrict:"E",replace:!0,scope:{arrayRows:"=rows",paginationSettings:"=paginationSettings",showSettings:"=showSettings"},templateUrl:"../uxData/views/Paginator.html",controller:"PaginatorCtrl",controllerAs:"pg",link:function(a,b,c){a.$watch("paginationSettings",function(b){a.refresh()},!0)}}}),angular.module("uxData").directive("pendingChangesIcon",function(){return{restrict:"E",scope:{changeType:"=changetype"},templateUrl:"../uxData/views/pending/PendingChangesIcon.html"}}),angular.module("uxData").directive("progressButton",function(){return{restrict:"E",replace:!0,scope:{btnSize:"=size",btnLook:"=look",disableCondition:"=disabled",progressCondition:"=",btnTitle:"=title",click:"&onClick"},templateUrl:"../uxData/views/ProgressButton.html",link:function(a,b,c){angular.isUndefined(a.progressCondition)&&(a.progressCondition=!1)}}}),angular.module("uxData").directive("rulepreview",function(){return{restrict:"E",replace:!0,scope:{data:"=",simple:"=simple",ruleType:"=",focus:"=",editable:"=",template:"=",onRuleEdit:"&",onRuleDelete:"&",onRuleImport:"&",isImporting:"=",error:"="},templateUrl:"../uxData/views/RulePreview.html",controller:"RulePreviewController"}}),angular.module("uxData").directive("ruleXmlView",function(){return{restrict:"E",replace:!0,scope:{data:"="},templateUrl:"../uxData/views/RuleXmlView.html",link:function(a,b,c){a.$watch("data",function(a){b.children("textarea").val(a).text(a).format({method:"xml"}),b.children("textarea").autosize().show().trigger("autosize.resize")})}}}),angular.module("uxData").directive("serverold",["$parse",function(a){return{restrict:"E",replace:!0,scope:{id:"@",servicePaths:"=paths",editMode:"=editMode",values:"=",disabled:"=",showWhitelistedOption:"=",onlySimpleMode:"=onlySimpleMode",validationData:"=",showStacks:"=",showFlavors:"=",showWhitelistedCount:"=",onChanged:"&",showLabels:"&"},templateUrl:"../uxData/views/Server.html",controller:"serverCtrl",link:function(b,c,d){b.$watch("disabled",function(){b.disabled===!0||"true"===b.disabled?b.disabled=!0:b.disabled=!1}),angular.isDefined(d.showLabels)?b.showLabels=a(d.showLabels)(b):b.showLabels=!0,b.$watch("values",function(){angular.isDefined(b.values)&&b.setData()})}}}]),angular.module("uxData").directive("tableSorter",function(){return{restrict:"E",replace:!0,scope:{onClick:"&",predicate:"@"},templateUrl:"../uxData/views/tableSorter.html",controller:function(a,b,c,d){a.click=function(){angular.isUndefined(a.reverse)?a.reverse=!0:a.reverse=!a.reverse,a.showUpArrow=!a.reverse,a.showDownArrow=a.reverse,a.onClick({predicate:a.reverse?a.predicate:"-"+a.predicate,reverse:a.reverse})},a.showUpArrow=!0,a.showDownArrow=!0}}}),angular.module("uxData").directive("urlexpression",function(){return{restrict:"E",replace:!0,scope:{data:"=",validationData:"=",onNameChanged:"&",onOperatorChanged:"&",onValueChanged:"&",onValueAdded:"&",onValueRemoved:"&"},templateUrl:"../uxData/views/URLExpression.html",controller:"URLExpressionController"}}),angular.module("uxData").directive("urlparamsold",function(){return{restrict:"E",replace:!0,scope:{server:"=",validationData:"=",onServerChanged:"&"},templateUrl:"../uxData/views/URLParams.html",controller:"URLParamsController"}}),angular.module("uxData").directive("aDisabled",function(){return{restrict:"A",priority:-99999,link:function(a,b,c){a.$watch(c.aDisabled,function(d,e){d?b.unbind("click"):e&&b.bind("click",function(){a.$apply(c.ngClick)})})}}}),angular.module("uxData").directive("toggleButton",function(){return{restrict:"A",transclude:!0,replace:!1,require:"ngModel",link:function(a,b,c,d){var e=d,f=function(){var c=b.prop("checked");c!=e.$viewValue&&(e.$setViewValue(c),a.$apply())},g=function(){b.trigger("change")};b.on("change",function(){f()}),a.$watch(function(){return e.$viewValue},function(){g()}),b.bootstrapToggle()}}}),function(){"use strict";function a(){return{restrict:"E",scope:{rules:"=",searchSort:"=",isPathRule:"="},templateUrl:"../uxData/scripts/directives/rules/rule-filter-sort.directive.html"}}angular.module("uxData").directive("rulesFilterSort",a)}(),angular.module("uxData.diff-distribution").controller("DiffDistributions",["$scope","constantsProvider","utilsService","diffService",function(a,b,c,d){function e(){return""==m(a.baseDistributions)}function f(){return""==m(a.changedDistributions)}function g(){return!angular.equals(m(a.baseDistributions),m(a.changedDistributions))}function h(){return!e()&&!f()&&u.hasDiffChanges()}function i(b){var c={};switch(b){case u.SIDES.LEFT:c=a.baseDistributions;break;case u.SIDES.RIGHT:c=a.changedDistributions}return c}function j(a,b){switch(a){case u.SIDES.LEFT:u.isSomeBasePercentOutOfRange=b;break;case u.SIDES.RIGHT:u.isSomeChangedPercentOutOfRange=b}}function k(a){var b=0,c=i(a),d=!1;return angular.isDefined(c)&&null!=c&&angular.forEach(c,function(a,c){angular.isDefined(a)&&null!=a&&(angular.isUndefined(a.percent)&&(d=!0),b+=angular.isUndefined(a.percent)?0:a.percent)}),j(a,d),parseFloat(b)||0}function l(a){return k(a)<u.MAX_TOTAL_Percentage}function m(a){var b="";return angular.isDefined(a)&&null!=a&&angular.forEach(a,function(a,c){angular.isDefined(a)&&null!=a&&(b+=n(a,c+1)+"\n")}),b.substring(0,b.length-1)}function n(a,b){var c="";return angular.isDefined(a)&&null!=a&&angular.isDefined(a.server)&&(c+=b+". "+(angular.isUndefined(a.percent)?" OUT OF RANGE! ":a.percent)+"% - "+a.server.path,angular.isDefined(a.server.query)&&null!=a.server.query&&angular.isDefined(a.server.query.entry)&&null!=a.server.query.entry&&a.server.query.entry.length>0&&(c+=" [",angular.forEach(a.server.query.entry,function(a,b){c+=a.key+"="+a.value+", "}),c=c.slice(0,-2),c+="]")),c}function o(){var b=0;return a.baseDistributions&&null!=a.baseDistributions&&angular.isArray(a.baseDistributions)&&angular.forEach(a.baseDistributions,function(a,c){b=Math.max(b,a.id)}),a.changedDistributions&&null!=a.changedDistributions&&angular.isArray(a.changedDistributions)&&angular.forEach(a.changedDistributions,function(a,c){b=Math.max(b,a.id)}),a.baseDistributions&&a.baseDistributions.length<1&&a.changedDistributions.length&&a.changedDistributions.length<1?0:b+1}function p(a,b){var c={};if(angular.isDefined(a)&&null!=a)for(var d=0;d<a.length;d++)if(null!=a[d]&&angular.equals(a[d].id,b)){c=a[d];break}return c}function q(a){for(var b=[],c=o(),d=0;d<c;d++)b[d]=p(a,d);return b}function r(){u.baseNormalizedDistributions=u.getNormalizedArray(a.baseDistributions),u.changedNormalizedDistributions=u.getNormalizedArray(a.changedDistributions)}function s(a){return angular.isDefined(a)?a:""}function t(a,b,c){var e={ignoreLeadingWS:!0,showAllContent:!0,type:"default"};return d.formattedDiff(s(a),s(b),c,e)}var u=this;u.baseHeadTitle=a.baseHeadTitle||"Current distributions",u.changedHeadTitle=a.changedHeadTitle||"Pending distributions",u.baseNormalizedDistributions={},u.changedNormalizedDistributions={},u.SIDES={LEFT:"LEFT",RIGHT:"RIGHT"},u.isSomeBasePercentOutOfRange=!1,u.isSomeChangedPercentOutOfRange=!1,u.MAX_TOTAL_Percentage=100,u.refresh=r,u.isDeleteStatus=f,u.isAddStatus=e,u.isUpdateStatus=h,u.hasDiffChanges=g,u.getDistributionsBySide=i,u.isValidTotalPercentage=l,u.updatePercentOutOfRangeFlagBySide=j,u.calculateTotalPercentage=k,u.getDistributionViewText=n,u.getDistributionById=p,u.getNormalizedArray=q,u.getDistributionsSize=o,u.getDiffs=t}]),angular.module("uxData.diff-distribution").directive("diffDistributions",function(){return{restrict:"E",replace:!0,scope:{baseHeadTitle:"=?",baseDistributions:"=",changedHeadTitle:"=?",changedDistributions:"="},templateUrl:"../uxData/scripts/distribution-diff/distribution-diff.html",controller:"DiffDistributions",controllerAs:"vm",link:function(a,b,c,d){a.$watch("baseDistributions",function(a){d.refresh()},!0),a.$watch("changedDistributions",function(a){d.refresh()},!0)}}}),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){y.rule=angular.copy(y.originalRule),y.distributionObject=angular.copy(y.originalDistributionObject),y.editMode=angular.copy(y.originalEditMode),y.query=j.isEmptyObject(y.rule.rule.server.query)?z:y.rule.rule.server.query}function r(){var a=p.validateQueryPair(y.query);a.isValid?(y.rule.rule.server.query=x(),"add"===l?angular.isUndefined(y.rule.rule.server.path)?i.errorPathNotSelected():(b.close(y.rule),y.modify=!1):($.extend(!0,y.originalRule,y.rule),y.removeElements&&(y.originalRule.rule.server.query=y.rule.rule.server.query,y.removeElements=!1),b.close(!0))):y.validationData=a.validationData}function s(){v(),y.query.entry.push({key:"",value:""}),t()}function t(){y.rule.rule.server.query=y.query,angular.isDefined(y.validationData.queryError)&&y.validationData.queryError.length>0&&(y.validationData=p.checkValidationQueryPairAfterChanges(y.query,y.validationData.queryError))}function u(a){y.query.entry.splice(a,1),w(),y.validationData.queryError=p.removeValidationErrorIfExists(y.validationData.queryError,a),t(),y.removeElements=!0}function v(){j.isEmptyObject(y.query)&&(y.query=z)}function w(){j.isEmptyObject(y.query)||!j.isEmptyObject(y.query.entry)&&0!=y.query.entry.length||(y.query=null)}function x(){var a={entry:[]},b=!0;return angular.isDefined(y.query)&&null!=y.query&&angular.isDefined(y.query.entry)&&null!=y.query.entry?angular.forEach(y.query.entry,function(c,d){b=!0;for(var e=0;e<a.entry.length;e++)if(a.entry[e].key==c.key&&a.entry[e].value==c.value){b=!1;break}b&&(y.removeElements=!0,a.entry.push(c))}):a=null,a}var y=this,z={entry:[]};y.authService=g,y.USER_PERMISSIONS=h,angular.extend(y,{originalRule:k}),angular.extend(y,{originalDistributionObject:m}),angular.extend(y,{originalEditMode:l}),angular.extend(y,{paths:n}),y.title="edit"===y.editMode?"Edit distribution":"Add new distribution",y.percent="",y.path="",y.removeElements=!1,y.saveDistribution=r,y.hasError=j.isDefinedAndNotEmpty,y.addNewQueryPair=s,y.removeQueryPair=u,y.queryChanged=t,y.validationData={},q()}angular.module("uxData.distribution").controller("DistributionEdit",a),a.$inject=["$scope","$modalInstance","$log","$filter","toastr","ngTableParams","authService","USER_PERMISSIONS","distributionAlertsService","utilsService","rule","editMode","distributionObject","paths","SERVER_CONSTANTS","distributionValidationService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){T.loading=!1}function r(a){var b=d.defer();return p.getDistributionsWithChanges(a).then(function(a){angular.extend(T.changes,a.changes);var d=a.distribution;angular.isDefined(d)&&angular.isDefined(d.rule)?(angular.isArray(d.rule)||(d.rule=[d.rule]),Array.prototype.push.apply(T.distribution.displayableRules,d.rule),T.distribution.rulesFromDataSource.splice(0,T.distribution.rulesFromDataSource.length),T.distribution.changedRules.splice(0,T.distribution.changedRules.length),T.loading=!1,angular.isDefined(T.distribution.displayableRules)?(angular.forEach(T.distribution.displayableRules,function(a,b){var c=i.getPendingChangesObjectById(T.changes,"distributions",a.id);angular.isDefined(c)&&c.changeType!==j.PENDING_CHANGE_TYPE.DELETE&&(a.percent=c.changedExpression.percent,a.server.path=c.changedExpression.server.path),a.server.editMode=a.server.url.indexOf(U)>-1?"simple":"advanced",T.distribution.changedRules[b]=angular.copy(a)}),Array.prototype.push.apply(T.distribution.rulesFromDataSource,T.distribution.displayableRules),s()):q()):(angular.isUndefined(d)?c.error("incorrect distributions object was retrieved"):angular.isUndefined(d.rule)&&c.info("empty distributions were retrieved"),s(),T.loading=!1),b.resolve()},function(a){o.errorGetItems(),q(),b.reject()}),b.promise}function s(){angular.forEach(T.changes.distributions.entry,function(a,b){var c=a.value;if(c.changeType==j.PENDING_CHANGE_TYPE.DELETE){var d=S(T.distribution.displayableRules,parseInt(c.id));angular.isDefined(d.index)&&(T.distribution.displayableRules[d.index].hasChanges=!0,T.distribution.displayableRules[d.index].changeType=c.changeType);var e=S(T.distribution.changedRules,parseInt(c.id));angular.isDefined(e.index)&&T.distribution.changedRules.splice(e.index,1)}else if(c.changeType===j.PENDING_CHANGE_TYPE.ADD){var f=c.changedExpression;f.hasChanges=!0,f.changeType=c.changeType,T.distribution.changedRules.push(f),T.distribution.displayableRules.push(f)}else if(angular.isDefined(c.changedExpression)){var e=S(T.distribution.changedRules,parseInt(c.id));angular.isDefined(e.index)&&(T.distribution.changedRules[e.index]=c.changedExpression)}})}function t(a){var b=S(T.distribution.changedRules,a.id);angular.isDefined(b.index)&&(T.distribution.changedRules[b.index]=a);
}function u(a){t(T.distribution.displayableRules[a])}function v(a){var b=angular.copy(T.servicePaths);return angular.forEach(T.servicePaths.flavor,function(c,d){for(var e=0;e<T.distribution.displayableRules.length;e++)c.value===T.distribution.displayableRules[e].server.path&&a!==T.distribution.displayableRules[e].server.path&&b.flavor.splice(x(b.flavor,c.value),1);T.defaultServer.path===c.value&&b.flavor.splice(x(b.flavor,c.value),1)}),T.allowAddDistributions=1!==b.flavor.length,b}function w(){var a=[];return angular.forEach(T.servicePaths.flavor,function(b,c){b.nodes>0&&a.push(b.value)}),a}function x(a,b){for(var c=0;c<a.length;c++)if(a[c].value===b)return c}function y(){var a=d.defer();return h.getServicePaths(b.currentApplication).then(function(b){angular.isDefined(b)&&angular.isArray(b.paths)&&angular.extend(T.servicePaths,b.paths[0]),a.resolve()},function(b){o.errorGetPaths(),a.reject()}),a.promise}function z(){T.inputs.newServer.dirty?o.errorItemNotAdded():p.validateAndSaveDistributions(T.distribution.changedRules,T.defaultServer).then(function(a){o.successSaved(),T.inputs.saved=!0,T.isSaving=!1,T.distribution.displayableRules.splice(0,T.distribution.displayableRules.length),H(),J()},function(a){a.data.message.indexOf("com.comcast.hydra.redirector.data.ExpressionValidationException: ")!==-1?T.responseErrorMsg=a.data.replace("com.comcast.hydra.redirector.data.ExpressionValidationException: ",""):T.responseErrorMsg=a.data.message,o.errorItemNotSaved(),f.error("Failed to save distributions",a.data.message),T.isSaving=!1})}function A(){return T.loading}function B(){var a=0,b=!1;return angular.isDefined(T.distribution.rulesFromDataSource)&&angular.forEach(T.distribution.rulesFromDataSource,function(c,d){angular.isUndefined(c.percent)&&(b=!0),a+=angular.isUndefined(c.percent)?0:c.percent}),T.inputs.isValidCurrentTotalPercentage=parseFloat(a)<T.MAX_TOTAL_Percentage,T.inputs.isSomeCurrentPercentOutOfRange=b,parseFloat(a)||0}function C(){var a=0,b=!1;return angular.isDefined(T.distribution.changedRules)&&angular.forEach(T.distribution.changedRules,function(c,d){c.hasChanges&&c.changeType===j.PENDING_CHANGE_TYPE.DELETE||(angular.isUndefined(c.percent)&&(b=!0),a+=angular.isUndefined(c.percent)?0:c.percent)}),T.inputs.isValidTotalPercentage=parseFloat(a)<T.MAX_TOTAL_Percentage,T.inputs.isSomeChangedPercentOutOfRange=b,parseFloat(a)||0}function D(a){t(T.distribution.displayableRules[a])}function E(){var a={id:F(),percent:1,server:{},hasChanges:!0,changeType:j.PENDING_CHANGE_TYPE.ADD},b=e.open({templateUrl:"../uxData/scripts/distribution/distribution-edit.html",controller:"DistributionEdit as vm",windowClass:"edit-distribution-modal-window",resolve:{distributionObject:function(){return T.distribution},rule:function(){return{rule:a}},editMode:function(){return"add"},paths:function(){return T.returnOnlyNonSelectedPaths()}}});b.result.then(function(a){T.inputs.saved=!1;var b=a.rule;T.distribution.displayableRules.push(b),T.distribution.changedRules.push(b),T.inputs.percent_new=1,T.inputs.newServer=angular.copy({}),I()},function(){I()})}function F(){var a=0;return angular.forEach(T.distribution.rulesFromDataSource,function(b,c){a=Math.max(a,b.id)}),angular.forEach(T.distribution.changedRules,function(b,c){a=Math.max(a,b.id)}),T.distribution.rulesFromDataSource.length<1&&T.distribution.changedRules.length<1?0:a+1}function G(a){T.inputs.saved=!1;var b=S(T.distribution.changedRules,T.distribution.displayableRules[a].id);angular.isDefined(b.index)&&(T.distribution.displayableRules[a]=T.distribution.changedRules[b.index],u(a));var c=e.open({templateUrl:"../uxData/scripts/distribution/distribution-edit.html",controller:"DistributionEdit as vm",windowClass:"edit-distribution-modal-window",resolve:{distributionObject:function(){return T.distribution},rule:function(){return b},editMode:function(){return"edit"},paths:function(){return T.returnOnlyNonSelectedPaths(b.rule.server.path)}}});c.result.then(function(b){b&&t(T.distribution.displayableRules[a])},function(){})}function H(){T.distribution.displayableRules.splice(0,T.distribution.displayableRules.length),T.distribution.rulesFromDataSource.splice(0,T.distribution.rulesFromDataSource.length),T.distribution.changedRules.splice(0,T.distribution.changedRules.length),T.inputs.percent_new=1,T.loading=!0,T.isSaving=!1,T.servicePaths=angular.copy({}),T.inputs.newServer=angular.copy({}),T.inputs.newServer.generalErrorMsg="",T.inputs.newServer.isValid=!1,T.inputs.newServer.dirty=!1,T.changes=angular.copy({}),T.inputs.saved=!0,T.inputs.isValidCurrentTotalPercentage=!0,T.inputs.isValidTotalPercentage=!0,T.responseErrorMsg="",T.inputs.isSomeCurrentPercentOutOfRange=!1,T.inputs.isSomeChangedPercentOutOfRange=!1}function I(){T.returnOnlyNonSelectedPathsForDefault(),T.allowAddDistributions=0!==T.returnOnlyNonSelectedPaths().flavor.length}function J(){y().then(function(){r(b.currentApplication).then(function(){I()},function(a){})})}function K(a){T.toDeleteItemId=a;var b=f.confirm("Delete confirmation","Are you sure you want to delete distribution: "+T.toDeleteItemId);b.result.then(function(a){L(T.toDeleteItemId),M(T.distribution.displayableRules[T.toDeleteItemId].id),angular.isDefined(S(T.distribution.rulesFromDataSource,T.toDeleteItemId).index)?(T.distribution.displayableRules[T.toDeleteItemId].hasChanges=!0,T.distribution.displayableRules[T.toDeleteItemId].changeType=j.PENDING_CHANGE_TYPE.DELETE):T.distribution.displayableRules.splice(T.toDeleteItemId,1),o.infoWillBeDeleted(),I(),T.inputs.saved=!1,T.isSaving=!1})}function L(a){}function M(a){var b=S(T.distribution.changedRules,a);angular.isDefined(b.index)&&T.distribution.changedRules.splice(b.index,1)}function N(){return!angular.equals(T.distribution.rulesFromDataSource,T.distribution.changedRules)}function O(a){return a&&a.hasChanges&&a.changeType===j.PENDING_CHANGE_TYPE.DELETE}function P(a){return a&&a.hasChanges&&a.changeType===j.PENDING_CHANGE_TYPE.ADD}function Q(a){var b=S(T.distribution.changedRules,a.id),c=S(T.distribution.rulesFromDataSource,a.id);return b.rule&&c.rule&&!P(b.rule)&&!O(T.distribution.displayableRules[c.index])&&!angular.equals(b.rule,c.rule)}function R(a){var b;return P(a)?b=j.PENDING_CHANGE_TYPE.ADD:O(a)?b=j.PENDING_CHANGE_TYPE.DELETE:Q(a)&&(b=j.PENDING_CHANGE_TYPE.UPDATE),b}function S(a,b){var c={};if(angular.isDefined(a)&&null!==a)for(var d=0;d<a.length;d++)if(null!==a[d]&&angular.equals(a[d].id,b)){c={rule:a[d],index:d};break}return c}var T=this;T.inputs={newServer:{generalErrorMsg:"",isValid:!1,dirty:!1},percent_new:1,saved:!0,isValidCurrentTotalPercentage:!0,isValidTotalPercentage:!0,isSomeCurrentPercentOutOfRange:!1,isSomeChangedPercentOutOfRange:!1},T.distribution={displayableRules:[],rulesFromDataSource:[],changedRules:[]},T.loading=!0,T.isSaving=!1,T.servicePaths={},T.allowAddDistributions=!0,T.changes={},T.authService=k,T.USER_PERMISSIONS=l;var U=j.HOST;T.responseErrorMsg="",T.MAX_TOTAL_Percentage=p.MAX_TOTAL_Percentage,T.addItem=E,T.saveDistributions=z,T.hasDiffChanges=N,T.calculateAndGetCurrentTotalPercentage=B,T.calculateAndGetTotalPercentage=C,T.isRuleUpdated=Q,T.getChangeType=R,T.onPercentageChanged=D,T.onServerChanged=u,T.editDistribution=G,T.deleteDistribution=K,T.isLoaded=A,T.exportDistributions=n.exportDistributions,T.returnOnlyNonSelectedPaths=v,T.returnOnlyActivePaths=w,T.defaultServer={},J(),g.onChangeApp(angular.extend(a,T),function(a){H(),J()})}angular.module("uxData.distribution").controller("DistributionController",a),a.$inject=["$scope","$rootScope","$log","$q","$modal","dialogs","messageService","requestsService","utilsService","constantsProvider","authService","USER_PERMISSIONS","LOCALSTORAGE_PAGE_NAMES","distributionRequestService","distributionAlertsService","distributionService"]}(),function(){"use strict";angular.module("uxData.expression").directive("expression",function(){return{restrict:"E",replace:!0,scope:{data:"=",expressionType:"@",validationData:"=",onNameChanged:"&",onOperatorChanged:"&",onValueChanged:"&",onValueAdded:"&",onValueRemoved:"&",onValueTypeChanged:"&",onExpressionChanged:"&",onNegationChanged:"&",allowNegation:"="},templateUrl:"../uxData/scripts/expressions/expression.html",controller:"expressionController",controllerAs:"vm"}})}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(){A.expr.isBinary=!1,A.expr.Type="",g.isDefinedAndNotEmpty(a.data.type)&&(A.expr.Type=a.data.type,A.expr.isBinary=angular.equals(a.data.type,e().OR)||angular.equals(a.data.type,e().XOR)),A.expr.disabled=a.data.disabled}function k(){g.isDefinedAndNotEmpty(a.data)&&(l(B),A.expr.isBinary&&l(C))}function l(b){angular.isDefined(a.data)&&!$.isEmptyObject(a.data)&&(A.expr[b].expName=a.data[b].expName,A.expr[b].expValues=angular.copy(a.data[b].expValues),A.expr[b].isMultivalueOperatorSelected=d.isMultivalueOperatorSelected(b,A.expr,A.operators),A.expr[b].expType=a.data[b].expType,A.expr[b].negation=!!angular.isDefined(a.data[b].negation)&&angular.copy(a.data[b].negation),a.data[b].expOperator===f().OPERATOR_TYPE.CONTAINS&&a.data[b].expType!==f().OPERATOR_TYPE.NAMESPACED_LIST?(A.expr[b].expOperator=A.operators[f().OPERATOR_TYPE.CONTAINS_NMSP].value,A.expr[b].expValues=[""]):a.data[b].expType!==f().OPERATOR_TYPE.NAMESPACED_LIST?A.expr[b].expOperator=a.data[b].expOperator:(angular.forEach(A.expr[b].expValues,function(a,c){A.expr[b].expValues[c]={name:a}}),a.data[b].expOperator===f().OPERATOR_TYPE.IN_IP_RANGE||a.data[b].expOperator===f().OPERATOR_TYPE.IN_IP_RANGE_NMSP?A.expr[b].expOperator=A.operators[f().OPERATOR_TYPE.IN_IP_RANGE_NMSP].value:A.expr[b].expOperator=A.operators[f().OPERATOR_TYPE.CONTAINS_NMSP].value,n(b)),A.expr[b].isMultivalueOperatorSelected=d.isMultivalueOperatorSelected(b,A.expr,A.operators),d.isRelationalOperator(a.data[b])&&(A.expr[b].valueType=a.data[b].expType)),x(b)}function m(a){var b=A.expr[a].expOperator;return angular.equals(b,f().OPERATOR_TYPE.IN_IP_RANGE_NMSP)||angular.equals(b,f().OPERATOR_TYPE.CONTAINS_NMSP)||angular.equals(b,f().OPERATOR_TYPE.IN_IP_RANGE)||angular.equals(b,f().OPERATOR_TYPE.CONTAINS)||angular.equals(b,f().OPERATOR_TYPE.MATCHES)||angular.equals(b,f().OPERATOR_TYPE.ISEMPTY)}function n(a){var c=b.defer();return h.getNamespacesFromDS({namespace:[]}).then(function(b){A.namespaces[a]=b.namespace,v(a),c.resolve()},function(b){A.namespaces[a]=[],A.expr[a].expValues=[""],i.errorGet(),c.resolve()}),c.promise}function o(b){var c=A.expr[b];a.onNameChanged({side:b,newName:c.expName,newOperator:c.expOperator,newValues:y(b)?d.getNamespaceNames(c):c.expValues,changedValueIndex:0,newValueType:c.valueType,newNegationValue:m(b)?c.negation:void 0})}function p(b,c){var e=A.expr[b];a.onValueChanged({side:b,newName:e.expName,newOperator:e.expOperator,newValues:y(b)?d.getNamespaceNames(e):e.expValues,changedValueIndex:c,newValueType:e.valueType,newNegationValue:m(b)?e.negation:void 0})}function q(b){var c=A.expr[b];a.onValueTypeChanged({side:b,newName:c.expName,newOperator:c.expOperator,newValues:c.expValues,changedValueIndex:0,newValueType:c.valueType,newNegationValue:m(b)?c.negation:void 0})}function r(b){A.expr[b].expValues=[""],A.expr[b].isMultivalueOperatorSelected=d.isMultivalueOperatorSelected(b,A.expr,A.operators),v(b),d.isValueTypeNamespace(A.expr,b)&&n(b);var c=A.expr[b];d.isOperatorInIpRange(A.expr,b)&&(c.expName=f().DEFAULT_TITLE_NAME.IN_IP_RANGE),a.onOperatorChanged({side:b,newName:c.expName,newOperator:c.expOperator,newValues:[""],changedValueIndex:0,newValueType:c.valueType,newNegationValue:m(b)?c.negation:void 0})}function s(b){var c=A.expr[b];a.onNegationChanged({side:b,newName:c.expName,newOperator:c.expOperator,newValues:y(b)?d.getNamespaceNames(c):c.expValues,changedValueIndex:0,newValueType:c.valueType,newNegationValue:m(b)?c.negation:void 0})}function t(b,c){A.expr[b].expValues.push("");var e=A.expr[b];a.onValueAdded({side:b,newName:e.expName,newOperator:e.expOperator,newValues:y(b)?d.getNamespaceNames(e):e.expValues,changedValueIndex:c,newValueType:e.valueType,newNegationValue:m(b)?e.negation:void 0})}function u(b,c){A.expr[b].expValues.splice(c,1),v(b);var e=A.expr[b];a.onValueRemoved({side:b,newName:e.expName,newOperator:e.expOperator,newValues:y(b)?d.getNamespaceNames(e):e.expValues,changedValueIndex:c,newValueType:e.valueType,newNegationValue:m(b)?e.negation:void 0})}function v(a){var b=d.getOppositeSide(a);(y(a)||y(b))&&(d.updateSelectedNamespaces(a,A.namespaces,A.expr),d.updateSelectedNamespaces(b,A.namespaces,A.expr))}function w(a,b){v(a),A.valueChanged(a,b)}function x(b){var c=A.expr[b],e={side:b,newName:c.expName,newOperator:c.expOperator,newValues:y(b)?d.getNamespaceNames(c):c.expValues,changedValueIndex:0,newValueType:c.valueType,newNegationValue:m(b)?c.negation:void 0};d.isValueTypeNamespace(A.expr,b)&&angular.isDefined(A.namespaces[b])&&!g.isMapEmpty(A.namespaces[b])?n(b).then(function(){angular.forEach(A.namespaces[b],function(a,b){a.name===e.newValues[0]&&(a.alreadySelected=!0)}),a.onExpressionChanged(e)}):a.onExpressionChanged(e)}function y(a){return d.isValueTypeNamespace(A.expr,a)}function z(a){return g.isDefinedAndNotEmpty(a)}var A=this;A.nameChanged=o,A.operatorChanged=r,A.valueChanged=p,A.valueTypeChanged=q,A.negationChanged=s,A.addNewValue=t,A.removeValue=u,A.onNamespaceChanged=w,A.hasError=z,A.isRelationalOperator=d.isRelationalOperator,A.isValueTypeNamespace=y,A.isNegationApplicable=m,A.validationData=a.validationData;var B=e().LEFT,C=e().RIGHT;A.namespaces={},A.namespaces[B]=[],A.namespaces[C]=[],A.expr={},A.expCONST=f(),j(),A.operators=c.buildOperators(a.expressionType),A.valueType=c.buildValueTypes(),A.expr[B]={},A.expr[C]={},A.expr[B].isMultivalueOperatorSelected=d.isMultivalueOperatorSelected(B,A.expr,A.operators),A.expr[C].isMultivalueOperatorSelected=d.isMultivalueOperatorSelected(C,A.expr,A.operators),A.expr[B].negation=!1,A.expr[C].negation=!1,k()}angular.module("uxData.expression").controller("expressionController",a),a.$inject=["$scope","$q","expressionBuilderService","expressionService","RULES_CONSTANTS","EXPRESSION_CONSTANTS","utilsService","namespacedService","namespacedAlertsService"]}(),function(){"use strict";function a(){return{restrict:"E",scope:{onChange:"=",limit:"="},link:function(a,b){var c=b.find("input")[1];c.onchange=function(d){a.onChange((d.srcElement||d.target).files[0]),b.find("input")[0].value=c.value}},templateUrl:"../uxData/scripts/file-select/file-select.directive.html"}}angular.module("uxData").directive("fileSelect",a)}(),angular.module("uxData").filter("findObjectByFirstOrderPropertyOrPath",function(){return function(a,b,c){var d="path";if(angular.isUndefined(c)||null===c||""===c)return a;var e=[];angular.forEach(a,function(a){e.push(a)});var f=[],g=b===d;return g?angular.forEach(e,function(a){for(var b=0;b<a.path.length;b++){if(a.path[b].value.toLowerCase()=="".toLowerCase()&&a.url.toLowerCase().indexOf(c.toLowerCase())>-1){f.push(a);break}if(a.path[b].value.toLowerCase().indexOf(c.toLowerCase())>-1){f.push(a);break}}}):angular.forEach(e,function(a){a[b].toLowerCase().indexOf(c.toLowerCase())>-1&&f.push(a)}),f}}),angular.module("uxData").filter("hostnameAndIP",["utilsService",function(a){return function(b){return a.formatHostNameAndIP(b,"{HOSTNAME} ({IP})",{host:"Unknown host",ip:"Unknown IP"})}}]),angular.module("uxData").filter("orderRuleObjectBy",function(){return function(a,b,c){var d=[];angular.forEach(a,function(a){d.push(a)});var e="path"===b;return e?d.sort(function(a,b){return a.path[0].value.toUpperCase()>b.path[0].value.toUpperCase()?1:-1}):d.sort(function(a,c){return a[b].toUpperCase()>c[b].toUpperCase()?1:-1}),c&&d.reverse(),d}}),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l){function m(){n()}function n(){p.tableParams=new j({page:1,count:q,sorting:{active:"asc"}},{total:0,getData:function(a,c){k.getAllExistingApplications().then(function(d){p.models=d.modelStates;var e=c.sorting()?b("orderBy")(p.models,c.orderBy()):p.models;e=c.filter()?b("filter")(e,c.filter()):e,c.total(e.length);var f=Math.max(1,Math.ceil(c.total()/c.count()));c.page()>f&&c.page(f),c.settings({counts:p.models.length>q?[10,25,50]:[]}),e=e.slice((c.page()-1)*c.count(),c.page()*c.count()),a.resolve(e)},function(){})}}),p.tableParams.settings().$scope=a}function o(a){k.validateApplication(a).then(function(b){"true"==b?k.defaultModelConstructionDetails(a).then(function(b){var c=b.defaultRouteComposition,d=b.defaultUrlPartsComposition,e=b.firstAvailableWhitelisted,f=b.urlForRedirection,g=h.confirm("Create new redirection rule","Are you sure you want to create new redirection rule?<br/> <span> Connection will be redirected to "+f+"</span><br/><br/>The redirection rule will be created with next parameters:<br/><ol><li> Default Distribution Route: "+c+"</li><li> Default UrlParts: "+d+"</li><li> Default Whitelisted: "+e+"</li></ol>");g.result.then(function(b){k.createDefaultModel(a).then(function(b){i.success('The application: "'+a+'" is enabled',"Success",{closeButton:!0,timeOut:3e3}),p.tableParams.reload()},function(a){i.error(a.message.message,"Error",{closeButton:!0,timeOut:6e3})})})}):(p.tableParams.reload(),i.warning("Could not create the new Redirection rule. Try to do it manually","Warning",{closeButton:!0,timeOut:6e3}))},function(a){i.error(reason.message.message,"Error",{closeButton:!0,timeOut:6e3})})}var p=this;p.models=[],p.authService=e,p.USER_PERMISSIONS=f,p.createDefaultModel=o;const q=10;p.jumpOnNewApplication=function(a){g.changeApp(a),d.currentApplication=a,c.go(l().showFlavorRules)},m()}angular.module("uxData.modelInitializer").controller("modelInitializerController",a),a.$inject=["$scope","$filter","$state","$rootScope","authService","USER_PERMISSIONS","messageService","dialogs","toastr","ngTableParams","modelInitializerService","STATES_CONSTANTS"]}(),function(){"use strict"}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(b){f.openFile(b,null,this).then(function(a){k(a)},function(b){a.error("Reason: "+b.message),n.title=o,e.errorGetFile()})}function k(b){try{if(angular.equals(b.trim(),""))return void(n.title="File is empty, please select another one");var c=JSON.parse(b);if(""==c||!angular.isDefined(c.entities))throw{message:"JSON is invalid"};n.entitiesFromFile=c.entities,n.title=p,n.canOpenFile=!1}catch(d){try{n.entitiesFromFile=[];var f=b.match(/[^\r\n]+/g);""!==f&&angular.forEach(f,function(a,b){angular.equals(a.trim(),"")||n.entitiesFromFile.push(a)}),n.title=p,n.canOpenFile=!1}catch(g){a.error("Reason: "+d.message),n.title=o,e.errorParse()}}}function l(){a.info("Attempting to delete bulk of namespaced entities from file"),i.bulkDeleteNamespacedValues(n.namespacedName,n.entitiesFromFile).then(function(b){a.info("Deletion succeeded, following entities were not found ",b),n.notFoundEntities=b.entities,0==b.deletedValues.length?(n.title="Deletion is unsuccessful",n.subTitle="(no entries were deleted)"):n.title="Deletion is succeeded",n.canDelete=!1},function(b){a.error("Error while deleting bulk of namespaces from file ",b),n.title="Deletion was in error"})}function m(){g.close(!0)}var n=this;angular.extend(n,{namespacedName:h}),n.authService=b,n.USER_PERMISSIONS=c,n.canDelete=!0,n.canOpenFile=!0,n.title="Choose a file with entities description",n.entitiesFromFile=[],n.notFoundEntities=[],n.getFile=j,n.deleteEntities=l,n.close=m;var o="Something is wrong with file formatting",p='Delete entities by clicking "Delete" button'}angular.module("uxData.namespaced").controller("NamespacedDeleteEntities",a),a.$inject=["$log","authService","USER_PERMISSIONS","namespacedService","namespacedAlertsService","importService","$modalInstance","namespacedName","requestsService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a){n.openFile(a,null,this).then(function(a){p(B.name,a)},function(a){b.error("Reason: "+a),m.errorGetFile()})}function p(a,b){var c=b.match(/[^\r\n]+/g);if(""!==c){for(var d=0;d<c.length;d++)angular.equals(c[d].trim(),"")||u(a,c[d]);r(),B.tableParams.reload()}}function q(){B.tableParams=new g({page:B.tableParamsHolder.pageNo,count:B.tableParamsHolder.paramsCount,sorting:{name:"asc"}},{total:0,getData:function(a,b){var c=b.sorting()?e("orderBy")(B.dataForTable,b.orderBy()):B.dataForTable;c=b.filter()?e("filter")(c,b.filter()):c,b.total(c.length);var d=Math.max(1,Math.ceil(b.total()/b.count()));b.page()>d&&b.page(d),c=c.slice((b.page()-1)*b.count(),b.page()*b.count()),a.resolve(c)}}),a.$on("ngTableAfterReloadData",function(){B.tableParamsHolder.paramsCount=B.tableParams.$params.count,B.tableParamsHolder.pageNo=B.tableParams.$params.page}),B.tableParams.settings().$scope=a}function r(){if(B.dataForTable=[],angular.isDefined(B.namespace))for(var a=0;a<B.namespace.valueSet.length;a++)"ENCODED"==B.namespace.type?B.dataForTable.push({value:B.namespace.valueSet[a].value,encodedValue:B.namespace.valueSet[a].encodedValue}):B.dataForTable.push({value:B.namespace.valueSet[a].value,encodedValue:"list is not encoded"})}function s(){l.getNamespaceFromDS(B.name).then(function(a){B.namespace=a,b.info("Success: received "+a.namespace.name+" namespaced list"),void 0==B.namespace.type&&(B.namespace.type="TEXT"),r(),angular.isDefined(B.tableParams)?B.tableParams.reload():q()},function(a){200===a.status?b.warn("Warn: "+a.message):(b.error("Failed: "+a.message),404!==a.status&&m.errorGet())})}function t(a,c){l.addItem(B.namespace,a,c).then(function(a){B.uiModelHolder.value="",b.info("Added new value: "+c),r(),B.tableParams.reload()},function(a){b.error("Failed: "+a.message),m.duplicate(c)})}function u(a,b){l.addItem(B.namespace,a,b)}function v(a,c){var d=l.delItem(B.namespace,a,c);d.then(function(a){angular.extend(B.namespace,a),b.info("Deleted value: "+c),r(),B.tableParams.reload()},function(a){b.error("Failed: "+a.message.data),m.errorDelete(c)})}function w(a){return!(!angular.isUndefined(a)&&""!==a)||l.getValuePosition(B.namespace.valueSet,{value:a,encodedValue:a})}function x(a){l.validateAndSave(a,a.name,B.isAddState).then(function(){m.success(a.name),b.info('Saved namespace: "'+a.name+'"'),angular.isDefined(c.previousState)&&c.previousState.name===h().namespacesSearch?c.go(c.previousState.name,c.previousParams):c.go(h().namespacesShow)},function(a){b.error(a.message),m.errorPostWithMessage(a.message?a.message:a.data.message)})}function y(a,b){B.namespaceCandidates=a,B.namespacedDuplicateMap=angular.copy(b.data);var d=f.open({templateUrl:"../uxData/scripts/namespaced/namespaced-modal.html",controller:"NamespacedMerger as vm",resolve:{namespaceCandidates:function(){return angular.copy(B.namespaceCandidates)},namespacedDuplicateMap:function(){return angular.copy(B.namespacedDuplicateMap)},isImporting:function(){return!1}}});d.result.then(function(a){angular.isDefined(c.previousState)&&c.previousState.name===h().namespacesSearch?c.go(c.previousState.name,c.previousParams):c.go(h().namespacesShow)},function(){})}function z(){B.namespacedDuplicateObject={},l.validateDuplicates(B.namespace).then(function(a){x(B.namespace)},function(a){b.warn(a.message),angular.isUndefined(a.data)||0==a.data.length?m.errorPostWithMessage(a.message):y(B.namespace,a)})}function A(){var a=d.id;if(B.name=d.id,"new"===a||angular.isUndefined(a)){B.isAddState=!0;var b="TEXT";angular.isDefined(d.type)&&(b=d.type),B.namespace={valueSet:[],description:"",name:"",version:Math.round((new Date).getTime()),type:b},r(),angular.isDefined(B.tableParams)?B.tableParams.reload():q(),B.name=B.namespace.name}else B.name=a,B.isAddState=!1,s()}var B=this;B.authService=i,B.USER_PERMISSIONS=j,B.isAddState=!1,B.uiModelHolder={value:""},B.name="",B.namespace={};B.addValue=t,B.delValue=v,B.saveNamespace=z,B.isValueUnique=w,B.getFile=o,B.tableParamsHolder={paramsCount:10,pageNo:1},A()}angular.module("uxData.namespaced").controller("NamespacedDetail",a),a.$inject=["$scope","$log","$state","$stateParams","$filter","$modal","ngTableParams","STATES_CONSTANTS","authService","USER_PERMISSIONS","LOCALSTORAGE_PAGE_NAMES","namespacedService","namespacedAlertsService","importService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(b){g.openFile(b,null,this).then(function(a){j(a)},function(b){a.error("Reason: "+b.message),f.errorGetFile()})}function j(b){try{var c=JSON.parse(b);""!==c&&(o.namespacesFromFile=c),k(o.namespacesFromFile),o.title='Save the namespaced lists by clicking "Save" button'}catch(d){a.error("Reason: "+d.message),f.errorParse()}}function k(a){angular.isArray(a.namespace)||(a.namespace=[a.namespace]),angular.forEach(a.namespace,function(b,c){angular.isDefined(a.namespace[c].value)?(angular.isArray(a.namespace[c].value)||(a.namespace[c].value=[a.namespace[c].value]),angular.forEach(a.namespace[c].value,function(b,d){angular.isObject(b)||(a.namespace[c].value[d]={value:b})}),a.namespace[c].type="TEXT",a.namespace[c].valueSet=[],angular.forEach(a.namespace[c].value,function(b){a.namespace[c].valueSet.push(b)})):angular.isArray(a.namespace[c].valueSet)||angular.isDefined(a.namespace[c].valueSet)&&(a.namespace[c].valueSet=[a.namespace[c].valueSet])})}function l(){if(0===o.namespacesFromFile.namespace.length)return void(o.namespaceImportAll=!1);o.namespaceImportAll=!0;for(var a=0;a<o.namespacesFromFile.namespace.length;a++)m(o.namespacesFromFile.namespace[a],o.namespacesFromFile.namespace[a].name)}function m(c,d){o.isImportInProgress=!0,o.namespacedDuplicateObject={},o.progress=20,o.autoResolveText&&"TEXT"==c.type?n(c,d,o.autoResolveText):b(function(){e.validateDuplicates(c).then(function(a){var b=c.name;o.progress=60,n(c,b),o.progress=90},function(b){o.progress=60,a.warn(b.message),o.namespaceCandidates=c,o.namespacedDuplicateMap=angular.copy(b.data);var d=h.open({templateUrl:"../uxData/scripts/namespaced/namespaced-modal.html",controller:"NamespacedMerger as vm",resolve:{namespaceCandidates:function(){return o.namespaceCandidates},namespacedDuplicateMap:function(){return o.namespacedDuplicateMap},namespacesFromFile:function(){return o.namespacesFromFile},isImporting:function(){return!0}}});d.result.then(function(a){var b=e.findPostionOfNamespaceByName(c.name,o.namespacesFromFile.namespace);o.namespacesFromFile.namespace.splice(b,1),o.isImportInProgress=!1})},1e3)})}function n(b,c,d){angular.isUndefined(d)&&(d=!1),e.validateAndSave(b,c,!0,d).then(function(){a.info('Added namespace: "'+c+'"'),f.success(c),o.namespaceCandidates={};var d=e.findPostionOfNamespaceByName(b.name,o.namespacesFromFile.namespace);o.namespacesFromFile.namespace.splice(d,1),o.isImportInProgress=!1},function(b){a.error("Failed: "+b.message),f.errorPostWithMessage(b.message),o.isImportInProgress=!1})}var o=this;o.autoResolveText=!1,o.authService=c,o.USER_PERMISSIONS=d,o.title="Choose a file with namespaces description",o.savedStatus=!0,o.namespaceImportAll=!1,o.namespacedDuplicateMap={},o.namespacesFromFile={},o.namespaceCandidates={},o.importAllNamespaces=l,o.importNamespace=m,o.getFile=i}angular.module("uxData.namespaced").controller("NamespacedImport",a),a.$inject=["$log","$timeout","authService","USER_PERMISSIONS","namespacedService","namespacedAlertsService","importService","$modal"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(){angular.isUndefined(D.sessionStorage.namespacedListFilter)?D.sessionStorage.namespacedListFilter=D.showNamespaced:D.showNamespaced=D.sessionStorage.namespacedListFilter,t()}function t(){D.tableParams=new j({page:1,count:10,sorting:{name:"asc"}},{total:0,getData:function(a,b){u().then(function(c){D.namespaces.namespace=c;var d=b.sorting()?f("orderBy")(c,b.orderBy()):c;d=b.filter()?f("filter")(d,b.filter()):d,b.total(d.length);var e=Math.max(1,Math.ceil(b.total()/b.count()));b.page()>e&&b.page(e),d=d.slice((b.page()-1)*b.count(),b.page()*b.count()),a.resolve(d),v(d,D.batchSizeToGetDependingRules)},function(){})}}),D.tableParams.settings().$scope=b}function u(){var a=e.defer();return n.getNamespacesFromDS(D.namespaces).then(function(b){c.info("Success: NamespaceDS provide "+b.namespace.length+" item(s)",b);for(var d=[],e=0;e<b.namespace.length;e++)D.showNamespaced[b.namespace[e].type]&&d.push({name:b.namespace[e].name,description:b.namespace[e].description,valueCount:r?b.namespace[e].valueSet.length:b.namespace[e].valueCount,hiddenFromUI:!1});a.resolve(d)},function(b){200===b.status?c.warn("Warn: "+b.message):(c.error("Failed: "+b.message),404!==b.status&&o.errorGet()),a.reject()}),a.promise}function v(a,b){c.info("Attempting to get all depending rules");for(var d=[],e=0;e<a.length;e++)d.push(a[e].name);w(d,b)}function w(a,b){if(angular.isDefined(a)&&angular.isArray(a)&&angular.isDefined(a[0])){var d=a.slice(0,b);q.getMultipleRulesDependingOnNamespaced(d).then(function(d){c.info("Depending rules received successfully",d);for(var e=0;e<d.namespacedLists.length;e++){var f=n.getNamespaceByName(d.namespacedLists[e].name,D.tableParams.data);if(angular.isDefined(f)){var g=n.getNamespaceByName(d.namespacedLists[e].name,d.namespacedLists);f.dependingRules=g.dependingFlavorRules,f.dependingTemplateRules=g.dependingTemplateFlavorRules}}a.splice(0,b),w(a,b)},function(d){a.splice(0,b),c.error("Error while getting namespaced",d),w(a,b)})}}function x(){n.exportAll().then(function(){c.info("Success export all ("+D.namespaces.namespace.length+") namespaces")},function(a){c.error("Failed: "+a)})}function y(a){d.go(m().namespacesEdit,{id:a})}function z(a){var b=i.confirm("Delete confirmation","Are you sure you want to Delete namespaced list: "+a);b.result.then(function(b){var d=D.tableParams.data[n.findPostionOfNamespaceByName(a,D.tableParams.data)];d.hiddenFromUI=!0,o.willTryDelete(a),n.deleteNamespace(D.namespaces,a).then(function(b){o.successDelete(a),c.warn("Deleted namespace item: "+a),D.tableParams.reload()},function(b){c.error("Failed: "+b.data),d.hiddenFromUI=!1,403!=b.status&&i.notify("Failed to delete namespaced list: "+a,b.data.message),D.isSaving=!1},function(a){})})}function A(a){n.exportNamespace(D.namespaces,a).then(function(){c.info('Success export namespace "'+a+'"')},function(a){c.error("Failed: "+a)})}function B(b){d.go(m().namespacesSearch,{serviceName:a.currentApplication,search:b})}function C(a){console.log(a),g.open({templateUrl:"../uxData/scripts/namespaced/namespaced-delete-entities.modal.html",controller:"NamespacedDeleteEntities as vm",resolve:{namespacedName:function(){return a}},size:"lg"})}var D=this;D.sessionStorage=h,D.redirectorOfflineMode=r,D.authService=k,D.USER_PERMISSIONS=l,D.namespaces={},D.namespaces.namespace=[],D.exportAll=x,D.edit=y,D["delete"]=z,D["export"]=A,D.findRules=B,D.deleteEntities=C,D.batchSizeToGetDependingRules=10,D.goToFlavorRulePage=n.goToFlavorRulePage,D.goToTemplateFlavorRulePage=n.goToTemplateFlavorRulePage,D.showNamespaced={IP:!0,ENCODED:!0,TEXT:!0},s(),b.$watch("vm.showNamespaced",function(){D.tableParams.reload()},!0)}angular.module("uxData.namespaced").controller("NamespacedList",a),a.$inject=["$rootScope","$scope","$log","$state","$q","$filter","$modal","$sessionStorage","dialogs","ngTableParams","authService","USER_PERMISSIONS","STATES_CONSTANTS","namespacedService","namespacedAlertsService","COMMON_CONSTANTS","requestsService","redirectorOfflineMode"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(b,c){var e=o(b,q);e>=0?q[e].valuesToDelete.push(c):q.push({name:b,valuesToDelete:[c]});var e=d.getIndexOfDuplicateItemFromMapByKey(p.namespacedDuplicateMap,c);p.namespacedDuplicateMap.splice(e,1),p.duplicateMapEmpty=0===p.namespacedDuplicateMap.length,a.info('Pending to delete item "'+c+'" from existent namespaced list: '+b)}function j(c){var f=b.defer();return c.length>0?d.deleteEntitiesFromNamespacedLists(c).then(function(b){a.info("Deleted :",c),f.resolve()},function(b){a.error("Failed: "+b.data.message),e.errorDelete(),f.reject()}):f.resolve(),f.promise}function k(b,c){p.namespaceCandidates.valueSet.splice(d.getValuePosition(p.namespaceCandidates.valueSet,angular.isObject(c)?c:m(p.namespaceCandidates.type,c)),1);var e=d.getIndexOfDuplicateItemFromMapByKey(p.namespacedDuplicateMap,c);null!==e?(p.namespacedDuplicateMap.splice(e,1),p.duplicateMapEmpty=0===p.namespacedDuplicateMap.length,
a.info('Deleted item "'+c+"\" from imported namespaced list ('"+b+"')")):a.error("Can't find item: \""+c+'", aborted!')}function l(){j(q).then(function(){n().then(function(){c.close()})},function(){})}function m(a,b){return{value:b}}function n(){var c=b.defer();if(!(angular.isUndefined(p.namespaceCandidates)||p.namespacedDuplicateMap.length>0)){angular.isDefined(p.namespaceCandidates.value)&&0===p.namespaceCandidates.value.length&&delete p.namespaceCandidates.value;var f=p.namespaceCandidates.name;return d.validateAndSave(p.namespaceCandidates,f,h).then(function(){a.info('Added namespaced list: "'+f+'"'),e.success(),p.namespaceCandidates={},c.resolve()},function(b){a.error("Failed: "+b.message),e.errorPostWithMessage(b.message),c.reject()}),c.promise}}function o(a,b){for(var c=0;c<b.length;c++)if(angular.equals(a,b[c].name))return c;return-1}var p=this;angular.extend(p,{namespaceCandidates:f}),angular.extend(p,{namespacedDuplicateMap:g}),angular.extend(p,{isImporting:h}),p.delFromExistent=i,p.delFromCandidate=k,p.continueFromDuplicatesModal=l,p.duplicateMapEmpty=0===p.namespacedDuplicateMap.length;var q=[]}angular.module("uxData.namespaced").controller("NamespacedMerger",a),a.$inject=["$log","$q","$modalInstance","namespacedService","namespacedAlertsService","namespaceCandidates","namespacedDuplicateMap","isImporting"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){d.go(h().namespacesSearch,{serviceName:a.currentApplication,search:F.search},{reload:!0})}function p(b,c){a.currentApplication!==i().APPLICATIONS.DECIDER?u(c,"showFlavorRules",{ruleName:b}):v(c,w(c,b,j().RULES_HASH_PATH.PATH_RULES_SHOW))}function q(b,c){a.currentApplication!==i().APPLICATIONS.DECIDER?u(c,"templates",{name:j().TEMPLATES_TYPE.PATH,ruleName:b}):v(c,w(c,b,j().RULES_HASH_PATH.TEMPLATE_PATH_RULES_SHOW))}function r(b,c){a.currentApplication!==i().APPLICATIONS.DECIDER?u(c,"showURLRules",{ruleName:b}):v(c,w(c,b,j().RULES_HASH_PATH.URL_RULES_SHOW))}function s(b,c){a.currentApplication!==i().APPLICATIONS.DECIDER?u(c,"templates",{name:j().TEMPLATES_TYPE.URL,ruleName:b}):v(c,w(c,b,j().RULES_HASH_PATH.TEMPLATE_URL_RULES_SHOW))}function t(b,c){a.currentApplication===i().APPLICATIONS.DECIDER?u(c,"showDeciderRules",{ruleName:b}):v(c,w(c,b,j().RULES_HASH_PATH.DECIDER_RULES_SHOW))}function u(a,b,c){k.isAppAccessible(a)?(y(a,!1),d.go(b,c)):g.error("You don't have permissions for application: "+a,"Error",{closeButton:!0,timeOut:5e3})}function v(a,b){k.isAppAccessible(a)?(y(a,!1),f.location.href=b):g.error("You don't have permissions for application: "+a,"Error",{closeButton:!0,timeOut:5e3})}function w(a,b,c){var d=x()?a!==i().APPLICATIONS.DECIDER?i().DEVELOP_PATH.REDIRECTOR:i().DEVELOP_PATH.DECIDER:a!==i().APPLICATIONS.DECIDER?i().PROD_PATH.REDIRECTOR:i().PROD_PATH.DECIDER;return m.getBaseUrl()+"/"+d+"/"+c+b+"#"+b}function x(){var a=[];return a.push("/"+i().DEVELOP_PATH.REDIRECTOR+"/"),a.push("/"+i().DEVELOP_PATH.DECIDER+"/"),a.indexOf(f.location.href.replace(f.location.hash,"").replace(m.getBaseUrl(),""))>0}function y(b,c){F.changeServiceNameInUrlOnAppChanged=c,angular.isDefined(b)&&a.currentApplication!==b&&b!==i().APPLICATIONS.DECIDER&&l.changeApp(b)}function z(a){d.go(h().namespacesEdit,{id:a})}function A(a){m.searchNamespaces(a).then(function(a){F.searchResult=a},function(a){c.error("Reason: "+a.data.message),n.errorSearch(a.data.message)})}function B(){return!F.isSearching&&angular.isDefined(e.search)&&angular.isDefined(F.searchResult.namespacedLists)&&F.searchResult.namespacedLists.length>0}function C(){return!F.isSearching&&!angular.isDefined(e.search)}function D(){return!F.isSearching&&angular.isDefined(e.search)&&angular.isDefined(F.searchResult.namespacedLists)&&0===F.searchResult.namespacedLists.length}function E(){angular.isDefined(e.serviceName)&&y(e.serviceName,!0),F.search=angular.isDefined(e.search)?angular.copy(e.search):"",0!==F.search.length&&A(F.search)}var F=this;F.search=null,F.searchResult={},F.isSearching=!1,F.changeServiceNameInUrlOnAppChanged=!0,F.goToSearchPage=o,F.isSearchResultExists=B,F.goToEditPage=z,F.goToFlavorRulePage=p,F.goToTemplateFlavorRulePage=q,F.goToUrlRulePage=r,F.goToTemplateUrlRulePage=s,F.goToDeciderRulePage=t,F.isSearchResultsEmpty=D,F.isSearchDataBlank=C,F.searchNamespacesByItem=A,E(),l.onChangeApp(b,function(a){F.changeServiceNameInUrlOnAppChanged&&o()})}angular.module("uxData.namespaced").controller("NamespacedSearcher",a),a.$inject=["$rootScope","$scope","$log","$state","$stateParams","$window","toastr","STATES_CONSTANTS","COMMON_CONSTANTS","RULES_CONSTANTS","authService","messageService","namespacedService","namespacedAlertsService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){v.tableParams=new f({page:1,count:10,sorting:{propertyId:"asc"}},{total:0,getData:function(a,b){var c=b.sorting()?d("orderBy")(p(b.data),b.orderBy()):p(b.data);c=b.filter()?d("filter")(c,b.filter()):c,b.total(c.length);var e=Math.max(1,Math.ceil(b.total()/b.count()));b.page()>e&&b.page(e),c=c.slice((b.page()-1)*b.count(),b.page()*b.count()),a.resolve(c)}}),v.tableParams.settings().$scope=a}function p(a){if(angular.isDefined(a)&&a.length>0&&a.length===v.properties.length)return a;var b=[];return angular.forEach(v.properties,function(a,c){b.push({propertyId:c,propertyValue:a})}),b}function q(){return v.properties[this.propertyName]?void e.error("This property exists already","Error",{closeButton:!0,timeOut:3e3}):(v.properties[v.propertyName]=v.propertyValue,v.propertyName="",v.propertyValue="",void v.tableParams.reload())}function r(a){delete v.properties[a],v.tableParams.reload()}function s(){return j.isEmptyObject(v.properties)}function t(){if(u(v.partnerName)){var a=angular.copy(v.properties);a.id=v.partnerName,i.savePartner(a).then(function(d){e.success('Saved partner item: "'+a.id+'"',"Success",{closeButton:!0,timeOut:3e3}),c.info("Success: Saved partner: "+a.id),b.close(!0)},function(a){e.error("Can't save partner: "+a.message,"Error",{closeButton:!0,timeOut:3e3}),c.error("Failed: "+a.message)})}}function u(a){return v.editMode||$.inArray(a,w())===-1?!s()||(e.error("Validation error: partner must contain at least one property","Error",{closeButton:!0,timeOut:3e3}),!1):(e.error("This partner name exists already","Error",{closeButton:!0,timeOut:3e3}),!1)}var v=this;v.authService=g,v.USER_PERMISSIONS=h,angular.extend(v,{partnerName:l}),angular.extend(v,{properties:n}),angular.extend(v,{editMode:m}),v.title=v.editMode?"Edit partner":"Add new partner",v.propertyName="",v.propertyValue="",v.addProperty=q,v.deleteProperty=r,v.savePartner=t,v.isPropertiesListEmpty=s,o();var w=function(){var a=[];return angular.forEach(k,function(b,c){a.push(b.id)}),a}}angular.module("uxData.partners").controller("PartnersEdit",a),a.$inject=["$scope","$modalInstance","$log","$filter","toastr","ngTableParams","authService","USER_PERMISSIONS","partnersService","utilsService","partners","partnerName","editMode","properties"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l){function m(){v.tableParams=new f({page:1,count:10,sorting:{id:"asc"}},{total:0,getData:function(a,b){var c=b.sorting()?d("orderBy")(n(v.partnersFromFile,b.data),b.orderBy()):n(v.partnersFromFile,b.data);c=b.filter()?d("filter")(c,b.filter()):c,b.total(c.length);var e=Math.max(1,Math.ceil(b.total()/b.count()));b.page()>e&&b.page(e),c=c.slice((b.page()-1)*b.count(),b.page()*b.count()),a.resolve(c)}}),v.tableParams.settings().$scope=a}function n(a,b){if(angular.isDefined(b)&&b.length>0&&b.length===a.length)return b;var c=[];return angular.forEach(a,function(a,b){c.push({id:a.id,properties:i.getPartnerPropertiesAsString(a),propCount:Object.getOwnPropertyNames(a).length-1})}),c}function o(a){k.openFile(a,null,this).then(function(a){p(a)},function(a){c.error("Reason: "+a.message),e.error("Something wrong when convert file","Error",{closeButton:!0,timeOut:3e3})})}function p(a){try{v.importContentForPreview=angular.copy(a);var b=JSON.parse(a);j.isDefinedAndNotEmpty(b)&&j.isDefinedAndNotEmpty(b.partner)&&(v.partnersFromFile=i.getPartnersFromPartnersObject(b),v.title=v.textTitle.SAVE_PROMPT,v.wasImport=!1,v.partnersIdList=t(v.partners),v.tableParams.reload())}catch(d){c.error("Reason: "+d.message),e.error("Can't parse file","Error",{closeButton:!0,timeOut:3e3})}}function q(){if(0!==v.partnersFromFile.length)for(var a=0;a<v.partnersFromFile.length;a++)s(v.partnersFromFile[a])}function r(a){var b=i.findPositionOfPartnerById(v.partnersFromFile,a);s(v.partnersFromFile[b])}function s(a){if(v.namespacedDuplicateObject={},$.inArray(a.id,v.partnersIdList)!==-1)return void e.error("Can't save \""+a.id+'" is already exists',"Error",{closeButton:!0,timeOut:6e3});var b=a;i.savePartner(b).then(function(b){c.info('Added partner: "'+a.id+'"'),e.success("Saved partner item: "+a.id,"Success",{closeButton:!0,timeOut:3e3});var d=i.findPositionOfPartnerById(v.partnersFromFile,a.id);v.partners.push(v.partnersFromFile[d]),v.partnersFromFile.splice(d,1),v.wasImport=!0,v.partnersFromFile.length<1&&(v.title=v.textTitle.CHOOSE_PROMPT),v.tableParams.reload()},function(b){c.error("Failed: "+b.message),e.error("Can't add partner: \""+a.id+'": '+b,"Error",{closeButton:!0,timeOut:3e3})})}function t(a){var b=[];return angular.forEach(a,function(a,c){b.push(a.id)}),b}function u(){b.close(v.wasImport)}var v=this;angular.extend(v,{partners:l}),v.authService=g,v.USER_PERMISSIONS=h,v.textTitle={},v.textTitle.CHOOSE_PROMPT="Choose a file with Partners",v.textTitle.SAVE_PROMPT='Save the partners lists by clicking "Save" button',v.title=v.textTitle.CHOOSE_PROMPT,v.importContentForPreview=null,v.partnersIdList=[],v.partnersFromFile=[],v.importAllPartners=q,v.importPartnerById=r,v.getFile=o,v.closeForm=u,m()}angular.module("uxData.partners").controller("PartnersImport",a),a.$inject=["$scope","$modalInstance","$log","$filter","toastr","ngTableParams","authService","USER_PERMISSIONS","partnersService","utilsService","importService","partners"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){z.needToLoadData=!0,z.tableParams.reload()}function o(){z.tableParams=new i({page:1,count:10,sorting:{id:"asc"}},{total:0,getData:function(a,b){if(z.needToLoadData)r().then(function(c){var d=p(c,b);a.resolve(d)},function(){}),z.needToLoadData=!1;else{var c=p(q(z.partners,b.data),b);a.resolve(c)}}}),z.tableParams.settings().$scope=b}function p(a,b){var c=b.sorting()?f("orderBy")(a,b.orderBy()):a;c=b.filter()?f("filter")(c,b.filter()):c,b.total(c.length);var d=Math.max(1,Math.ceil(b.total()/b.count()));return b.page()>d&&b.page(d),c=c.slice((b.page()-1)*b.count(),b.page()*b.count())}function q(a,b){if(angular.isDefined(b)&&b.length>0&&b.length===z.partners.length)return b;var c=[];return angular.forEach(a,function(a,b){c.push({id:a.id,properties:l.getPartnerPropertiesAsString(a)})}),c}function r(){var a=h.defer();return l.getPartnersFromDS(z.partners).then(function(b){g.info("Success: PartnersDS provided "+b.length+" item(s)");var c=q(b);a.resolve(c)},function(b){return 200===b.status?(g.warn("Warn: "+b.data.message),z.partners=[],a.resolve([]),a.promise):(g.error("Failed: "+b.data.message),404!==b.status&&d.error("Can't retrieve items:"+b.data.message,"Error",{closeButton:!0,timeOut:3e3}),void a.reject())}),a.promise}function s(){u("",{},!1)}function t(a){var b=l.findPositionOfPartnerById(z.partners,a),c={};for(var d in z.partners[b])"id"!==d&&(c[d]=z.partners[b][d]);u(a,c,!0)}function u(a,b,d){var e=c.open({templateUrl:"../uxData/scripts/partners/partners-edit.html",controller:"PartnersEdit as vm",windowClass:"edit-partners-modal-window",resolve:{partners:function(){return z.partners},partnerName:function(){return a},properties:function(){return b},editMode:function(){return d}}});e.result.then(function(a){a?n():z.tableParams.reload()},function(){})}function v(a){var b=e.confirm("Delete confirmation","Are you sure you want to Delete partner "+a+"?");b.result.then(function(b){l.deletePartner(a).then(function(b){d.success("Deleted partner item: "+a,"Success",{closeButton:!0,timeOut:3e3}),g.warn("Deleted partner item: "+a),n()},function(b){g.error("Failed: "+b.message),e.notify('Failed to delete partner item:  "'+a+'"',b.message)},function(a){})})}function w(){l.exportAllPartners().then(function(){g.info("Success export all ("+z.partners.length+") partners")},function(a){g.error("Failed: "+a)})}function x(a){l.exportPartner(a).then(function(){g.info('Success export partner: "'+a+'"')},function(a){g.error("Failed: "+a)})}function y(){var a=c.open({templateUrl:"../uxData/scripts/partners/partners-import.html",controller:"PartnersImport as vm",backdrop:"static",keyboard:!1,windowClass:"import-partners-modal-window",resolve:{partners:function(){return z.partners}}});a.result.then(function(a){a?n():z.tableParams.reload()},function(){})}var z=this;z.authService=j,z.USER_PERMISSIONS=k,z.needToLoadData=!0,z.duplicatedIds=[],z.partners=[],z.addPartner=s,z.editPartner=t,z.deletePartner=v,z.exportAllPartners=w,z.exportPartnerById=x,z.openImportForm=y,o()}angular.module("uxData.partners").controller("Partners",a),a.$inject=["$rootScope","$scope","$modal","toastr","dialogs","$filter","$log","$q","ngTableParams","authService","USER_PERMISSIONS","partnersService","requestsService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){function x(){i.loadServicePaths().then(function(a){angular.extend(fa.servicePaths,a.servicePaths)},function(a){s.failedToLoadData("service paths")}),H(),I(),fa.uiModelHolder.editMode?i.loadRuleAndTemplates(fa.uiModelHolder.ruleName).then(function(a){fa.templateRules=a.templates,angular.isDefined(a.rule["if"])&&angular.isArray(a.rule["if"])&&(a.rule=angular.copy(a.rule["if"][0])),y(a.rule,fa.uiModelHolder.ruleName)},function(a){s.failedToLoadData("rule data",a)}):i.loadRulesAndTemplates().then(function(a){fa.templateRules=a.templates},function(a){s.failedToLoadData("rule data",a)})}function y(a,b){Q();var c=l.unmarshallJSONRule(a,v);if(q.isDefinedAndNotEmpty(a.templateName)){var d=l.unmarshallJSONRule(fa.templateRules[a.templateName],v);angular.extend(c,E(c,d)),C(c,b),fa.uiModelHolder.currentTemplateName=a.templateName,z()}else C(c,b);D()}function z(){B(),A()}function A(){var a=l.unmarshallJSONRule(fa.templateRules[fa.uiModelHolder.currentTemplateName],v);angular.forEach(a.expressions.reverse(),function(a,b){N(a,!0),fa.uiModelHolder.rawExpressions[0].disabled=!0})}function B(){for(var a=0;a<fa.uiModelHolder.rawExpressions.length;){var b=fa.uiModelHolder.rawExpressions[a];b.disabled?O(a):a++}}function C(a,b){fa.uiModelHolder.ruleName=b,fa.uiModelHolder.editMode=!0,fa.uiModelHolder.rawExpressions=angular.copy(a.expressions),fa.uiModelHolder.servers=angular.copy(a.returnStatement.servers),fa.uiModelHolder.countDownTime=a.countDownTime,fa.uiModelHolder.enablePrivate=angular.equals(a.enablePrivate,"true"),G()}function D(){ja.id=fa.uiModelHolder.ruleName;var a={servers:fa.uiModelHolder.servers,enablePrivate:fa.uiModelHolder.enablePrivate,countDownTime:fa.uiModelHolder.countDownTime,ruleName:fa.uiModelHolder.ruleName};ja.jsonRule=l.marshallRuleToJSON(fa.uiModelHolder.rawExpressions,a,v)}function E(a,b){var c={};return c.expressions=[],angular.forEach(a.expressions,function(a,d){var e=!1;angular.forEach(b.expressions,function(b,c){angular.equals(b,a)&&(e=!0)}),e||c.expressions.push(a)}),c}function F(){q.isDefinedAndNotEmpty(fa.uiModelHolder.currentTemplateName)?z():B()}function G(){angular.forEach(fa.uiModelHolder.rawExpressions,function(a,b){fa.exprValidationData[b]={},fa.exprValidationData[b][ga]={duplicates:{},valueErrorMsg:[]},q.isEmptyString(a.type)||(fa.exprValidationData[b][ha]={duplicates:{},valueErrorMsg:[]})}),angular.forEach(fa.uiModelHolder.servers,function(a,b){fa.serverValidationData.push({})})}function H(){i.loadAllRuleIds(g().RULE_TYPE.PATH).then(function(a){fa.existingRuleIDs=angular.copy(a)},function(a){s.failedToLoadData("rules names")})}function I(){t.loadAllTemplateIds(g().TEMPLATES_TYPE.PATH).then(function(a){fa.existingTemplatesIDs=angular.copy(a)},function(){s.failedToLoadData("templatesIds")})}function J(){var a={editMode:r().EXP_EDIT_MODE.SIMPLE,path:"",isNonWhitelisted:!1};K(a,!1)}function K(a,b){angular.isDefined(fa.uiModelHolder.countDownTime)&&!isNaN(fa.uiModelHolder.countDownTime)||(fa.uiModelHolder.countDownTime=15,fa.uiModelHolder.enablePrivate=!0),b?(fa.uiModelHolder.servers.unshift(a),fa.serverValidationData.unshift({})):(fa.uiModelHolder.servers.push(a),fa.serverValidationData.push({}))}function L(a){fa.uiModelHolder.servers.splice(a,1),fa.serverValidationData.splice(a,1)}function M(a){var b=k.createExpression("","",h().OPERATOR_TYPE.EQUAL,[""],ga);if(k.isBinary(a)){var c=k.createExpression("","",h().OPERATOR_TYPE.EQUAL,[""],ha);b=k.createBinaryExpression(b,c,a)}N(b,!1)}function N(a,b){var c={},d=k.createExpression(a[ga].expName,a[ga].expType,a[ga].expOperator,a[ga].expValues,ga,a[ga].negation);if(c[ga]={duplicates:{},valueErrorMsg:[]},k.isBinary(a.type)){var e=k.createExpression(a[ha].expName,a[ha].expType,a[ha].expOperator,a[ha].expValues,ha,a[ha].negation);d=k.createBinaryExpression(d,e,a.type),c[ha]={duplicates:{},valueErrorMsg:[]}}b?(fa.exprValidationData.unshift(c),fa.uiModelHolder.rawExpressions.unshift(d)):(fa.exprValidationData.push(c),fa.uiModelHolder.rawExpressions.push(d)),n.validateDuplicatesOfAllExpressions(fa.uiModelHolder.rawExpressions,fa.exprValidationData)}function O(a){fa.uiModelHolder.rawExpressions.splice(a,1),fa.exprValidationData.splice(a,1),n.revalidateDuplicatesOnRemove(a,fa.uiModelHolder.rawExpressions,fa.exprValidationData)}function P(){Q(),fa.uiModelHolder.currentTemplate={},fa.uiModelHolder.editMode&&(fa.uiModelHolder.editMode=!1,angular.isDefined(a.previousState)&&a.previousState.name===f().showFlavorRules?a.go(a.previousState.name,a.previousParams):a.go(f().addNewFlavorRule,{ruleId:fa.uiModelHolder.ruleName,serviceName:d.currentApplication}))}function Q(){fa.uiModelHolder.currentTemplateName="",fa.uiModelHolder.rawExpressions.splice(0,fa.uiModelHolder.rawExpressions.length),fa.uiModelHolder.ruleName="",fa.ruleNameError="",fa.uiModelHolder.servers.splice(0,fa.uiModelHolder.servers.length),fa.uiModelHolder.countDownTime=15,fa.uiModelHolder.enablePrivate=!0,fa.exprValidationData.splice(0,fa.exprValidationData.length),fa.serverValidationData.splice(0,fa.serverValidationData.length),fa.serverValidationData.push({}),fa.isSaving=!1}function R(a,b,c,d,e,f,g,h){X(a,b,c,d,e,f,g,h),n.validateDuplicatedRelationalExpressions(fa.uiModelHolder.rawExpressions,fa.exprValidationData,a,b),m.validateExprName(fa.uiModelHolder.rawExpressions[a][b],a,b,fa)}function S(a,b,c,d,e,f,g,h){X(a,b,c,d,e,f,g,h),m.validateExprValue(e[f],fa.uiModelHolder.rawExpressions[a][b],a,b,f,fa)}function T(a,b,c,d,e,f,g,h){X(a,b,c,d,e,f,g,h),fa.exprValidationData[a][b].valueErrorMsg=[""],m.validateExprName(fa.uiModelHolder.rawExpressions[a][b],a,b,fa),n.validateDuplicatedRelationalExpressions(fa.uiModelHolder.rawExpressions,fa.exprValidationData,a,b)}function U(a,b,c,d,e,f,g,h){X(a,b,c,d,e,f,g,h),m.validateExprValue(e[f],fa.uiModelHolder.rawExpressions[a][b],a,b,f,fa)}function V(a,b,c,d,e,f,g,h){fa.uiModelHolder.rawExpressions[a][b].expValues=e,fa.exprValidationData[a][b].valueErrorMsg.push("")}function W(a,b,c,d,e,f,g,h){fa.uiModelHolder.rawExpressions[a][b].expValues=e,fa.exprValidationData[a][b].valueErrorMsg.splice(f,1)}function X(a,b,c,d,e,f,g,h){fa.uiModelHolder.rawExpressions[a][b].expName=c,fa.uiModelHolder.rawExpressions[a][b].expOperator=d,fa.uiModelHolder.rawExpressions[a][b].negation=h,fa.uiModelHolder.rawExpressions[a][b].expValues=e,fa.uiModelHolder.rawExpressions[a][b].expType=g}function Y(a,b){fa.uiModelHolder.servers[a].path=b,n.validateServer(a,fa)}function Z(a,b){fa.uiModelHolder.servers[a].url=b,n.validateServer(a,fa)}function $(a,b){fa.uiModelHolder.servers[a].query=b}function _(a,b){fa.uiModelHolder.servers[a].editMode=b}function aa(a,b){fa.uiModelHolder.servers[a].isNonWhitelisted=b}function ba(){angular.forEach(fa.uiModelHolder.servers,function(a,b){angular.equals(a.editMode,ia)&&(a.url=q.createUrl())})}function ca(){ba();var b=m.validateRule(fa,n);if(b){var c={servers:fa.uiModelHolder.servers,enablePrivate:fa.uiModelHolder.enablePrivate,countDownTime:fa.uiModelHolder.countDownTime,ruleName:fa.uiModelHolder.ruleName},d=l.marshallRuleToJSON(fa.uiModelHolder.rawExpressions,c,v);angular.equals(ja.id,fa.uiModelHolder.ruleName)&&angular.equals(ja.jsonRule,d)?s.hasNotChangedWarning("Flavor Rule"):(""!==fa.uiModelHolder.currentTemplateName?d["if"][0].templateName=fa.uiModelHolder.currentTemplateName:angular.isDefined(d["if"][0].templateName)&&delete d["if"][0].templateName,d["if"][0].id=fa.uiModelHolder.ruleName,j.saveRule(d["if"][0],fa.uiModelHolder.ruleName).then(function(b){s.successfullySaved(" '"+fa.uiModelHolder.ruleName+"' rule."),a.go(f().showFlavorRules,{ruleName:fa.uiModelHolder.ruleName})},function(a){s.genericError(a.data.message),fa.isSaving=!1}))}else s.failedToSave("rule","Due to validation errors.")}function da(){ba(),angular.isUndefined(fa.uiModelHolder.currentTemplateName)&&(fa.uiModelHolder.currentTemplateName="");var b=m.validateRule(fa,n,!0);if(b){var c={servers:fa.uiModelHolder.servers,enablePrivate:fa.uiModelHolder.enablePrivate,countDownTime:fa.uiModelHolder.countDownTime,ruleName:fa.uiModelHolder.ruleName},d=l.marshallRuleToJSON(fa.uiModelHolder.rawExpressions,c,v);d["if"][0].id=fa.uiModelHolder.ruleName,t.saveTemplate(g().TEMPLATES_TYPE.PATH,d["if"][0],fa.uiModelHolder.ruleName).then(function(b){s.successfullySaved(" '"+fa.uiModelHolder.ruleName+"' template."),a.go(f().templates,{name:g().TEMPLATES_TYPE.PATH,ruleName:fa.uiModelHolder.ruleName})},function(a){s.failedToSave("Template: '"+fa.uiModelHolder.ruleName+"'",angular.isDefined(a.data.message)?a.data.message:a.message),fa.isSaving=!1})}else s.failedToSave("Template","Due to validation errors.")}function ea(){m.validateRuleName(fa)}var fa=this,ga=g().LEFT,ha=g().RIGHT,ia=(g().RULE_TYPE.PATH,h().OPERATOR_TYPE.ISEMPTY,r().EXP_EDIT_MODE.SIMPLE),ja=(u().rulesEdit,u().rulesAdd,{});fa.authService=o,fa.USER_PERMISSIONS=p,fa.hasPermissions=q.hasPermissions,fa.existingRuleIDs={},fa.existingTemplatesIDs={},fa.exprValidationData=[],fa.serverValidationData=[],fa.uiModelHolder={ruleName:angular.isDefined(c.ruleId)?c.ruleId:"",currentTemplate:{},editMode:angular.isDefined(c.ruleId),rawExpressions:[],servers:[],countDownTime:15,enablePrivate:!0,currentTemplateName:""},fa.servicePaths={},fa.ruleNameError="",fa.isSaving=!1,fa.templateRules={},fa.saveRule=ca,fa.saveAsTemplate=da,fa.addEmptyServer=J,fa.removeServer=L,fa.addExpression=N,fa.addEmptyExpression=M,fa.removeExpression=O,fa.updateExpressions=X,fa.cancelEditRule=P,fa.onExprNameChanged=R,fa.onExprOperatorChanged=T,fa.onExprValueAdded=V,fa.onExprValueRemoved=W,fa.onExprValueChanged=S,fa.onExprValueTypeChanged=U,fa.onServerPathChanged=Y,fa.onServerUrlChanged=Z,fa.onServerQueryChanged=$,fa.onServerEditModeChanged=_,fa.onServerWhitelistedChanged=aa,fa.validateRuleName=ea,fa.onTemplateChanged=F,fa.hasError=q.isDefinedAndNotEmpty,x(),w.onChangeApp(e,function(a){P(),fa.servicePaths={},fa.uiModelHolder.servers=[],fa.serverValidationData=[],x()})}angular.module("uxData.rules").controller("RulesEditController",a),a.$inject=["$state","$q","$stateParams","$rootScope","$scope","STATES_CONSTANTS","RULES_CONSTANTS","EXPRESSION_CONSTANTS","rulesService","rulesRequestService","rulesEditService","rulesBuilderService","RulesCommonValidationService","rulesValidationService","authService","USER_PERMISSIONS","utilsService","SERVER_CONSTANTS","rulesAlertsService","templatesService","LOCALSTORAGE_PAGE_NAMES","pathRulesBuilderService","messageService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(a){b.getFile(a,l).then(function(a){k.rulesFromFile=a})}function i(a,c){b.validateDuplicatesAndImportOneRule(a,c,k.rulesFromFile,l)}function j(){b.importAll(k.rulesFromFile,l)}var k=this,l=f().RULE_TYPE.PATH;k.authService=d,k.USER_PERMISSIONS=e,k.rulesFromFile={},k.loading=!1,k.getFile=h,k.validateDuplicatesAndImportOneRule=i,k.isMapEmpty=c.isMapEmpty,k.importAll=j,g.onChangeApp(a,function(a){angular.copy({},k.rulesFromFile)})}angular.module("uxData.rules").controller("RulesImportController",a),a.$inject=["$scope","RulesImportService","utilsService","authService","USER_PERMISSIONS","RULES_CONSTANTS","messageService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(){h.loadRulesPathsChanges().then(function(a){x.rules=r.unmarshallJSONRulesForPreview(a.rules,a.pendingChanges,a.servicePaths,y,q),x.loading=!1,""!==x.focusedRule&&(e.hash(x.focusedRule),f())},function(a){x.loading=!1,j.failedToLoadData("rules data")})}function u(b){c.go(g().editFlavorRule,{ruleId:b.toString(),serviceName:a.currentApplication})}function v(a){i.deleteRule(a).then(function(){j.successfullyDeleted("path rule: '"+a+"'"),t()},function(b){j.failedToDelete("path rule: '"+a+"/",angular.isDefined(b.message)?b.message:b)})}function w(a){var b="Are you sure you want to delete rule '"+a+"' ?",c=p.confirm(b);c.result.then(function(b){v(a)},function(){})}var x=this,y=n().RULE_TYPE.PATH;x.authService=l,x.USER_PERMISSIONS=m,x.focusedRule=angular.isDefined(d.ruleName)?d.ruleName:"",x.rules={},x.editRule=u,x.deleteRule=v,x.confirmDeleteRule=w,x.loading=!0,x.exportAllRules=i.exportAllRules,x.isMapEmpty=k.isMapEmpty,x.searchSort={sortBy:"id",sortType:"asc",search:""},t(),o.onChangeApp(b,function(){t()})}angular.module("uxData.rules").controller("rulesController",a),a.$inject=["$rootScope","$scope","$state","$stateParams","$location","$anchorScroll","STATES_CONSTANTS","rulesService","rulesRequestService","rulesAlertsService","utilsService","authService","USER_PERMISSIONS","RULES_CONSTANTS","messageService","dialogs","pathRulesBuilderService","rulesBuilderService","LOCALSTORAGE_PAGE_NAMES"]}(),function(){"use strict";function a(a,b,c,d,e){function f(){return angular.equals(s.editMode,t)}function g(){return(w||!$.isEmptyObject(s.servicePaths)&&!angular.equals(s.servicePaths,v))&&(s.listOfPaths=c.getListOfPaths(s.servicePaths,s.currentApp,b.showStacks,s.showFlavors,b.showWhitelistedOnly),v=angular.copy(s.servicePaths),w=!1),s.listOfPaths}function h(){b.onPathChanged({path:s.path.NAME})}function i(){b.onUrlChanged({url:s.url})}function j(){b.onEditModeChanged({mode:s.editMode})}function k(){b.onWhitelistedChanged({isNonWhitelisted:s.isNonWhitelisted}),w=!0}function l(){return s.disabled}function m(){p(),s.query.entry.push({key:"",value:""}),n()}function n(){b.onQueryChanged({query:s.query})}function o(a){s.query.entry.splice(a,1),q(),n()}function p(){d.isEmptyObject(s.query)&&(s.query=u)}function q(){d.isEmptyObject(s.query)||!d.isEmptyObject(s.query.entry)&&0!=s.query.entry.length||(s.query=null)}function r(a){return angular.isDefined(a)&&!$.isEmptyObject(a)}var s=this,t=e().EXP_EDIT_MODE.SIMPLE,u={entry:[]};s.isSimpleMode=f,s.isDisabled=l,s.hasError=r,s.urlChanged=i,s.pathChanged=h,s.getListOfPaths=g,s.editModeChanged=j,s.whitelistedChanged=k,s.addNewQueryPair=m,s.removeQueryPair=o,s.queryChanged=n,s.serverValues=b.serverValues,s.servicePaths=b.servicePaths,s.validationData=b.validationData,s.currentApp=a.currentApplication,s.editMode=d.isDefinedAndNotEmpty(b.editMode)?b.editMode:e().EXP_EDIT_MODE.SIMPLE,s.disabled=!!d.isDefinedAndNotEmpty(b.disabled)&&b.disabled,s.showLabels=!d.isDefinedAndNotEmpty(b.showLabels)||b.showLabels,s.showFlavors=!d.isDefinedAndNotEmpty(b.showFlavors)||b.showFlavors,s.showWhitelistedOnly=!!d.isDefinedAndNotEmpty(b.showWhitelistedOnly)&&b.showWhitelistedOnly,s.onlySimpleMode=!!d.isDefinedAndNotEmpty(b.onlySimpleMode)&&b.onlySimpleMode,s.showWhitelistedOption=!!d.isDefinedAndNotEmpty(b.showWhitelistedOption)&&b.showWhitelistedOption,s.isNonWhitelisted=!!d.isDefinedAndNotEmpty(b.serverValues.isNonWhitelisted)&&b.serverValues.isNonWhitelisted,s.path=d.isDefinedAndNotEmpty(b.serverValues.path)?{NAME:b.serverValues.path}:{NAME:""},s.url=d.isDefinedAndNotEmpty(b.serverValues.url)&&!angular.equals(s.editMode,t)?b.serverValues.url:"",s.query=d.isEmptyObject(b.serverValues.query)?u:b.serverValues.query;var v={},w=!0;s.listOfPaths=[]}angular.module("uxData.server").controller("serverController",a),a.$inject=["$rootScope","$scope","serverService","utilsService","SERVER_CONSTANTS"]}(),function(){"use strict";angular.module("uxData.server").directive("server",function(){return{restrict:"E",replace:!0,scope:{servicePaths:"=",editMode:"=",serverValues:"=",disabled:"=",showWhitelistedOption:"=",showLabels:"=",onlySimpleMode:"=",validationData:"=",showStacks:"=",showFlavors:"=",showWhitelistedOnly:"=",onUrlChanged:"&",onQueryChanged:"&",onPathChanged:"&",onEditModeChanged:"&",onWhitelistedChanged:"&"},templateUrl:"../uxData/scripts/server/server.html",controller:"serverController",controllerAs:"vm"}})}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(){k()}function k(){g.getRedirectorConfig().then(function(a){m.redirectorConfig=angular.copy(a)},function(a){h.error("Can't load redirectorConfig","Error",{closeButton:!0,timeOut:3e3})})}function l(){m.isSaving=!0,g.saveRedirectorConfig(m.redirectorConfig).then(function(a){h.success("The settings have been successfully modified","Success",{closeButton:!0,timeOut:3e3}),m.isSaving=!1},function(a){m.responseErrorMsg=a.data.message,h.error("Can't save settings","Error",{closeButton:!0,timeOut:3e3}),i.error("Failed to save settings",m.responseErrorMsg),m.isSaving=!1})}var m=this;m.authService=b,m.USER_PERMISSIONS=c,m.hasPermissions=d.hasPermissions,m.isSaving=!1,m.redirectorConfig={minHosts:0,appMinHosts:0},m.saveSettings=l,j(),e.onChangeApp(a,function(a){j()})}angular.module("uxData.settings").controller("settingsController",a),a.$inject=["$scope","authService","USER_PERMISSIONS","utilsService","messageService","LOCALSTORAGE_PAGE_NAMES","settingsService","toastr","dialogs"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){w.tableParams=new k({page:w.tableParamsHolder.pageNo,count:w.tableParamsHolder.paramsCount,sorting:{pos:"asc"}},{total:0,getData:function(b,c){var e=c.sorting()?d("orderBy")(w.whitelistedStacks,c.orderBy()):w.whitelistedStacks;e=c.filter()?d("filter")(e,c.filter()):e,c.total(e.length);var f=Math.max(1,Math.ceil(c.total()/c.count()));c.page()>f&&c.page(f),e=e.slice((c.page()-1)*c.count(),c.page()*c.count());const g=25;angular.forEach(e,function(b){angular.forEach(b.flavors,function(a){a.name.length>g&&(a.name=a.name.substring(0,g)+"...")}),o.getStackComment(a.currentApplication,b.path).then(function(a){b.comment=a.comment},function(a){})}),b.resolve(e)}}),b.$on("ngTableAfterReloadData",function(){w.tableParamsHolder.paramsCount=w.tableParams.$params.count,w.tableParamsHolder.pageNo=w.tableParams.$params.page}),w.tableParams.settings().$scope=b}function q(){angular.isDefined(w.tableParams)&&(w.tableParams.$params.count=w.tableParamsHolder.paramsCount,w.tableParams.$params.page=w.tableParamsHolder.pageNo)}function r(){j.saveWhitelisted(w.whitelistedStacks).then(function(a){c.info("The whitelisted stacks are saved"),f.success("The whitelisted stacks are saved","Success",{closeButton:!0,timeOut:3e3}),u(),t()},function(a){f.error(a.data.message,"Error",{closeButton:!0,timeOut:3e3})})}function s(){t()}function t(){j.getStacks(w.stacks,w.stacksAndFlavors,w.whitelistedStacks,w.inactiveStacks).then(function(a){angular.isDefined(w.tableParams)?w.tableParams.reload():p()},function(a){angular.isDefined(w.tableParams)?w.tableParams.reload():p(),f.error(a.message,"Error",{closeButton:!0,timeOut:3e3})})}function u(){w.whitelistedStacks.splice(0,w.whitelistedStacks.length),w.inactiveStacks.splice(0,w.inactiveStacks.length),w.stacks.splice(0,w.stacks.length),w.stacksAndFlavors={},angular.isDefined(w.tableParams)&&w.tableParams.reload()}function v(b,c){var d={comment:b};return o.saveStackComment(d,a.currentApplication,c),1}var w=this;w.authService=h,
w.USER_PERMISSIONS=i,w.hasPermissions=m.hasPermissions,w.whitelistedStacks=[],w.stacks=[],w.stacksAndFlavors={},w.inactiveStacks=[],w.saveStacks=r,w.saveStackComment=v,w.exportAllStacks=j.exportAllStacks,w.exportAllWhitelisted=j.exportAllWhitelisted,w.tableParamsHolder={paramsCount:500,pageNo:1},s(),l.onChangeApp(b,function(a){u(),s(),q()})}angular.module("uxData.stacks").controller("stacksManagement",a),a.$inject=["$rootScope","$scope","$log","$filter","$timeout","toastr","dialogs","authService","USER_PERMISSIONS","stacksManagementService","ngTableParams","messageService","utilsService","LOCALSTORAGE_PAGE_NAMES","requestsService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){x.tableParams=new g({page:x.tableParamsHolder.pageNo,count:x.tableParamsHolder.paramsCount,sorting:{pos:"asc"}},{counts:[],total:0,getData:function(a,b){var d=b.sorting()?c("orderBy")(x.summary,b.orderBy()):x.summary;d=b.filter()?c("filter")(d,b.filter()):d,b.total(d.length);var e=Math.max(1,Math.ceil(b.total()/b.count()));b.page()>e&&b.page(e),d=d.slice((b.page()-1)*b.count(),b.page()*b.count()),a.resolve(d)}}),a.$on("ngTableAfterReloadData",function(){x.tableParamsHolder.paramsCount=x.tableParams.$params.count,x.tableParamsHolder.pageNo=x.tableParams.$params.page}),x.tableParams.settings().$scope=a}function o(){angular.isDefined(x.tableParams)&&(x.tableParams.$params.count=x.tableParamsHolder.paramsCount,x.tableParams.$params.page=x.tableParamsHolder.pageNo)}function p(){x.loading=!0,s(),r(),o()}function q(){return!(x.selectedNamespaces.length>0)}function r(){t()}function s(){x.summary.splice(0,x.summary.length),angular.isDefined(x.tableParams)&&x.tableParams.reload()}function t(){var a={};a.namespace=[],e.getNamespacesFromDS(a).then(function(c){b.info("Success: received "+c.namespace.length+" item(s)");for(var e=0;e<a.namespace.length;e++)x.namespaces.namespace[e]=a.namespace[e].name;0===x.selectedNamespaces.length&&(x.selectedNamespaces=y),d.getSummary(x.summary,u()).then(function(){x.loading=!1,angular.isDefined(x.tableParams)?x.tableParams.reload():n()},function(a){x.loading=!1,angular.isDefined(x.tableParams)?x.tableParams.reload():n(),f.error(a.message,"Error",{closeButton:!0,timeOut:3e3})})},function(a){200===a.status?(b.warn("Warn: "+a.message),x.loading=!1):(x.loading=!1,b.error("Failed: "+a.message),404!==a.status&&j.errorGet())})}function u(){for(var a="",b=0;b<x.selectedNamespaces.length;b++)a=a+","+x.selectedNamespaces[b];return a.substring(1,a.length)}function v(a){console.log(a),l.go(m().namespacesEdit,{id:a})}function w(){l.go(m().distribution)}var x=this,y=[k().NAMESPACED_DEFAULT_NAMES.INTERNAL_MAINTENANCE,k().NAMESPACED_DEFAULT_NAMES.INTERNAL_FEATURE,k().NAMESPACED_DEFAULT_NAMES.PRODUCTION_PREVIEW_LIST_2,k().NAMESPACED_DEFAULT_NAMES.PRODUCTION_PREVIEW_LIST];x.loading=!0,x.summary=[],x.namespaces={},x.namespaces.namespace=[],x.selectedNamespaces=[],x.reloadSummary=p,x.hasReloadSummary=q,x.distributionPage=w,x.editNamespaces=v,x.getSelectedNamespaces=u,x.tableParamsHolder={paramsCount:500,pageNo:1},r(),h.onChangeApp(a,function(){s(),r(),o()})}angular.module("uxData.summary").controller("summaryController",a),a.$inject=["$scope","$log","$filter","summaryService","namespacedService","toastr","ngTableParams","messageService","LOCALSTORAGE_PAGE_NAMES","namespacedAlertsService","SUMMARY_CONSTANTS","$state","STATES_CONSTANTS"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(){w.name=c.name;var b,f,h="";w.name===o().TEMPLATES_TYPE.PATH?(h=o().TEMPLATES_TYPE.PATH,w.ruleType="rule",w.templatePageName="Flavor Rules",b=r,f=l):(h=o().TEMPLATES_TYPE.URL,w.ruleType="urlRule",w.templatePageName="URL Rules",b=q,f=m);var i=w.ruleType+"s";k.getAll(w.name).then(function(c){f.loadAllRules().then(function(a){w.rules=s.unmarshallJSONTemplateRules(i,c[w.name],c.pending,c.servicePaths,h,b,a),""!==w.focusedRule&&(d.hash(w.focusedRule),e()),w.loading=!1},function(b){var c=angular.isDefined(b)?b.message:"error while getting url rules";a.error(c),g.error(c,"Error",{closeButton:!0,timeOut:3e3}),w.loading=!1})},function(b){a.error(b.message),g.error(b.message,"Error",{closeButton:!0,timeOut:3e3}),w.loading=!1})}function u(a,b){k.deleteTemplate(a,b).then(function(a){g.success("Deleted template: '"+b+"'","Success",{closeButton:!0,timeOut:3e3}),t()},function(a){var c=a.data.message;g.error("Template: '"+b+"' failed to delete."+c,"Error",{closeButton:!0,timeOut:3e3})})}function v(a,b){var c="Are you sure you want to delete template '"+b+"' ?",d=h.confirm(c);d.result.then(function(c){u(a,b)},function(){})}var w=this;w.authService=i,w.USER_PERMISSIONS=j,w.templates={},w.name="",w.rules={},w.ruleType="rule",w.templatePageName="",w.loading=!0,w.focusedRule=angular.isDefined(c.ruleName)?c.ruleName:"",w.confirmDeleteTemplate=v,w.isEmpty=n.isMapEmpty,t(),p.onChangeApp(b,function(a){t()})}angular.module("uxData.templates").controller("Templates",a),a.$inject=["$log","$scope","$stateParams","$location","$anchorScroll","dialogs","toastr","dialogs","authService","USER_PERMISSIONS","templatesService","rulesService","urlRulesService","utilsService","RULES_CONSTANTS","messageService","urlRulesBuilderService","pathRulesBuilderService","rulesBuilderService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(a){var d=b.confirm("Cancel confirmation","Are you sure you want to drop changes for test case: "+a.testName);d.result.then(function(b){c.info("cancelled saving test case",a),e.go(i().testsuiteShow)})}function s(){var a=f.name;D(),C(),q.isEmptyString(a)||(E.isEditing=!0,j.getAndValidateOneTestCase(a).then(function(a){angular.copy(a,E.currentTestCase),angular.isDefined(E.currentTestCase.expected.appliedUrlRules)||(E.currentTestCase.expected.appliedUrlRules=[])},function(a){l.errorGet(a)}))}function t(){E.currentParam.name="",E.currentParam.values.splice(0,E.currentParam.values.length)}function u(){E.currentTestCase.parameters.parameter.push(angular.copy(E.currentParam)),t(),a.add_testcase.parameterName.$pristine=!0,a.add_testcase.parameterValue.$pristine=!0}function v(a){if(angular.isDefined(E.currentTestCase.parameters))return A(a,E.currentTestCase.parameters.parameter)<0}function w(b){k.isParameterValueValid(b)?(E.currentParam.values.push(b),c.debug("Added value ",b),E.uiModelHolder.valueToAddToCurrentParam="",a.add_testcase.parameterValue.$pristine=!0):c.error("Attempt to add invalid value "+b)}function x(a){return E.currentParam.values.indexOf(a)<0}function y(a){E.currentParam.values.splice(E.currentParam.values.indexOf(a),1),c.debug("Value "+a+" is deleted")}function z(a){E.currentTestCase.parameters.parameter.splice(A(a,E.currentTestCase.parameters.parameter),1),c.debug("Parameter "+a+" is deleted")}function A(a,b){angular.isUndefined(b)&&(b=[]);for(var c=0;c<b.length;c++)if(b[c].name===a)return c;return-1}function B(a){j.validateAndSaveTestCase(a,E.isEditing).then(function(a){c.info("Saved test case ",a),e.go(i().testsuiteShow)},function(a){c.error("Error saving test case ",a.message)})}function C(){}function D(){var a=[],b=[];E.typeaheadData.stacks.splice(0,E.typeaheadData.stacks.length),E.typeaheadData.flavors.splice(0,E.typeaheadData.flavors.length),m.getServicePathsFromDS([],a,b).then(function(d){E.typeaheadData.stacks=a,angular.forEach(a,function(a){var c=b[a];angular.forEach(c.flavors,function(a){E.typeaheadData.flavors.indexOf(a.name)===-1&&E.typeaheadData.flavors.push(a.name)})}),c.info("Got stacks ",E.typeaheadData.stacks," and flavors ",E.typeaheadData.flavors)},function(a){c.error("Cannot get stacks",a)})}var E=this;E.authService=g,E.USER_PERMISSIONS=h,E.addValue=w,E.addParameter=u,E.currentTestCase={parameters:{parameter:[]},expected:{appliedUrlRules:[]},testName:"",application:d.currentApplication},E.uiModelHolder={valueToAddToCurrentParam:""},E.currentParam={name:"",values:[]},E.deleteParameter=z,E.deleteValue=y,E.isCurrentTestCaseValid=!0,E.saveTestCase=B,E.validation=k,E.cancelSaving=r,E.isEditing=!1,E.isParameterUnique=v,E.isValueUnique=x,E.typeaheadData={stacks:[],flavors:[],ruleNames:[],urns:n().urns,protocols:n().protocols},E.uiModelHolder.valueToAddToCurrentParam="",s(),o.onChangeApp(a,function(a){E.isEditing&&e.go(i().testsuiteAdd),D(),C()})}angular.module("uxData.testsuite").controller("EditTestSuite",a),a.$inject=["$scope","dialogs","$log","$rootScope","$state","$stateParams","authService","USER_PERMISSIONS","STATES_CONSTANTS","testsuiteService","validationServicetestsuite","testsuiteAlertsService","stacksManagementService","TYPEAHEAD_DATA","messageService","LOCALSTORAGE_PAGE_NAMES","utilsService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(b){o.showFooter=!1,f.openFile(b,null,this).then(function(c){a.info("File "+b+" is read successfully"),i(c)},function(b){a.error("File is not read: "+b.message),e.errorGetFile()})}function i(b){a.info("Trying to get test cases from the following structure: ",b);var c=JSON.parse(b);if(angular.isDefined(c.testCase)){var d=[];angular.forEach(c.testCase,function(b){g.validateTestCase(b).then(function(a){d.push(b)},function(c){a.error("Cannot validate test case ",b,"for reason ",c),e.errorValidateIncomingTest(c),o.title="There were validation errors. Please check the file validity. Only valid cases are shown"})}),o.testCasesFromFile=d,a.info("Got valid testcases: ",o.testCasesFromFile)}else g.validateTestCase(c).then(function(b){o.testCasesFromFile=[c],a.info("Got one test case to import: ",o.testCasesFromFile)},function(c){a.error("Cannot validate test case ",b,"for reason ",c),e.errorValidateIncomingTest(c),o.title="There was a validation error. Please check the file validity"});o.title='Save test cases by clicking "Import" button',angular.isDefined(o.tableParams)?o.tableParams.reload():j()}function j(){o.tableParams=new c({page:1,count:10,sorting:{name:"asc"}},{total:0,getData:function(a,c){var d=c.sorting()?b("orderBy")(o.testCasesFromFile,c.orderBy()):o.testCasesFromFile;if(d.length>0){angular.forEach(d,function(a){a.expanded=!1}),d=c.filter()?b("filter")(d,c.filter()):d,c.total(d.length);var e=Math.max(1,Math.ceil(c.total()/c.count()));c.page()>e&&c.page(e),d=d.slice((c.page()-1)*c.count(),c.page()*c.count()),a.resolve(d)}else a.reject([])}})}function k(b){a.info("Trying to import one testcase: ",b),d.validateAndSaveTestCase(b).then(function(c){a.info("Testcase is imported: ",b),o.testCasesFromFile.splice(p(b.testName,o.testCasesFromFile),1),o.tableParams.reload(),0===o.testCasesFromFile.length&&(o.showFooter=!0)},function(a){e.errorImportTest(a)})}function l(){a.info("Importing all test cases");var b=angular.copy(o.testCasesFromFile);m(b)}function m(b){angular.isDefined(b)&&angular.isDefined(b[0])&&d.validateAndSaveTestCase(b[0]).then(function(a){o.testCasesFromFile.splice(p(b[0].testName,o.testCasesFromFile),1),o.tableParams.reload(),e.successImportTest(b[0].testName),b.splice(0,1),m(b),0===o.testCasesFromFile.length&&(o.showFooter=!0)},function(c){a.error("Test case ",b[0]," is NOT imported :",c),e.errorImportTest(b[0].testName),b.splice(0,1),m(b),0===o.testCasesFromFile.length&&(o.showFooter=!0)})}function n(a){a.expanded=!a.expanded}var o=this;o.changeExpanded=n,o.findTestCaseByName=d.findTestCaseByName,o.getSimpleViewForTestCase=d.getSimpleViewForTestCase,o.getFile=h,o.importOne=k,o.importAll=l,o.loadTestCases=d.loadTestCases,o.title="Choose a file to import",o.testCasesFromFile=[];var p=d.findTestCaseIndexByName}angular.module("uxData.testsuite").controller("ImportTestSuite",a),a.$inject=["$log","$filter","ngTableParams","testsuiteService","testsuiteAlertsService","importService","validationServicetestsuite"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){var a=angular.isDefined(f.name)&&""!==f.name;a?r():s()}function r(){m.getTestCase(f.name).then(function(a){d.info("Got testcase "+a.testName,a),o.validateTestCase(a).then(function(){A.testCases=[a],angular.isDefined(A.tableParams)?A.tableParams.reload:u(),y()},function(a){A.testCases=[],n.errorValidateIncomingTest(a)})},function(a){d.error("Error getting testcase to run ",a),n.errorGet(a)})}function s(){l.getAndValidateAllTestCases().then(function(a){A.testCases=a,angular.isDefined(A.tableParams)?A.tableParams.reload:u(),d.info("Got valid testcases ",a),y()},function(a){d.error("Error getting test cases",a)})}function t(b,e){var f=h.wait(void 0,void 0,0);c(function(){a.$broadcast("dialogs.wait.progress",{progress:100})},E),m.runTestCase(b.testName,e).then(function(a){b.actual=a.actual,b.logs=a.logs,b.status=a.status,o.validateTestCase(b).then(function(){b.isResultExpanded=!1,d.info("Test ran successfully while re-running",a),n.successRun(b.testName),f.close(),A.tableParams.reload()},function(a){n.errorValidateIncomingTest(a),d.error("Test ",b," re-ran successfully, but there were validation errors. ",a),f.close(),A.tableParams.reload()})},function(a){d.error("Test re-run was unsuccessful ",a),x(b),n.errorRunTest(b.testName),f.close()})}function u(){A.tableParams=new i({page:1,count:10,sorting:{name:"asc"}},{total:0,getData:function(a,b){var c=b.sorting()?g("orderBy")(A.testCases,b.orderBy()):A.testCases,d=[];angular.forEach(c,function(a){for(var b=0;b<A.testNamesToRun.length;b++)a.testName===A.testNamesToRun[b]&&d.push(a);a.expanded=!1,angular.isDefined(a.actual)&&(a.expectedText=JSON.stringify(l.arrayPropertiesToStrings(a.expected),null,D),a.actualText=JSON.stringify(l.arrayPropertiesToStrings(a.actual),null,D))}),0!=A.testNamesToRun.length&&(c=d),c=b.filter()?g("filter")(c,b.filter()):c,b.total(c.length);var e=Math.max(1,Math.ceil(b.total()/b.count()));b.page()>e&&b.page(e),c=c.slice((b.page()-1)*b.count(),b.page()*b.count()),a.resolve(c)}}),A.tableParams.settings().$scope=b}function v(){e.go(j().testsuiteShow)}function w(a){a.expanded=!a.expanded}function x(a){a.error=!0}function y(){d.info("Attempting to run all tests");var a=[];if(0==A.testNamesToRun.length)a=angular.copy(A.testCases);else for(var b=0;b<A.testCases.length;b++)for(var c=0;c<A.testNamesToRun.length;c++)A.testCases[b].testName===A.testNamesToRun[c]&&a.push(A.testCases[b]);z(a),A.tableParams.reload()}function z(a){angular.isDefined(a)&&angular.isArray(a)&&angular.isDefined(a[0])&&m.runTestCase(a[0].testName,A.testNamesToRunNext.indexOf(a[0].testName)<0?B:C).then(function(b){d.info("Test ran successfully",b),A.testCases[A.findTestCaseIndexByName(a[0].testName,A.testCases)].actual=b.actual,A.testCases[A.findTestCaseIndexByName(a[0].testName,A.testCases)].logs=b.logs,A.testCases[A.findTestCaseIndexByName(a[0].testName,A.testCases)].status=b.status,o.validateTestCase(A.testCases[A.findTestCaseIndexByName(a[0].testName,A.testCases)]).then(function(b){A.tableParams.reload(),a.splice(0,1),z(a)},function(c){A.testCases[A.findTestCaseIndexByName(a[0].testName,A.testCases)]=b,A.tableParams.reload(),d.error("Cannot validate ran testcase for reason ",c),a.splice(0,1),z(a),n.errorValidateIncomingTest(c)})},function(b){x(A.testCases[A.findTestCaseIndexByName(a[0].testName,A.testCases)]),n.errorRunTest(a[0].testName),a.splice(0,1),d.error("Test run error",b),A.tableParams.reload(),z(a)})}var A=this;A.changeExpanded=w,A.findTestCaseByName=l.findTestCaseByName,A.findTestCaseIndexByName=l.findTestCaseIndexByName,A.generateDiffStringForTestResult=l.generateDiffStringForTestResult,A.goToShowPage=v,A.reRun=t,A.testNamesToRunNext=l.testNamesToRunNext,A.testNamesToRun=l.testNamesToRun,q();var B="CURRENT",C="NEXT",D=2,E=500;k.onChangeApp(b,function(a){q()})}angular.module("uxData.testsuite").controller("RunTestSuite",a),a.$inject=["$rootScope","$scope","$timeout","$log","$state","$stateParams","$filter","dialogs","ngTableParams","STATES_CONSTANTS","messageService","testsuiteService","testSuiteRequestService","testsuiteAlertsService","validationServicetestsuite","utilsService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){D.tableParams.$params.filter=D.search,D.tableParams.reload()}function p(){D.loading=!0,D.allSelected=!1,D.testNamesToRunNext.splice(0,D.testNamesToRunNext.length),D.testNamesToRun.splice(0,D.testNamesToRun.length),k.getAndValidateAllTestCases().then(function(b){a.info("Got test cases: ",b),D.testCases=b,angular.isArray(D.testCases)&&D.testCases.length>0&&angular.forEach(D.testCases,function(a){a.run=!1,a.showSimpleView=!0}),angular.isDefined(D.tableParams)?D.tableParams.reload():q(),D.loading=!1},function(b){a.error("Error while getting all test cases",b),D.loading=!1})}function q(){D.tableParams=new f({page:1,count:10,sorting:{name:"asc"}},{total:0,getData:function(a,b){if(angular.isArray(D.testCases)&&D.testCases.length>0){r(D.tableParams.data,D.testCases),B();var c=b.sorting()?d("orderBy")(D.testCases,b.orderBy()):D.testCases;if(c=b.filter()?d("filter")(c,b.filter()):c,angular.isDefined(c)){b.total(c.length);var e=Math.max(1,Math.ceil(b.total()/b.count()));b.page()>e&&b.page(e),c=c.slice((b.page()-1)*b.count(),b.page()*b.count()),D.allSelected=z(c),D.loading=!1,a.resolve(c)}else D.loading=!1,a.resolve([])}else a.resolve([])}}),D.tableParams.settings().$scope=c}function r(a,b){if(!angular.isUndefined(a))for(var c=0;c<b.length;c++)for(var d=0;d<a.length;d++)b[c].testName===a[d].testName&&(b[c].run=a[d].run)}function s(a){var b=e.confirm("Delete confirmation","Are you sure you want to Delete test case: "+a);b.result.then(function(b){k.deleteTestCaseByName(a).then(function(b){l.successDelete(a),D.testCases.splice(k.findTestCaseIndexByName(a,D.testCases),1),D.tableParams.reload(),B()},function(b){e.notify("Failed to delete test case: "+a,b.data.message),D.isSaving=!1},function(a){})})}function t(c){a.info("going to edit testCase",c),b.go(i().testsuiteEdit,{name:c.testName})}function u(a){b.go(i().testsuiteRun,{name:a.testName})}function v(a,b){b?D.testNamesToRunNext.splice(D.testNamesToRunNext.indexOf(a),1):D.testNamesToRunNext.push(a)}function w(){D.allSelected=!0,D.testNamesToRun.splice(0,D.testNamesToRun.length);for(var a=d("filter")(D.tableParams.data,D.search.$),b=0;b<a.length;b++)a[b].run=!0,D.testNamesToRun.push(a[b].testName)}function x(){D.allSelected=!1,D.testNamesToRun.splice(0,D.testNamesToRun.length);for(var a=0;a<D.tableParams.data.length;a++)D.tableParams.data[a].run=!1;r(D.tableParams.data,D.testCases),B()}function y(a,b){D.allSelected=z(D.tableParams.data),b?D.testNamesToRun.push(a):(D.testNamesToRun.splice(D.testNamesToRun.indexOf(a),1),B())}function z(a){for(var b=0;b<a.length;b++)if(!a[b].run)return!1;return!0}function A(a){a.showSimpleView=!a.showSimpleView}function B(){D.testNamesToRun.splice(0,D.testNamesToRun.length);for(var a=0;a<D.testCases.length;a++)D.testCases[a].run===!0&&D.testNamesToRun.push(D.testCases[a].testName)}function C(){D.testNamesToRun.splice(0,D.testNamesToRun.length),B(),b.go(i().testsuiteRun)}var D=this;D.authService=g,D.USER_PERMISSIONS=h,D.changeRunNextForTestCase=v,D.toggleRunForTestCase=y,D.deleteTestCase=s,D.editTestCase=t,D.exportTestCase=j.exportTestCase,D.exportTestCases=j.exportTestCases,D.getSimpleViewForTestCase=k.getSimpleViewForTestCase,D.getXmlViewForTestCase=k.getXmlViewForTestCase,D.ngTableData=[],D.runOne=u,D.runAll=C,D.switchMode=A,D.selectAll=w,D.deselectAll=x,D.allSelected=!1,D.searchCriteria="",D.filterSuiteData=o,D.testNamesToRunNext=k.testNamesToRunNext,D.testNamesToRun=k.testNamesToRun,D.testCases=[],D.loading=!1,D.search={$:""},p(),n.onChangeApp(c,function(a){p()})}angular.module("uxData.testsuite").controller("ShowTestSuite",a),a.$inject=["$log","$state","$scope","$filter","dialogs","ngTableParams","authService","USER_PERMISSIONS","STATES_CONSTANTS","testSuiteRequestService","testsuiteService","testsuiteAlertsService","utilsService","messageService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(){q.tableParams.$params.filter=q.search,q.tableParams.reload()}function k(){q.loading=!0;var b=q.mode;b==q.MODES.EXTERNAL_REST&&(b+="?baseURL="+q.externalEndpointUrl),q.testCasesWithResult=[],h.getAllAutoTestCases(b).then(function(b){a.info("Got generated test cases and results: ",b),q.testCasesWithResult=b,angular.isArray(q.testCasesWithResult)&&q.testCasesWithResult.length>0?angular.forEach(q.testCasesWithResult,function(a){a.testcase.showSimpleView=!0,a.expected=a.testcase.expected;var b=angular.copy(a.actual);a.status===q.STATUS.PASSED&&(b.appliedUrlRules=a.testcase.expected.appliedUrlRules),a.expectedText=JSON.stringify(h.arrayPropertiesToStrings(a.expected),null,p),a.actualText=JSON.stringify(h.arrayPropertiesToStrings(b),null,p)}):q.loading=!1,angular.isDefined(q.tableParams)?q.tableParams.reload():l()},function(a){d.error(a.data,"Error",{closeButton:!0,timeOut:3e3}),q.loading=!1})}function l(){q.tableParams=new e({page:1,count:10,sorting:{name:"asc"}},{total:0,getData:function(a,b){if(angular.isArray(q.testCasesWithResult)&&q.testCasesWithResult.length>0){var d=b.sorting()?c("orderBy")(q.testCasesWithResult,b.orderBy()):q.testCasesWithResult;if(d=b.filter()?c("filter")(d,b.filter()):d,angular.isDefined(d)){b.total(d.length);var e=Math.max(1,Math.ceil(b.total()/b.count()));b.page()>e&&b.page(e),d=d.slice((b.page()-1)*b.count(),b.page()*b.count()),q.loading=!1,a.resolve(d)}else a.resolve([])}else a.resolve([])}}),q.tableParams.settings().$scope=b}function m(a){a.showSimpleView=!a.showSimpleView}function n(a){a.expanded=!a.expanded}function o(){if(q.isCurrentPathValid=!1,angular.isDefined(q.externalEndpointUrl)&&""!==q.externalEndpointUrl){var a=/^([a-z]+)(:\/\/)([\w]+)([:]*)([0-9]*)[\/]*([\w]*)/g;a.exec(q.externalEndpointUrl)&&(q.isCurrentPathValid=!0)}}var p=2,q=this;q.USER_PERMISSIONS=f,q.MODES={CURRENT:"CURRENT",NEXT:"NEXT",EXTERNAL_REST:"EXTERNAL_REST"},q.STATUS={PASSED:"PASSED",FAILED:"FAILED"},q.filterSuiteData=j,q.exportTestCase=g.exportTestCase,q.exportTestCases=g.exportTestCases,q.getSimpleViewForTestCase=h.getSimpleViewForTestCase,q.getXmlViewForTestCase=h.getXmlViewForTestCase,q.generateDiffStringForTestResult=h.generateDiffStringForTestResult,q.changeExpanded=n,q.reRunTestCases=k,q.ngTableData=[],q.switchMode=m,q.searchCriteria="",q.mode=q.MODES.CURRENT,q.externalEndpointUrl="",q.testCasesWithResult=[],q.loading=!1,q.validateUrl=o,q.isCurrentPathValid=!0,q.search={$:""},k(),i.onChangeApp(b,function(a){k()})}angular.module("uxData.testsuite").controller("ShowAutoTestSuite",a),a.$inject=["$log","$scope","$filter","toastr","ngTableParams","USER_PERMISSIONS","testSuiteRequestService","testsuiteService","messageService"]}(),function(){"use strict";function a(a,b){function c(){return!b.isDefinedAndNotEmpty(d.mode.adjustedTrafficCalculationMode)}var d=this;d.modeIsNotSelected=c,d.params=a.adjustedParams,d.mode=a.mode}angular.module("uxData.traffic").controller("adjustedInputParamController",a),a.$inject=["$scope","utilsService"]}(),function(){"use strict";angular.module("uxData.traffic").directive("adjustedInputParam",function(){return{restrict:"E",replace:!0,scope:{adjustedParams:"=",mode:"="},templateUrl:"../uxData/scripts/traffic/adjustedInputParam.html",controller:"adjustedInputParamController",controllerAs:"vm"}})}(),function(){"use strict";angular.module("uxData.traffic").config(["$numeraljsConfigProvider",function(a){a.setDefaultFormat("0,0")}])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){h(v.trafficInputParams)}function h(a){i(),e.getTraffic(a).then(function(a){n(a),j()},function(a){b.error("Failed to calculate traffic","Error",{closeButton:!0,timeOut:3e3})})}function i(){angular.isDefined(v.traffic.defaultServer)&&(v.trafficInputParams.adjustedTrafficInputParams.defaultServer.adjustedThreshold=m(v.trafficInputParams.adjustedTrafficInputParams.defaultServer.adjustedThreshold)),angular.forEach(v.trafficInputParams.adjustedTrafficInputParams.distributions,function(a,b){a.adjustedThreshold=m(a.adjustedThreshold)})}function j(){angular.isDefined(v.traffic.defaultServer.adjustedThreshold)&&(v.traffic.defaultServer.adjustedThresholdHumanReadable=k(v.traffic.defaultServer.adjustedThreshold)),angular.forEach(v.traffic.distributions,function(a,b){a.adjustedThresholdHumanReadable=k(a.adjustedThreshold)}),angular.isDefined(v.trafficInputParams.adjustedTrafficInputParams.defaultServer.adjustedThreshold)&&(v.trafficInputParams.adjustedTrafficInputParams.defaultServer.adjustedThreshold=l(v.trafficInputParams.adjustedTrafficInputParams.defaultServer.adjustedThreshold)),angular.forEach(v.trafficInputParams.adjustedTrafficInputParams.distributions,function(a,b){a.adjustedThreshold=l(a.adjustedThreshold)})}function k(a){return a<0?-a+"% taken off":a}function l(a){return(a+"").indexOf(A)>0?a:a<0?-a+" "+A:a}function m(a){return a+="",a.indexOf(" "+A)>0?-a.replace(" "+A,""):a}function n(a){o(a),p(a),q(a),v.horizontalTableOrientation=a.distributions.length<3}function o(a){angular.copy(a,v.traffic);var b=v.trafficInputParams.adjustedTrafficInputParams.adjustedTrafficCalculationMode;angular.equals(w,b)?angular.extend(v.traffic.defaultServer,a.defaultServer.adjustedThreshold):angular.extend(v.traffic.defaultServer,a.defaultServer.adjustedWeights),angular.forEach(v.traffic.distributions,function(a,c){angular.equals(w,b)?angular.extend(a,a.adjustedThreshold):angular.extend(a,a.adjustedWeights)})}function p(a){var b=v.trafficInputParams.adjustedTrafficInputParams.defaultServer,c=v.trafficInputParams.adjustedTrafficInputParams.adjustedTrafficCalculationMode;angular.equals(w,c)&&angular.isDefined(a.defaultServer.adjustedThreshold)?b.adjustedThreshold=a.defaultServer.adjustedThreshold.adjustedThreshold:angular.equals(x,c)&&angular.isDefined(a.defaultServer.adjustedWeights)?b.adjustedWeight=a.defaultServer.adjustedWeights.adjustedWeight:angular.copy(r(a.defaultServer.flavor,a.defaultServer.title),b)}function q(a){var b=v.trafficInputParams.adjustedTrafficInputParams.adjustedTrafficCalculationMode,c=v.trafficInputParams.adjustedTrafficInputParams.distributions,d=[];angular.forEach(a.distributions,function(a,e){var f=u(c,a);angular.isDefined(f)?(angular.equals(w,b)&&angular.isDefined(a.adjustedThreshold.adjustedThreshold)?f.adjustedThreshold=a.adjustedThreshold.adjustedThreshold:angular.equals(x,b)&&angular.isDefined(a.adjustedWeights.adjustedWeight)&&(f.adjustedWeight=a.adjustedWeights.adjustedWeight),d.push(f)):d.push(s(a.flavor,a.title,"","","",""))}),v.trafficInputParams.adjustedTrafficInputParams.distributions=d}function r(a,b){return s(a,b,"","","","")}function s(a,b,c,d,e,f){return{flavor:a,title:b,numberOfHostsToAdjust:c,defaultWeight:d,adjustedWeight:e,adjustedThreshold:f}}function t(){h(v.trafficInputParams)}function u(a,b){var c=void 0;return angular.forEach(a,function(a,d){angular.equals(b.flavor,a.flavor)&&(c=a)}),c}var v=this,w=f().ADJUSTED_CALCULATION_MODE.ADJUSTED_TRAFFIC,x=f().ADJUSTED_CALCULATION_MODE.ADJUSTED_WEIGHT,y=f().HOSTS_MODE.ALL_WHITELISTED,z=f().DISTRIBUTION_MODE.CURRENT,A="off";v.reloadTraffic=t,v.getTraffic=h,v.traffic={},v.horizontalTableOrientation=!0,v.adjustedTrafficCalculationModes=[{name:"Adjusted traffic",value:w},{name:"Adjusted weight",value:x}],v.trafficInputParams={connectionThreshold:0,totalNumberConnections:0,hostsMode:y,distributionMode:z,adjustedTrafficInputParams:{adjustedTrafficCalculationMode:"",defaultServer:{},distributions:[]}},g(),c.onChangeApp(a,function(){v.traffic=[],v.isActive=!1,v.trafficInputParams={connectionThreshold:0,totalNumberConnections:0},g()})}angular.module("uxData.traffic").controller("TrafficCtrl",a),a.$inject=["$scope","toastr","messageService","LOCALSTORAGE_PAGE_NAMES","trafficService","TRAFFIC_CONSTANTS"]}(),angular.module("uxData.traffic").directive("trafficWhiteList",function(){return{restrict:"E",replace:!0,templateUrl:"../uxData/scripts/traffic/traffic.html",controller:"TrafficCtrl",controllerAs:"vm"}}),function(){"use strict";function a(a,b){function c(){a.onServerChanged({newProtocol:g.server.protocol,newPort:g.server.port,newUrn:g.server.urn,newIPProtocolVersion:g.server.ipProtocolVersion})}function d(){a.onServerChanged({newProtocol:g.server.protocol,newPort:g.server.port,newUrn:g.server.urn,newIPProtocolVersion:g.server.ipProtocolVersion})}function e(){a.onServerChanged({newProtocol:g.server.protocol,newPort:g.server.port,newUrn:g.server.urn,newIPProtocolVersion:g.server.ipProtocolVersion})}function f(){a.onServerChanged({newProtocol:g.server.protocol,newPort:g.server.port,newUrn:g.server.urn,newIPProtocolVersion:g.server.ipProtocolVersion})}var g=this;g.server=a.server,g.IP_PROTOCOL_VERSION_LIST=[{id:"4",name:"IPv4"},{id:"6",name:"IPv6"}],g.onUrnChanged=e,g.onPortChanged=d,g.onProtocolChanged=c,g.onIPProtocolVersionChanged=f,g.hasError=b.hasError}angular.module("uxData.urlParams").controller("urlParamsController",a),a.$inject=["$scope","RulesCommonValidationService"]}(),function(){"use strict";angular.module("uxData.urlParams").directive("urlparams",function(){return{restrict:"E",replace:!0,scope:{server:"=",validationData:"=",disabled:"=",onServerChanged:"&"},templateUrl:"../uxData/scripts/url-params/urlParams.html",controller:"urlParamsController",controllerAs:"vm"}})}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(a){b.getFile(a,l).then(function(a){k.rulesFromFile=a})}function i(a,c){b.validateDuplicatesAndImportOneRule(a,c,k.rulesFromFile,l)}function j(){b.importAll(k.rulesFromFile,l)}var k=this,l=f().RULE_TYPE.URL;k.authService=d,k.USER_PERMISSIONS=e,k.rulesFromFile={},k.loading=!1,k.getFile=h,k.validateDuplicatesAndImportOneRule=i,k.isMapEmpty=c.isMapEmpty,k.importAll=j,g.onChangeApp(a,function(a){angular.copy({},k.rulesFromFile)})}angular.module("uxData.rules").controller("UrlRulesImportController",a),a.$inject=["$scope","RulesImportService","utilsService","authService","USER_PERMISSIONS","RULES_CONSTANTS","messageService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){function v(){C(),D(),E(),$.uiModelHolder.editMode?o.loadRuleAndTemplates($.uiModelHolder.ruleName).then(function(a){$.templateRules=a.templates,angular.isDefined(a.rule["if"])&&angular.isArray(a.rule["if"])&&(a.rule=angular.copy(a.rule["if"][0])),w(a.rule,$.uiModelHolder.ruleName)},function(a){n.failedToLoadData("rule data",a)}):o.loadRulesAndTemplates().then(function(a){$.templateRules=a.templates},function(a){n.failedToLoadData("rule data",a)})}function w(a,b){M();var c=i.unmarshallJSONRule(a,t);if(m.isDefinedAndNotEmpty(a.templateName)){var d=i.unmarshallJSONRule($.templateRules[a.templateName],t);angular.extend(c,A(c,d)),F(c,b),$.uiModelHolder.currentTemplateName=a.templateName,x()}else F(c,b);G()}function x(){z(),y()}function y(){var a=i.unmarshallJSONRule($.templateRules[$.uiModelHolder.currentTemplateName],t);angular.forEach(a.expressions.reverse(),function(a,b){J(a,!0),$.uiModelHolder.rawExpressions[0].disabled=!0}),angular.copy(a.returnStatement,$.uiModelHolder.urlParams),$.uiModelHolder.disableUrlParams=!0,p.validateReturnValue($)}function z(){for(var a=0;a<$.uiModelHolder.rawExpressions.length;){var b=$.uiModelHolder.rawExpressions[a];b.disabled?K(a):a++}$.uiModelHolder.disableUrlParams=!1}function A(a,b){var c={};return c.expressions=[],c.returnStatement=b.returnStatement,angular.forEach(a.expressions,function(a,d){var e=!1;angular.forEach(b.expressions,function(b,c){angular.equals(b,a)&&(e=!0)}),e||c.expressions.push(a)}),c}function B(){m.isDefinedAndNotEmpty($.uiModelHolder.currentTemplateName)?x():z()}function C(){o.loadDefaultUrlParams().then(function(a){angular.copy(a.urlRule,$.defaultUrlParams),angular.copy(a.urlRule,$.approvedDefaultUrlParams),m.isDefinedAndNotEmpty(a["default"])&&(angular.copy(a["default"],$.defaultUrlParamsChanges),$.defaultUrlParams.hasChanges=!0)},function(a){n.failedToLoadData("rules names")})}function D(){o.loadAllUrlRuleIds(f().RULE_TYPE.URL).then(function(a){$.existingRuleIDs=angular.copy(a)},function(a){n.failedToLoadData("rules names")})}function E(){r.loadAllTemplateIds(f().TEMPLATES_TYPE.URL).then(function(a){$.existingTemplatesIDs=angular.copy(a)},function(){n.failedToLoadData("templatesIds")})}function F(a,b){$.uiModelHolder.ruleName=b,
$.uiModelHolder.editMode=!0,angular.copy(a.expressions,$.uiModelHolder.rawExpressions),angular.copy(a.returnStatement,$.uiModelHolder.urlParams),H()}function G(){ba.id=$.uiModelHolder.ruleName,ba.jsonRule=i.marshallRuleToJSON($.uiModelHolder.rawExpressions,$.uiModelHolder.urlParams,t)}function H(){angular.forEach($.uiModelHolder.rawExpressions,function(a,b){$.exprValidationData[b]={},$.exprValidationData[b][_]={duplicates:{},valueErrorMsg:[]},m.isEmptyString(a.type)||($.exprValidationData[b][aa]={duplicates:{},valueErrorMsg:[]})}),angular.copy({},$.urlParamsValidationData)}function I(a){var b=h.createExpression("","",g().OPERATOR_TYPE.EQUAL,[""],_);if(h.isBinary(a)){var c=h.createExpression("","",g().OPERATOR_TYPE.EQUAL,[""],aa);b=h.createBinaryExpression(b,c,a)}J(b,!1)}function J(a,b){var c={},d=h.createExpression(a[_].expName,a[_].expType,a[_].expOperator,a[_].expValues,_);if(c[_]={valueErrorMsg:[]},h.isBinary(a.type)){var e=h.createExpression(a[aa].expName,a[aa].expType,a[aa].expOperator,a[aa].expValues,aa);d=h.createBinaryExpression(d,e,a.type),c[aa]={valueErrorMsg:[]}}b?($.exprValidationData.unshift(c),$.uiModelHolder.rawExpressions.unshift(d)):($.exprValidationData.push(c),$.uiModelHolder.rawExpressions.push(d))}function K(a){$.uiModelHolder.rawExpressions.splice(a,1),$.exprValidationData.splice(a,1),j.validatePercentExpressions($)}function L(){M(),$.uiModelHolder.editMode&&($.uiModelHolder.editMode=!1,angular.isDefined(a.previousState)&&a.previousState.name===e().showURLRules?a.go(a.previousState.name,a.previousParams):a.go(e().addNewURLRule,{ruleId:$.uiModelHolder.ruleName,serviceName:c.currentApplication}))}function M(){$.uiModelHolder.currentTemplate={},$.uiModelHolder.rawExpressions.splice(0,$.uiModelHolder.rawExpressions.length),$.uiModelHolder.ruleName="",$.uiModelHolder.currentTemplateName="",$.ruleNameError="",angular.copy({},$.uiModelHolder.urlParams),angular.copy({},$.urlParamsValidationData),$.exprValidationData.splice(0,$.exprValidationData.length),$.isSaving=!1,$.uiModelHolder.disableUrlParams=!1}function N(a,b,c,d,e,f,g){S(a,b,c,d,e,f,g),j.validateExprName($.uiModelHolder.rawExpressions[a][b],a,b,$)}function O(a,b,c,d,e,f,g){S(a,b,c,d,e,f,g),j.validateExprValue(e[f],$.uiModelHolder.rawExpressions[a][b],a,b,f,$)}function P(a,b,c,d,e,f,g){S(a,b,c,d,e,f,g),$.exprValidationData[a][b].valueErrorMsg=[""],j.validateExprName($.uiModelHolder.rawExpressions[a][b],a,b,$),j.validatePercentExpressions($)}function Q(a,b,c,d,e,f,g){$.uiModelHolder.rawExpressions[a][b].expValues=e,$.exprValidationData[a][b].valueErrorMsg.push("")}function R(a,b,c,d,e,f,g){$.uiModelHolder.rawExpressions[a][b].expValues=e,$.exprValidationData[a][b].valueErrorMsg.splice(f,1)}function S(a,b,c,d,e,f,g){$.uiModelHolder.rawExpressions[a][b].expName=c,$.uiModelHolder.rawExpressions[a][b].expOperator=d,$.uiModelHolder.rawExpressions[a][b].expValues=e,$.uiModelHolder.rawExpressions[a][b].expType=g}function T(){p.validateReturnValue($)}function U(){p.validateDefaultReturnValue($)}function V(a){var b="";return angular.isDefined(a)&&(b=t.getRuleReturnDiffText(a),""!==b&&(b="["+b+"\n]")),b}function W(){var a=p.validateDefaultReturnValue($),b=!o.areUrlParamsEquals($.approvedDefaultUrlParams,$.defaultUrlParams);a&&b?($.isSavingDefaultServer=!0,q.saveDefaultUrlParams($.defaultUrlParams).then(function(a){$.isSavingDefaultServer=!1,C()},function(a){$.isSavingDefaultServer=!1,n.failedToSave("Default URL Parameters: ",angular.isDefined(a.message.data.message)?a.message.data.message:a.message)})):a?b||n.hasNotChangedWarning("Default Url Params"):n.failedToSave("Default Url Params","due to validation errors")}function X(){var b=j.validateRule($,p);if(b){var c=i.marshallRuleToJSON($.uiModelHolder.rawExpressions,$.uiModelHolder.urlParams,t);angular.equals(ba.id,$.uiModelHolder.ruleName)&&angular.equals(ba.jsonRule,c)?n.hasNotChangedWarning("URL Rule"):(""!==$.uiModelHolder.currentTemplateName?c["if"][0].templateName=$.uiModelHolder.currentTemplateName:angular.isDefined(c["if"][0].templateName)&&delete c["if"][0].templateName,c["if"][0].id=$.uiModelHolder.ruleName,q.saveUrlRule(c["if"][0],$.uiModelHolder.ruleName).then(function(b){n.successfullySaved(" '"+$.uiModelHolder.ruleName+"' URL Rule."),a.go(e().showURLRules,{ruleName:$.uiModelHolder.ruleName})},function(a){n.failedToSave("URL Rule: '"+$.uiModelHolder.ruleName+"'",angular.isDefined(a.data.message)?a.data.message:a.message),$.isSaving=!1}))}else n.failedToSave("rule","Due to validation errors.")}function Y(){var b=j.validateRule($,p);if(b){var c=i.marshallRuleToJSON($.uiModelHolder.rawExpressions,$.uiModelHolder.urlParams,t);c["if"][0].id=$.uiModelHolder.ruleName,r.saveTemplate(f().TEMPLATES_TYPE.URL,c["if"][0],$.uiModelHolder.ruleName).then(function(b){n.successfullySaved(" '"+$.uiModelHolder.ruleName+"' template."),a.go(e().templates,{name:f().TEMPLATES_TYPE.URL,ruleName:$.uiModelHolder.ruleName})},function(a){n.failedToSave("Template: '"+$.uiModelHolder.ruleName+"'",angular.isDefined(a.message.data.message)?a.message.data.message:a.message),$.isSaving=!1})}else n.failedToSave("Template","Due to validation errors.")}function Z(){j.validateRuleName($)}var $=this,_=f().LEFT,aa=f().RIGHT;s().urlRulesAdd,s().urlRulesEdit;$.authService=k,$.USER_PERMISSIONS=l,$.hasPermissions=m.hasPermissions;var ba={};$.exprValidationData=[],$.urlParamsValidationData={},$.existingRuleIDs={},$.existingTemplatesIDs={},$.approvedDefaultUrlParams={},$.defaultUrlParams={hasChanges:!1},$.defaultUrlParamsChanges={},$.defaultUrlParamsValidationData={},$.defaultUrlParamsToggle=!1,$.isSavingDefaultServer=!1,$.uiModelHolder={ruleName:angular.isDefined(b.ruleId)?b.ruleId:"",currentTemplate:{},editMode:angular.isDefined(b.ruleId),currentTemplateName:"",rawExpressions:[],urlParams:{},disableUrlParams:!1},$.ruleNameError="",$.saveAsTemplate=Y,$.addEmptyExpression=I,$.removeExpression=K,$.cancelEditRule=L,$.validateRuleName=Z,$.hasError=m.isDefinedAndNotEmpty,$.updateExpressions=S,$.onExprNameChanged=N,$.onExprOperatorChanged=P,$.onExprValueAdded=Q,$.onExprValueRemoved=R,$.onExprValueChanged=O,$.onUrlParamsChanged=T,$.onDefaultUrlParamsChanged=U,$.saveDefaultUrlParams=W,$.getUrlParamsDiffViewText=V,$.onTemplateChanged=B,$.saveRule=X,u.onChangeApp(d,function(){L(),v()}),v()}angular.module("uxData.urlRules").controller("urlRulesEditController",a),a.$inject=["$state","$stateParams","$rootScope","$scope","STATES_CONSTANTS","RULES_CONSTANTS","EXPRESSION_CONSTANTS","rulesEditService","rulesBuilderService","RulesCommonValidationService","authService","USER_PERMISSIONS","utilsService","rulesAlertsService","urlRulesService","urlRulesValidationService","urlRulesRequestService","templatesService","LOCALSTORAGE_PAGE_NAMES","urlRulesBuilderService","messageService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){function u(){y(),k.loadUrlRulesPathsChanges().then(function(a){C.urlRules=r.unmarshallJSONRulesForPreview(a.urlRules,a.pendingChanges,a.servicePaths,D,q),C.loading=!1,""!==C.focusedRule&&(e.hash(C.focusedRule),f())},function(a){C.loading=!1,m.failedToLoadData("urlRules data")})}function v(b){c.go(g().editURLRule,{ruleId:b.toString(),serviceName:a.currentApplication})}function w(a){l.deleteUrlRule(a).then(function(){m.successfullyDeleted("URL Rule: '"+a+"'"),u()},function(b){m.failedToDelete("URL Rule: '"+a+"/",angular.isDefined(b.message)?b.message:b)})}function x(a){var b="Are you sure you want to delete rule '"+a+"' ?",c=p.confirm(b);c.result.then(function(b){w(a)},function(){})}function y(){k.loadDefaultUrlParams().then(function(a){angular.copy(a.urlRule,C.defaultUrlParams),angular.copy(a.urlRule,C.approvedDefaultUrlParams),j.isDefinedAndNotEmpty(a["default"])&&(angular.copy(a["default"],C.defaultUrlParamsChanges),C.defaultUrlParams.hasChanges=!0)},function(a){m.failedToLoadData("rules names")})}function z(){s.validateDefaultReturnValue(C)}function A(){var a=s.validateDefaultReturnValue(C),b=!k.areUrlParamsEquals(C.approvedDefaultUrlParams,C.defaultUrlParams);a&&b?(C.isSavingDefaultServer=!0,l.saveDefaultUrlParams(C.defaultUrlParams).then(function(a){C.isSavingDefaultServer=!1,y()},function(a){C.isSavingDefaultServer=!1})):a?b||m.hasNotChangedWarning("Default Url Params"):m.failedToSave("Default Url Params","due to validation errors")}function B(a){var b="";return angular.isDefined(a)&&(b=q.getRuleReturnDiffText(a),""!==b&&(b="["+b+"\n]")),b}var C=this,D=n().RULE_TYPE.URL;C.authService=h,C.USER_PERMISSIONS=i,C.hasPermissions=j.hasPermissions,C.loading=!0,C.focusedRule=angular.isDefined(d.ruleName)?d.ruleName:"",C.approvedDefaultUrlParams={},C.defaultUrlParams={hasChanges:!1},C.defaultUrlParamsChanges={},C.defaultUrlParamsValidationData={},C.defaultUrlParamsToggle=!1,C.isSavingDefaultServer=!1,C.urlRules={},C.editUrlRule=v,C.deleteUrlRule=w,C.isMapEmpty=j.isMapEmpty,C.confirmDeleteRule=x,C.onDefaultUrlParamsChanged=z,C.saveDefaultUrlParams=A,C.getUrlParamsDiffViewText=B,C.searchSort={sortBy:"id",sortType:"asc",search:""},C.exportAllURLRules=l.exportAllUrlRules,u(),o.onChangeApp(b,function(){u()})}angular.module("uxData.urlRules").controller("urlRulesShowController",a),a.$inject=["$rootScope","$scope","$state","$stateParams","$location","$anchorScroll","STATES_CONSTANTS","authService","USER_PERMISSIONS","utilsService","urlRulesService","urlRulesRequestService","rulesAlertsService","RULES_CONSTANTS","messageService","dialogs","urlRulesBuilderService","rulesBuilderService","urlRulesValidationService","LOCALSTORAGE_PAGE_NAMES"]}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){return i(x()+"namespacedLists/getAllNamespacedListsWithoutValues",{Accept:"application/json"})}function h(a){var b=v()+"/data/namespacedLists/deleteEntitiesFromNamespacedLists";return K(b,a,{"Content-Type":"application/json",Accept:"application/json"})}var i=function(b,d){var e=c.defer();return a({method:"GET",url:b,headers:d}).success(function(a,b,c){e.resolve(a)}).error(function(a,b,c){401!==b&&e.reject({data:a,status:b})}),e.promise},j=function(){return i(w()+"partners",{"Content-Type":"application/json",Accept:"application/json, text/json, */*;"})},k=function(b,d){var e=c.defer();return a({method:"POST",data:d,headers:{"Content-Type":"application/json",Accept:"application/json"},url:w()+"partners"}).success(function(a,b,c){e.resolve(a)}).error(function(a,b,c){401!==b&&e.reject(a)}),e.promise},l=function(a){return L(w()+"partners",a,{"Content-Type":"application/json",Accept:"application/json"})},m=function(a){return M(w()+"partners/"+a,{Accept:"application/json"})},n=function(b,d){var e=w()+"deciderRules/"+d,f=c.defer();return a({method:"POST",data:b,url:e,headers:{"Content-Type":"application/json"}}).success(function(a,b,c){f.resolve(a)}).error(function(a,b,c){401!==b&&f.reject(a)}),f.promise},o=function(){return i(w()+"deciderRules",{Accept:"application/json"})},p=function(a){return i(w()+"deciderRules/"+a,{Accept:"application/json"})},q=function(){return i(w()+"deciderRules/ids",{Accept:"application/json"})},r=function(b,d){var e=w()+"deciderRules/"+d,f=c.defer();return a({method:"DELETE",url:e,headers:{}}).success(function(a,b,c){f.resolve(a)}).error(function(a,b,c){401!==b&&f.reject(a)}),f.promise},s=function(){window.open(w()+"partners/export")},t=function(a){window.open(w()+"partners/export/"+a)},j=function(){return i(w()+"partners",{Accept:"application/xml"})},u=function(){return i(w()+"partners",{Accept:"application/json"})},v=function(){var a=b.absUrl();return a.lastIndexOf("#/")!==-1&&(a=a.substr(0,a.lastIndexOf("#/"))),a=a.substr(0,a.lastIndexOf("/")),a=a.substr(0,a.lastIndexOf("/"))},w=function(){return v()+"/data/decider/"},x=function(){return v()+"/data/"},y=function(a){var b=function(a){a.call(this,{paths:""},"")},c=function(){};return{success:b,error:c}},z=function(){return i(x()+"namespacedLists/getAllNamespacedLists",{Accept:"application/json"})},A=function(a,b){return K(x()+"namespacedLists/addNewNamespaced/"+a,b,{"Content-Type":"application/json",Accept:"application/json"})},B=function(a){return K(x()+"namespacedLists/duplicates",a,{"Content-Type":"application/json",Accept:"application/json"})},C=function(a){return i(x()+"namespacedLists/getOne/"+a,{Accept:"application/json"})},D=function(a){return M(x()+"namespacedLists/"+a,{Accept:"application/json"})},E=function(a,b){return M(x()+"namespacedLists/"+a+"/"+encodeURIComponent(b),{Accept:"application/json"})},F=function(a){window.open(x()+"namespacedLists/export/"+a)},G=function(a){window.open(x()+"namespacedLists/export")},H=function(a){return i(x()+"namespacedLists/search/"+encodeURIComponent(a),{})},I=function(a){if(angular.isDefined(a)&&angular.isArray(a)){for(var b=x()+"namespacedLists/dependingRulesMultiple/",c=0;c<a.length;c++)b+=c===a.length-1?a[c]:a[c]+",";return i(b,{Accept:"application/json"})}return null},J=function(a,b){return K(x()+"namespacedLists/deleteNamespacedEntities/"+a,{entities:b},{"Content-Type":"application/json",Accept:"application/json"})},K=function(b,d,e){var f=c.defer();return a({method:"POST",data:d,url:b,headers:e}).success(function(a,b,c){f.resolve(a)}).error(function(a,b,c){401!==b&&f.reject(a)}),f.promise},L=function(b,d,e){var f=c.defer();return a({method:"PUT",data:d,url:b,headers:e}).success(function(a,b,c){f.resolve(a)}).error(function(a,b,c){401!==b&&f.reject(a)}),f.promise},M=function(b,d,e){var f=c.defer();return a({method:"DELETE",url:b,data:e,headers:d}).success(function(a,b,c){f.resolve(a)}).error(function(a,b,c){401!==b&&f.reject(a)}),f.promise},N=function(a){e.go(f().namespacesSearch,{serviceName:d.currentApplication,search:a})},O=function(a,b){e.go(f().rulesEdit,{ruleId:a,serviceName:b})},P=function(a){e.go(f().namespacesEdit,{name:a})},Q=function(){var a=null;return $.ajax({url:v()+"/data/auth/authinfo",async:!1,dataType:"json",headers:{}}).done(function(b,c,d){a=b}),a},R=function(a,b){if(angular.isArray(b)){for(var c=v()+"/data/namespacedLists/"+a+"/",d=0;d<b.length;d++)c+=encodeURIComponent(b[d]),c+=d===b.length-1?"":",";return M(c,{Accept:"application/json"})}return E(a,b)},S=function(a){window.open(w()+"deciderRules/export/"+a)},T=function(){window.open(w()+"deciderRules/export/")};return{getPartners:j,getPartnersJSON:u,getExportPartners:s,getExportPartner:t,savePartners:k,addOrUpdatePartner:l,deletePartner:m,saveRule:n,getRules:o,getRule:p,getRuleIds:q,deleteRule:r,getServicePaths:y,getAuthInfo:Q,getNamespaces:z,getAllNamespacedListsWithoutValues:g,saveNamespaces:A,deleteNamespace:D,exportNamespace:F,exportAllNamespaces:G,searchNamespacesByItem:H,getNamespaceDuplicates:B,getNamespacedListByName:C,deleteEntitiesFromNamespacedLists:h,deleteNamespaceValue:E,goToNamespacedListsSearchPage:N,goToEditRulePage:O,goToEditNamespacedListPage:P,deleteNamespaceValues:R,getMultipleRulesDependingOnNamespaced:I,bulkDeleteNamespacedValues:J,exportRule:S,exportAllRules:T,getBaseUrl:v}}angular.module("uxData.services").factory("requestsService",a),a.$inject=["$http","$location","$q","$rootScope","$state","STATES_CONSTANTS"]}();